{
  "post_stream": {
    "posts": [
      {
        "id": 14250,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-07-11T21:44:18.868Z",
        "cooked": "<p>We are migrating our FDB clusters from gcloud GCE instances to regional GKE with the k8s operator. The operator based clusters are working fine and really performant in our benchmarks.</p>\n<p>However, the new clusters on k8s have regular recoveries, without the pods/processes changing. Our old GCE based clusters have a stable generation for weeks/months, these new operator based clusters have a recovery every few hours to even multiple times per hour.</p>\n<p>Is there anything that we could have misconfigured that is causing this? There are no crashing processes/roles. From the logs this looks like the coordinators elect a new leader but I can not find the reason why.</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1720712716.403994\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"NominatingLeader\" ID=\"0000000000000000\" NextNominee=\"0000000000000000\" CurrentNominee=\"63b9766de9746e9e\" Key=\"testing:lF1YgdssDlUMCkzSzySauaMudygmsAzy\" ThreadID=\"10265174738276486606\" Machine=\"10.20.8.166:4501\" LogGroup=\"testing\" Roles=\"CD,SS\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.403994\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"GetLeaderReply\" ID=\"0000000000000000\" SuppressedEventCount=\"0\" Coordinator=\"testing-storage-80198.testing.fdb-testing.svc.cluster.local:4501\" Nominee=\"0000000000000000\" ClusterKey=\"testing:lF1YgdssDlUMCkzSzySauaMudygmsAzy\" ThreadID=\"10265174738276486606\" Machine=\"10.20.8.166:4501\" LogGroup=\"testing\" Roles=\"CD,SS\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.403994\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"MonitorLeaderAndGetClientInfoLeaderChange\" ID=\"0000000000000000\" NewLeader=\"63b9766de9746e9e\" Key=\"testing:lF1YgdssDlUMCkzSzySauaMudygmsAzy\" ThreadID=\"10265174738276486606\" Machine=\"10.20.8.166:4501\" LogGroup=\"testing\" Roles=\"CD,SS\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.404216\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"LeaderChanged\" ID=\"634ed136a6cbc5d0\" ToID=\"63b9766de9746e9e\" ThreadID=\"13314130535266162720\" Machine=\"10.20.0.94:4501\" LogGroup=\"testing\" Roles=\"RK\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.404260\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"GetLeaderReply\" ID=\"0000000000000000\" SuppressedEventCount=\"0\" Coordinator=\"testing-storage-80198.testing.fdb-testing.svc.cluster.local:4501\" Nominee=\"0000000000000000\" ClusterKey=\"testing:lF1YgdssDlUMCkzSzySauaMudygmsAzy\" ThreadID=\"8277690677813700063\" Machine=\"10.20.10.199:4501\" LogGroup=\"testing\" Roles=\"CD,SS\" /&gt;\n...\n&lt;Event Severity=\"10\" Time=\"1720712716.874662\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"LeaderNoHeartbeat\" ID=\"63b9766de9746e9e\" Coordinator=\"10.20.8.177:4501\" ThreadID=\"2175416327912343892\" Machine=\"10.20.8.177:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.874662\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"LeaderNoHeartbeat\" ID=\"63b9766de9746e9e\" Coordinator=\"10.20.8.177:4501\" ThreadID=\"2175416327912343892\" Machine=\"10.20.8.177:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.874662\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"LeaderNoHeartbeat\" ID=\"63b9766de9746e9e\" Coordinator=\"10.20.8.177:4501\" ThreadID=\"2175416327912343892\" Machine=\"10.20.8.177:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.874662\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"ReleasingLeadership\" ID=\"63b9766de9746e9e\" ThreadID=\"2175416327912343892\" Machine=\"10.20.8.177:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1720712716.874662\" DateTime=\"2024-07-11T15:45:16Z\" Type=\"Role\" ID=\"424aa8c17bc14f7d\" Transition=\"End\" As=\"ClusterController\" Reason=\"Leader Replaced\" ThreadID=\"2175416327912343892\" Machine=\"10.20.8.177:4501\" LogGroup=\"testing\" Roles=\"CC\" TrackLatestType=\"Original\" /&gt;\n</code></pre>\n<p>Thanks for the awesome work on the operator &amp; fdb!</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-11T21:44:18.868Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 47,
        "reads": 40,
        "readers_count": 39,
        "score": 243.0,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 14256,
        "name": "Johannes Scheuermann",
        "username": "johscheuer",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png",
        "created_at": "2024-07-15T09:11:12.964Z",
        "cooked": "<p>Hello,</p>\n<p>have you checked if the operator is performing any changes to the FDB cluster, like coordinator changes or database configuration changes?  Or exclusions, those could cause a recovery. Based on your comment that the pods are the same, it\u2019s probably not a recovery.</p>\n<p>I\u2019m not too familiar with GKE (at least not anymore). Is there a dashboard for network latencies?</p>\n<p>You could try to use this query: <a href=\"https://github.com/apple/foundationdb/blob/main/contrib/observability_splunk_dashboard/recovery.xml#L94-L116\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">foundationdb/contrib/observability_splunk_dashboard/recovery.xml at main \u00b7 apple/foundationdb \u00b7 GitHub</a> (you probably have to change it for your logging solution), to see why the recoveries are triggered.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-15T09:11:12.964Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 41,
        "readers_count": 40,
        "score": 33.2,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Johannes Scheuermann",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/main/contrib/observability_splunk_dashboard/recovery.xml#L94-L116",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/contrib/observability_splunk_dashboard/recovery.xml at main \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 8
          }
        ],
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 849,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14270,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-07-22T22:54:13.253Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"johscheuer\" data-post=\"2\" data-topic=\"4562\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/j/f475e1/48.png\" class=\"avatar\"> johscheuer:</div>\n<blockquote>\n<p>have you checked if the operator is performing any changes to the FDB cluster, like coordinator changes or database configuration changes?</p>\n</blockquote>\n</aside>\n<p>Yes, the operator itself isn\u2019t doing anything around the time the recoveries happen.</p>\n<p>I\u2019ve tried some of those queries you linked, it\u2019s always the clustercontroller that triggers the recovery by releasing it\u2019s leadership. Then a new clustercontroller is elected which then recruits a new master which is the recovery. Looking at the code, the heartbeats that cause the clustercontroller to release it\u2019s leadership are to the coordinators and for some reason they don\u2019t reply in 2s (default <code>POLLING_FREQUENCY</code>). I can not find a reason for them not replying in the logs.</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1721671970.698063\" DateTime=\"2024-07-22T18:12:50Z\" Type=\"LeaderTrueHeartbeat\" ID=\"638445b4f57b2e42\" Coordinator=\"10.20.13.46:4501\" ThreadID=\"9164596303472621124\" Machine=\"10.20.13.46:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1721671970.698063\" DateTime=\"2024-07-22T18:12:50Z\" Type=\"LeaderNoHeartbeat\" ID=\"638445b4f57b2e42\" Coordinator=\"10.20.13.46:4501\" ThreadID=\"9164596303472621124\" Machine=\"10.20.13.46:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1721671970.698063\" DateTime=\"2024-07-22T18:12:50Z\" Type=\"LeaderNoHeartbeat\" ID=\"638445b4f57b2e42\" Coordinator=\"10.20.13.46:4501\" ThreadID=\"9164596303472621124\" Machine=\"10.20.13.46:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1721671970.698063\" DateTime=\"2024-07-22T18:12:50Z\" Type=\"ReleasingLeadership\" ID=\"638445b4f57b2e42\" ThreadID=\"9164596303472621124\" Machine=\"10.20.13.46:4501\" LogGroup=\"testing\" Roles=\"CC\" /&gt;\n</code></pre>\n<p>I had a look at network latencies between the VMs and did not find any noticable spikes around the timestamps the clustercontroller heartbeats fail. Median latency is consistently less than 1ms.</p>\n<p>There are no logs with high severity, the only warn logs are an occasional Net2RunLoopTrace and SlowSSLoopx100</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-22T22:54:13.253Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 5,
        "reads": 40,
        "readers_count": 39,
        "score": 38.0,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14273,
        "name": "Jingyu Zhou",
        "username": "jzhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "created_at": "2024-07-24T04:46:47.224Z",
        "cooked": "<p>I suspect the Cluster Controller is doing some CPU intensive work that took a long time, thus delaying the processing of <code>LeaderHeartbeatReply</code>. Because these replies are not processed timely, CC \u201cthought\u201d the heartbeat failed.</p>\n<p>To validate this hypothesis, you can check CPU usage of the CC around the time recoveries happened. Additionally, if there are <code>Net2RunLoopTrace</code> from CC\u2019s log, you can check the call stack of the trace which can give clues where CC is spinning CPU time. Finally, we know <code>status json</code> processing can take a long time on CC, so it\u2019s worth checking if some client was issuing <code>status json</code> at the time.</p>\n<p><code>SlowSSLoopx100</code> is a storage server event. Is CC colocated with a storage server (SS)? If so, it might be the SS was CPU busy and didn\u2019t give much CPU cycles to CC. CC should placed on stateless processes, not with SSes.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-24T04:49:47.014Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 35,
        "readers_count": 34,
        "score": 22.0,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jingyu Zhou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1442,
          "username": "jlemaes",
          "name": "Jasper Maes",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 454,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14274,
        "name": "Johannes Scheuermann",
        "username": "johscheuer",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png",
        "created_at": "2024-07-24T04:54:57.987Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/jzhou\">@jzhou</a> was faster <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> If you set CPU limits (which is the default with the operator), you should check if some of the processes are throttled. If a process is throttle it can happen that the responses are delayed (basically what Jingyu said above). GKE should have some tooling to help you: <a href=\"https://cloud.google.com/kubernetes-engine/distributed-cloud/vmware/docs/troubleshooting/resource-contention\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Troubleshooting resource contention issues &nbsp;|&nbsp; Google Distributed Cloud (software only) for VMware &nbsp;|&nbsp; Google Cloud</a>.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-24T04:54:57.987Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 34,
        "readers_count": 33,
        "score": 6.8,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Johannes Scheuermann",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://cloud.google.com/kubernetes-engine/distributed-cloud/vmware/docs/troubleshooting/resource-contention",
            "internal": false,
            "reflection": false,
            "title": "Troubleshooting resource contention issues \u00a0|\u00a0 Google Distributed Cloud (software only) for VMware \u00a0|\u00a0 Google Cloud",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 849,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14277,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-07-24T11:32:42.256Z",
        "cooked": "<p>Thanks for the replies!</p>\n<p>I\u2019ll remove the cpu limits to make sure, but I also have this on an empty cluster without any clients (except for status json from monitoring every 10s). There is no cpu usage on the CC and definitely no CPU throttling from our cadvisor metrics. Is it possible that the <code>status json</code> every 10s has impact on an empty cluster without seeing this on CPU usage? I can try stopping monitoring to test.</p>\n<p>All roles have their own process, however, coordinators are on storage pods. So CC is it\u2019s own pod. Could coordinator (+storage) slowness result in this behaviour?</p>\n<aside class=\"quote no-group\" data-username=\"jzhou\" data-post=\"4\" data-topic=\"4562\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/jzhou/48/445_2.png\" class=\"avatar\"> jzhou:</div>\n<blockquote>\n<p>CC should placed on stateless processes, not with SSes.</p>\n</blockquote>\n</aside>\n<p>Ok, I\u2019ll try this out. I thought they needed to be on pods with disks (storage or log), so I\u2019ll have to add disks to all stateless processes which the operator doesn\u2019t do by default. Again, on an empty clusters without storage pod CPU usage I see this behaviour. Edit: see below, CC is separate on stateless pods.</p>\n<p>A screenshot of how \u201cunstable\u201d CC is, although in 12h before this there where no changes in roles.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/2X/1/184dd01334c4e492479db21417c21c2da78b4fbc.png\" data-download-href=\"/uploads/short-url/3t0aGP8ZpelRxAWitNqM025yH4o.png?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/2X/1/184dd01334c4e492479db21417c21c2da78b4fbc_2_604x500.png\" alt=\"image\" data-base62-sha1=\"3t0aGP8ZpelRxAWitNqM025yH4o\" width=\"604\" height=\"500\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/2X/1/184dd01334c4e492479db21417c21c2da78b4fbc_2_604x500.png, https://global.discourse-cdn.com/foundationdb/optimized/2X/1/184dd01334c4e492479db21417c21c2da78b4fbc_2_906x750.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/2X/1/184dd01334c4e492479db21417c21c2da78b4fbc_2_1208x1000.png 2x\" data-dominant-color=\"282B2A\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">2936\u00d72430 411 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>We run on N4 VMs, also tried C3 VMs.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-24T18:26:44.215Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 33,
        "readers_count": 32,
        "score": 11.6,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14278,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-07-24T18:24:27.999Z",
        "cooked": "<blockquote>\n<p>CC should placed on stateless processes, not with SSes.</p>\n</blockquote>\n<p>Oops ignore (part of) my previous comment, I was confused with the coordinators. CC is it\u2019s own pod and is on stateless pods(without disks). Coordinators do live with the SS (which I assume is ok according to the operator &amp; fdb docs.)</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-24T18:25:33.739Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 29,
        "readers_count": 28,
        "score": 10.8,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14283,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-07-25T19:56:25.204Z",
        "cooked": "<p>Testing without CPU limit on all FDB pods doesn\u2019t seem to improve the situation\u2026</p>\n<p>Full clusterspec:</p>\n<pre><code class=\"lang-auto\">apiVersion: apps.foundationdb.org/v1beta2\nkind: FoundationDBCluster\nmetadata:\n  name: testing\n  namespace: fdb-testing\nspec:\n  automationOptions:\n    deletionMode: Zone\n    podUpdateStrategy: ReplaceTransactionSystem\n    removalMode: Zone\n    useLocalitiesForExclusion: true\n  coordinatorSelection:\n  - priority: 100\n    processClass: storage\n  databaseConfiguration:\n    commit_proxies: 1\n    logs: 2\n    storage: 3\n    storage_engine: ssd-2\n  imageType: split\n  maxZonesWithUnavailablePods: 1\n  minimumUptimeSecondsForBounce: 600\n  processes:\n    log:\n      podTemplate:\n        spec:\n          containers:\n          - name: foundationdb\n            resources:\n              limits:\n                memory: 4Gi\n              requests:\n                cpu: 1\n                memory: 4Gi\n      volumeClaimTemplate:\n        spec:\n          resources:\n            requests:\n              storage: 25Gi\n          storageClassName: hyperdisk-balanced-fdb-logs\n    stateless:\n      podTemplate:\n        spec:\n          containers:\n          - name: foundationdb\n            resources:\n              limits:\n                memory: 4Gi\n              requests:\n                cpu: 1\n                memory: 4Gi\n    storage:\n      customParameters:\n      - memory = 8GiB\n      - cache-memory = 2GiB\n      podTemplate:\n        spec:\n          containers:\n          - name: foundationdb\n            resources:\n              limits:\n                memory: 8Gi\n              requests:\n                cpu: 1\n                memory: 8Gi\n      volumeClaimTemplate:\n        spec:\n          resources:\n            requests:\n              storage: 50Gi\n          storageClassName: hyperdisk-balanced-fdb-storage-v2\n  replaceInstancesWhenResourcesChange: false\n  routing:\n    useDNSInClusterFile: true\n  skip: false\n  version: 7.1.61\n</code></pre>\n<p>A <code>Net2RunLoopTrace</code> that often comes back on CC is this:<br>\n<code>addr2line -e fdbserver.debug -p -C -f -i 0x793bf44a3630 0x793bf44a0aa1 0x43cbdc4 0x43cda55 0xdd29f6 0x793bf40e8555 0xe399d2</code></p>\n<pre><code class=\"lang-auto\">bash-4.2# addr2line -e /usr/bin/fdbserver -p -C -f -i 0x793bf44a3630 0x793bf44a0aa1 0x43cbdc4 0x43cda55 0xdd29f6 0x793bf40e8555 0xe399d2\n?? ??:0\n?? ??:0\nN2::ASIOReactor::sleep(double) at ??:?\n (inlined by) boost::asio::basic_deadline_timer&lt;boost::posix_time::ptime, boost::asio::time_traits&lt;boost::posix_time::ptime&gt;, boost::asio::any_io_executor&gt;::cancel() at /opt/boost_1_78_0/include/boost/asio/basic_deadline_timer.hpp:348\n (inlined by) N2::ASIOReactor::sleep(double) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Net2.actor.cpp:2089\nN2::Net2::run() at ??:?\n (inlined by) MetricHandle&lt;ContinuousMetric&lt;bool&gt; &gt;::operator=(bool const&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/TDMetric.actor.h:1374\n (inlined by) N2::Net2::run() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Net2.actor.cpp:1516\nmain at ??:?\n?? ??:0\n_start at ??:?\n</code></pre>\n<p>Not sure how to interpret this \u2026</p>\n<p>At this point the only differences between our previous architecture are the VM types(N1 vs C3/N4), the disks (pd-ssd vs hyperdisk-balanced) and the use of DNS in the clusterfile.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-07-25T19:56:25.204Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 32,
        "readers_count": 31,
        "score": 26.4,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1442,
          "username": "jlemaes",
          "name": "Jasper Maes",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14300,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-08-13T06:06:05.614Z",
        "cooked": "<p>The problem is related to DNS where there are A and AAAA queries of the coordinators are being done in CC for each heartbeat to the coordinators. The problem occurs when the A records does return, but for some reason the AAAA does not (which is always empty as we have an ipv4 only cluster).</p>\n<p>Looking at the code there should be a retry after <code>HOSTNAME_RESOLVE_INIT_INTERVAL</code> in <code>resolveWithRetryImpl</code> but that doesn\u2019t seem to work in this case. I can send the tcpdump in case anyone is interested.</p>\n<p>I will try if <code>RESOLVE_PREFER_IPV4_ADDR = true</code> fixes this issue in our environment.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-08-13T06:06:05.614Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 25,
        "readers_count": 24,
        "score": 25.0,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14306,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2024-08-20T18:22:21.017Z",
        "cooked": "<p><code>RESOLVE_PREFER_IPV4_ADDR = true</code> didn\u2019t fix the problem. It\u2019s also not related to A vs AAAA queries but that does complicates the issue a bit as there\u2019s higher probability for the hostname resolve to fail/hang.</p>\n<p>I was able to fix this by adding a dnsconfig option to all pods:</p>\n<pre><code class=\"lang-auto\">dnsConfig:\n  options:\n    - name: timeout\n      value: \"1\"\n</code></pre>\n<p>The default in GKE is a timeout of 2 (seconds).</p>\n<p>This does raise a question a few questions:</p>\n<ul>\n<li>I was under the assumption the FDB should be responsible itself to retry these DNS requests if it doesn\u2019t have a reply after <code>HOSTNAME_RESOLVE_INIT_INTERVAL</code>, see  <code>resolveWithRetryImpl</code>: <a href=\"https://github.com/apple/foundationdb/blob/release-7.1/flow/Hostname.actor.cpp#L58\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">foundationdb/flow/Hostname.actor.cpp at release-7.1 \u00b7 apple/foundationdb \u00b7 GitHub</a> I guess my assumption was wrong and only if the dns resolve fails, FDB will retry it after the delay.</li>\n<li>Unsure about this but I cannot explain it otherwise: Because these heartbeats happen sequentially and one dns query can hang, it looks like the rest of the heartbeats don\u2019t happen. This causes the quorum of heartbeats not being reached and CC releasing its leadership. So a single  failed(hanging) heartbeat results in a recovery, the rest of the heartbeats are potentially not executed.</li>\n</ul>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-08-20T18:36:22.707Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 25,
        "readers_count": 24,
        "score": 45.0,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/release-7.1/flow/Hostname.actor.cpp#L58",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/flow/Hostname.actor.cpp at release-7.1 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 2
          },
          {
            "url": "https://forums.foundationdb.org/t/multi-region-cluster-regular-cluster-elections-how-to-debug/4862/2",
            "internal": true,
            "reflection": true,
            "title": "Multi region cluster, \"regular\" cluster elections: how to debug?",
            "clicks": 0
          },
          {
            "url": "https://forums.foundationdb.org/t/which-publicipsource-to-use-when-using-fdb-with-multi-region-and-kubernetes/4776/2",
            "internal": true,
            "reflection": true,
            "title": "Which publicIPSource to use when using FDB with multi-region and kubernetes?",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14343,
        "name": "Johannes Scheuermann",
        "username": "johscheuer",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png",
        "created_at": "2024-09-09T14:15:53.228Z",
        "cooked": "<p>Thanks for the report. I haven\u2019t looked at the DNS resolution path in detail, but I will take some time. I thought that the DNS entries are only used once during the cluster connection and after that only IP addresses should be used, so I\u2019m a bit surprised that the DNS records are queried multiple times. CC <a class=\"mention\" href=\"/u/jzhou\">@jzhou</a></p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2024-09-09T14:15:53.228Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 21,
        "readers_count": 20,
        "score": 9.2,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Johannes Scheuermann",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 1442,
          "username": "jlemaes",
          "name": "Jasper Maes",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 849,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14873,
        "name": "Matthieu Patou",
        "username": "mpatou_openai",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mpatou_openai/{size}/1883_2.png",
        "created_at": "2025-04-24T17:31:18.615Z",
        "cooked": "<p>Pilling up here a bit, I was also told that <code>fdb</code> would only seldomly use DNS (<a href=\"https://forums.foundationdb.org/t/which-publicipsource-to-use-when-using-fdb-with-multi-region-and-kubernetes/4776/2\" class=\"inline-onebox\">Which publicIPSource to use when using FDB with multi-region and kubernetes? - #2 by johscheuer</a>) but</p>\n<pre><code class=\"lang-auto\">date; tcpdump -i any port 53 -n -c 1000|grep fdb-cluster-log-72213.fdb-cluster.fdb |wc -l ; date\n</code></pre>\n<p>Shows 54 queries (A and AAAA) over the course of 8 seconds for a single pod.</p>\n<p>When look at all the queries made I have ~500 queries over the 8 seconds</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-24T17:31:18.615Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 23.6,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Matthieu Patou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/which-publicipsource-to-use-when-using-fdb-with-multi-region-and-kubernetes/4776/2",
            "internal": true,
            "reflection": false,
            "title": "Which publicIPSource to use when using FDB with multi-region and kubernetes?",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 849,
          "username": "johscheuer",
          "name": "Johannes Scheuermann",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1484,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14883,
        "name": "Jingyu Zhou",
        "username": "jzhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "created_at": "2025-04-28T15:59:57.520Z",
        "cooked": "<p>When the coordinators are DNS names, we\u2019ll use them:</p><aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247\" target=\"_blank\" rel=\"noopener\">github.com/apple/foundationdb</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247\" target=\"_blank\" rel=\"noopener\">fdbserver/LeaderElection.actor.cpp</a></h4>\n\n<div class=\"git-blob-info\">\n  <a href=\"https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247\" rel=\"noopener\"><code>main</code></a>\n</div>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-cpp\">\n      <ol class=\"start lines\" start=\"237\" style=\"counter-reset: li-counter 236 ;\">\n          <li>\t\tif (myInfo.changeID != prevChangeID) {</li>\n          <li>\t\t\tTraceEvent(\"ChangeLeaderChangeID\")</li>\n          <li>\t\t\t    .detail(\"PrevChangeID\", prevChangeID)</li>\n          <li>\t\t\t    .detail(\"NewChangeID\", myInfo.changeID);</li>\n          <li>\t\t}</li>\n          <li></li>\n          <li>\t\tstate std::vector&lt;Future&lt;Void&gt;&gt; true_heartbeats;</li>\n          <li>\t\tstate std::vector&lt;Future&lt;Void&gt;&gt; false_heartbeats;</li>\n          <li>\t\tfor (int i = 0; i &lt; coordinators.leaderElectionServers.size(); i++) {</li>\n          <li>\t\t\tFuture&lt;LeaderHeartbeatReply&gt; hb;</li>\n          <li class=\"selected\">\t\t\tif (coordinators.leaderElectionServers[i].hostname.present()) {</li>\n          <li>\t\t\t\thb = retryGetReplyFromHostname(LeaderHeartbeatRequest(coordinators.clusterKey, myInfo, prevChangeID),</li>\n          <li>\t\t\t\t                               coordinators.leaderElectionServers[i].hostname.get(),</li>\n          <li>\t\t\t\t                               WLTOKEN_LEADERELECTIONREG_LEADERHEARTBEAT,</li>\n          <li>\t\t\t\t                               TaskPriority::CoordinationReply);</li>\n          <li>\t\t\t} else {</li>\n          <li>\t\t\t\thb = retryBrokenPromise(coordinators.leaderElectionServers[i].leaderHeartbeat,</li>\n          <li>\t\t\t\t                        LeaderHeartbeatRequest(coordinators.clusterKey, myInfo, prevChangeID),</li>\n          <li>\t\t\t\t                        TaskPriority::CoordinationReply);</li>\n          <li>\t\t\t}</li>\n          <li>\t\t\ttrue_heartbeats.push_back(onEqual(hb, LeaderHeartbeatReply{ true }));</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>Checking <code>retryGetReplyFromHostname</code> code, we are using <code>HOSTNAME_RECONNECT_INIT_INTERVAL=0.05</code> and retry doubling the delay until <code>HOSTNAME_RECONNECT_MAX_INTERVAL=1.0</code> . So retries can happen many times in a second.</p>\n<p>By default, we disable <code>ENABLE_COORDINATOR_DNS_CACHE</code> knob, because the thought is that this feature is not useful for reasons</p>\n<ol>\n<li>This FDB cache doesn\u2019t have TTLs and expirations; and</li>\n<li>OS should properly caches DNS entries and quickly reply if cache hits, and OS will properly handle DNS entry\u2019s TTL.</li>\n</ol>\n<p>I tend to think this DNS resolution problem is a deployment issue, where DNS servers are not responding faster enough or not setting TTL correctly.</p>\n<p>If the DNS servers can\u2019t be fixed, we can try setting <code>ENABLE_COORDINATOR_DNS_CACHE</code> to <code>true</code> , which only does DNS resolution once, but without refreshing entries or respecting DNS TTLs.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-28T16:01:32.890Z",
        "reply_count": 1,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 19,
        "readers_count": 18,
        "score": 8.8,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jingyu Zhou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/fdbserver/LeaderElection.actor.cpp at main \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1484,
          "username": "mpatou_openai",
          "name": "Matthieu Patou",
          "avatar_template": "/user_avatar/forums.foundationdb.org/mpatou_openai/{size}/1883_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 454,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14884,
        "name": "Matthieu Patou",
        "username": "mpatou_openai",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mpatou_openai/{size}/1883_2.png",
        "created_at": "2025-04-28T16:12:59.573Z",
        "cooked": "<p>I can see your point about relying on the caching at the OS level, my impression is that by default pods are not doing caching in kubernetes maybe there is <em>some</em> at the <code>kubedns</code> level but it seems not adequate.<br>\nIt might be a good idea to mention that when using DNS + kubernetes operator it\u2019s highly advisable to ensure that proper caching is configured.</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-28T16:12:59.573Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 3.6,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Matthieu Patou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1484,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14885,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2025-04-28T18:57:53.862Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"jzhou\" data-post=\"13\" data-topic=\"4562\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/jzhou/48/445_2.png\" class=\"avatar\"> jzhou:</div>\n<blockquote>\n<p>Checking <code>retryGetReplyFromHostname</code> code, we are using <code>HOSTNAME_RECONNECT_INIT_INTERVAL=0.05</code> and retry doubling the delay until <code>HOSTNAME_RECONNECT_MAX_INTERVAL=1.0</code> . So retries can happen many times in a second.</p>\n</blockquote>\n</aside>\n<p>Yes, retries will happen in case the DNS query <em>fails</em>, but the behavior I observed was that it just <em>hangs</em>, it never returns until the pod\u2019s OS DNS resolver reaches the timeout. Only when the DNS resolver returns the timeout, FDB will retry the resolve using <code>HOSTNAME_RESOLVE_INIT_INTERVAL</code>/<code>HOSTNAME_RESOLVE_MAX_INTERVAL</code>. This can still happen if there is a disconnect between the pod OS resolver timeout settings and what FDB expects in the leaderelection heartbeat. In my opinion, if FDB relies on a fast DNS response, it should add a deadline/timeout in the query.</p>\n<p>A local cache will help, but a hanging DNS query can still happen with a cache? It is still a UDP packet to a local process on the node in most cases in k8s (see <a href=\"https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Using NodeLocal DNSCache in Kubernetes Clusters | Kubernetes</a>).</p>\n<p>The leaderelection never reaches the actual connection where <code>HOSTNAME_RECONNECT_INIT_INTERVAL</code> / <code>HOSTNAME_RECONNECT_MAX_INTERVAL</code> is used when DNS resolve hangs on this line: <a href=\"https://github.com/apple/foundationdb/blob/main/fdbrpc/include/fdbrpc/genericactors.actor.h#L143\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">foundationdb/fdbrpc/include/fdbrpc/genericactors.actor.h at main \u00b7 apple/foundationdb \u00b7 GitHub</a></p>\n<p>As highlighted before in this thread, I fixed this by lowering the pod resolver DNS timeout, which will make FDB retry the DNS query using <code>HOSTNAME_RESOLVE_INIT_INTERVAL</code>/<code>HOSTNAME_RESOLVE_MAX_INTERVAL</code>.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-28T18:57:53.862Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 19,
        "readers_count": 18,
        "score": 13.8,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/",
            "internal": false,
            "reflection": false,
            "title": "Using NodeLocal DNSCache in Kubernetes Clusters | Kubernetes",
            "clicks": 2
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/main/fdbrpc/include/fdbrpc/genericactors.actor.h#L143",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/fdbrpc/include/fdbrpc/genericactors.actor.h at main \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14889,
        "name": "Jingyu Zhou",
        "username": "jzhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "created_at": "2025-04-29T05:13:14.389Z",
        "cooked": "<p>Yes, FDB assumes a fast DNS response. In the past, FDB doesn\u2019t support DNS and uses IP:Port to avoid external dependency on DNS.</p>\n<p>If DNS is slow, I guess we could timeout earlier and retry DNS query, which may help in some cases, but does not solve all cases. I wonder why a DNS retry is faster (and solves your problem)? FDB uses <code>boost::asio::ip::tcp::resolver</code>, which seems to use TCP and should not drop packets.</p>\n<p>Agree with <a class=\"mention\" href=\"/u/mpatou_openai\">@mpatou_openai</a> that \u201cDNS + kubernetes operator\u201d should be carefully configured. If the default pod is not caching DNS entries, then I can see why the problem arises.</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-29T05:13:14.389Z",
        "reply_count": 1,
        "reply_to_post_number": 15,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jingyu Zhou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1442,
          "username": "jlemaes",
          "name": "Jasper Maes",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 454,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 14896,
        "name": "Jasper Maes",
        "username": "jlemaes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "created_at": "2025-04-29T23:07:33.399Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"jzhou\" data-post=\"16\" data-topic=\"4562\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/jzhou/48/445_2.png\" class=\"avatar\"> jzhou:</div>\n<blockquote>\n<p>FDB uses <code>boost::asio::ip::tcp::resolver</code>, which seems to use TCP and should</p>\n</blockquote>\n</aside>\n<p>Interesting, my tcpdumps captured UDP packets for DNS.</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 17,
        "updated_at": "2025-04-29T23:07:45.614Z",
        "reply_count": 0,
        "reply_to_post_number": 16,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 3.6,
        "yours": false,
        "topic_id": 4562,
        "topic_slug": "fdb-regular-recovery-with-operator",
        "display_username": "Jasper Maes",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1442,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-regular-recovery-with-operator/4562/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      14250,
      14256,
      14270,
      14273,
      14274,
      14277,
      14278,
      14283,
      14300,
      14306,
      14343,
      14873,
      14883,
      14884,
      14885,
      14889,
      14896
    ]
  },
  "timeline_lookup": [
    [
      1,
      467
    ],
    [
      2,
      464
    ],
    [
      3,
      456
    ],
    [
      4,
      455
    ],
    [
      6,
      454
    ],
    [
      8,
      453
    ],
    [
      9,
      435
    ],
    [
      10,
      427
    ],
    [
      11,
      407
    ],
    [
      12,
      180
    ],
    [
      13,
      176
    ],
    [
      17,
      175
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "FDB regular recovery with operator",
  "id": 4562,
  "title": "FDB regular recovery with operator",
  "posts_count": 17,
  "created_at": "2024-07-11T21:44:18.817Z",
  "views": 379,
  "reply_count": 9,
  "like_count": 2,
  "last_posted_at": "2025-04-29T23:07:33.399Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "fdb-regular-recovery-with-operator",
  "category_id": 16,
  "word_count": 2723,
  "deleted_at": null,
  "user_id": 1442,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_4562",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 17,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 1,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Failure / Recovery scenario",
      "id": 2384,
      "title": "Failure / Recovery scenario",
      "slug": "failure-recovery-scenario",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2020-10-10T01:06:26.706Z",
      "last_posted_at": "2020-10-12T13:36:11.016Z",
      "bumped": true,
      "bumped_at": "2020-10-12T13:36:11.016Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 695,
      "category_id": 16,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 819,
            "username": "mbuleandra",
            "name": "Marius",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mbuleandra/{size}/977_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "FDB kubernetes operator continuously boucing processes",
      "id": 2092,
      "title": "FDB kubernetes operator continuously boucing processes",
      "slug": "fdb-kubernetes-operator-continuously-boucing-processes",
      "posts_count": 9,
      "reply_count": 5,
      "highest_post_number": 9,
      "image_url": null,
      "created_at": "2020-04-29T10:57:13.947Z",
      "last_posted_at": "2020-05-03T07:18:12.844Z",
      "bumped": true,
      "bumped_at": "2020-05-03T07:18:12.844Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1013,
      "category_id": 16,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 724,
            "username": "larshagen",
            "name": "Lars Hagen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/larshagen/{size}/776_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Proposal: Don&rsquo;t identify a coordinator based on its IP",
      "id": 502,
      "title": "Proposal: Don't identify a coordinator based on its IP",
      "slug": "proposal-dont-identify-a-coordinator-based-on-its-ip",
      "posts_count": 26,
      "reply_count": 13,
      "highest_post_number": 26,
      "image_url": null,
      "created_at": "2018-06-09T13:09:51.305Z",
      "last_posted_at": "2019-08-06T20:24:41.013Z",
      "bumped": true,
      "bumped_at": "2019-08-06T20:24:41.013Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 10,
      "views": 8425,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 302,
            "username": "basgys",
            "name": "Bastien Gysler",
            "avatar_template": "/user_avatar/forums.foundationdb.org/basgys/{size}/291_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 339,
            "username": "Zatte",
            "name": "Mikael Rapp ",
            "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 260,
            "username": "jared2501",
            "name": "Jared2501",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 545,
            "username": "rishabh",
            "name": "Rishabh",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rishabh/{size}/540_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 614,
            "username": "qrpike",
            "name": "Quinton Pike",
            "avatar_template": "/user_avatar/forums.foundationdb.org/qrpike/{size}/618_2.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Recovering from FoundationDB crashes",
      "id": 2846,
      "title": "Recovering from FoundationDB crashes",
      "slug": "recovering-from-foundationdb-crashes",
      "posts_count": 6,
      "reply_count": 2,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2021-08-09T18:21:00.384Z",
      "last_posted_at": "2021-08-24T18:40:23.091Z",
      "bumped": true,
      "bumped_at": "2021-08-24T18:40:23.091Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "operator"
      ],
      "tags_descriptions": {},
      "like_count": 5,
      "views": 921,
      "category_id": 16,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 927,
            "username": "peter",
            "name": "Peter Zeller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/peter/{size}/1064_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Getting timeout error while reconciling foundationDB cluster in kubernetes",
      "id": 2150,
      "title": "Getting timeout error while reconciling foundationDB cluster in kubernetes",
      "slug": "getting-timeout-error-while-reconciling-foundationdb-cluster-in-kubernetes",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2020-06-01T10:44:55.604Z",
      "last_posted_at": "2020-06-01T16:46:30.092Z",
      "bumped": true,
      "bumped_at": "2020-06-01T16:46:30.092Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 789,
      "category_id": 16,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 772,
            "username": "antonprabin",
            "name": "Prabin Poulose",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/7cd45c/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 1442,
        "username": "jlemaes",
        "name": "Jasper Maes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 849,
        "username": "johscheuer",
        "name": "Johannes Scheuermann",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 454,
        "username": "jzhou",
        "name": "Jingyu Zhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "moderator": true,
        "trust_level": 2
      },
      {
        "id": 1484,
        "username": "mpatou_openai",
        "name": "Matthieu Patou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mpatou_openai/{size}/1883_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      }
    ],
    "created_by": {
      "id": 1442,
      "username": "jlemaes",
      "name": "Jasper Maes",
      "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
    },
    "last_poster": {
      "id": 1442,
      "username": "jlemaes",
      "name": "Jasper Maes",
      "avatar_template": "/user_avatar/forums.foundationdb.org/jlemaes/{size}/1822_2.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/blob/main/contrib/observability_splunk_dashboard/recovery.xml#L94-L116",
        "title": "foundationdb/contrib/observability_splunk_dashboard/recovery.xml at main \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 8,
        "user_id": 849,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://cloud.google.com/kubernetes-engine/distributed-cloud/vmware/docs/troubleshooting/resource-contention",
        "title": "Troubleshooting resource contention issues \u00a0|\u00a0 Google Distributed Cloud (software only) for VMware \u00a0|\u00a0 Google Cloud",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 849,
        "domain": "cloud.google.com",
        "root_domain": "google.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/which-publicipsource-to-use-when-using-fdb-with-multi-region-and-kubernetes/4776/2",
        "title": "Which publicIPSource to use when using FDB with multi-region and kubernetes?",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 1484,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/release-7.1/flow/Hostname.actor.cpp#L58",
        "title": "foundationdb/flow/Hostname.actor.cpp at release-7.1 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 1442,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://kubernetes.io/docs/tasks/administer-cluster/nodelocaldns/",
        "title": "Using NodeLocal DNSCache in Kubernetes Clusters | Kubernetes",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 1442,
        "domain": "kubernetes.io",
        "root_domain": "kubernetes.io"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/main/fdbserver/LeaderElection.actor.cpp#L247",
        "title": "foundationdb/fdbserver/LeaderElection.actor.cpp at main \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 454,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}