{
  "post_stream": {
    "posts": [
      {
        "id": 10663,
        "name": "Amanda",
        "username": "amanda",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/67e7ee/{size}.png",
        "created_at": "2022-02-08T02:05:12.340Z",
        "cooked": "<p>Hi, I\u2019m on FDB 6.3.15 and use TLS. I run a golang service that is an fdb client (using the fdb go bindings) and I had a bug where I passed in the TLS options incorrectly. While debugging this in my test environment I found that while the bad application was running, I couldn\u2019t use fdbcli - even though fdbcli was using the correct TLS file paths. When I turned off the bad application, fdbcli worked again. Has anyone hit this before?</p>\n<p>My go fdb client was using these options: TLS_KEY_BYTES, TLS_CERT_BYTES, TLS_CA_BYTES. The bug was that we were passing the cert bytes for TLS_KEY_BYTES, instead of the correct key bytes. The fdb client error log was:</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1644278513.282748\" DateTime=\"2022-02-08T00:01:53Z\" Type=\"TLSConfigureError\" ID=\"0000000000000000\" What=\"use_private_key: no start line\" Value=\"151584876\" WhichMeans=\"error:0909006C:PEM routines:get_name:no start line\" Machine=\"127.0.0.1:1\" LogGroup=\"default\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1644278513.282748\" DateTime=\"2022-02-08T00:01:53Z\" Type=\"Net2TLSInitError\" ID=\"0000000000000000\" Error=\"tls_error\" ErrorDescription=\"TLS error\" ErrorCode=\"2107\" Machine=\"127.0.0.1:1\" LogGroup=\"default\" /&gt;\n</code></pre>\n<p>When the bad application was running, fdbcli could not connect to the cluster - It listed the coordinator as \u201cunreachable\u201d. In the fdbcli logs I saw:</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"20\" Time=\"1644266837.015345\" DateTime=\"2022-02-07T20:47:17Z\" Type=\"N2_ConnectHandshakeError\" ID=\"0219362e0161359f\" SuppressedEventCount=\"0\" ErrorCode=\"104\" Message=\"Connection reset by peer\" Machine=\"127.0.0.1:3099\" LogGroup=\"default\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1644266837.015345\" DateTime=\"2022-02-07T20:47:17Z\" Type=\"ConnectionTimedOut\" ID=\"0219362e0161359f\" SuppressedEventCount=\"0\" PeerAddr=\"127.0.0.1:4500:tls\" Machine=\"127.0.0.1:3099\" LogGroup=\"default\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1644266837.015345\" DateTime=\"2022-02-07T20:47:17Z\" Type=\"ConnectionClosed\" ID=\"0219362e0161359f\" Error=\"connection_failed\" ErrorDescription=\"Network connection failed\" ErrorCode=\"1026\" SuppressedEventCount=\"0\" PeerAddr=\"127.0.0.1:4500:tls\" Machine=\"127.0.0.1:3099\" LogGroup=\"default\" /&gt;\n</code></pre>\n<p>The coordinator fdbserver had the same error logs in both cases (when the bad client tried to connect, and also when fdbcli tried to connect while the bad client was running):</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1644275302.401044\" DateTime=\"2022-02-07T23:08:22Z\" Type=\"ConnectionFrom\" ID=\"af314dd7cb821090\" SuppressedEventCount=\"0\" FromAddress=\"127.0.0.1:38156:tls\" ListenAddress=\"0.0.0.0:4500:tls\" Machine=\"127.0.0.1:4500\" LogGroup=\"default\" Roles=\"CC,CD,RV\" /&gt;\n&lt;Event Severity=\"20\" Time=\"1644275302.403588\" DateTime=\"2022-02-07T23:08:22Z\" Type=\"N2_AcceptHandshakeError\" ID=\"0000000000000000\" ErrorCode=\"337100999\" ErrorMsg=\"peer did not return a certificate\" BackgroundThread=\"1\" Machine=\"127.0.0.1:4500\" LogGroup=\"default\" Roles=\"CC,CD,RV\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1644275302.403611\" DateTime=\"2022-02-07T23:08:22Z\" Type=\"IncomingConnectionError\" ID=\"af314dd7cb821090\" Error=\"connection_failed\" ErrorDescription=\"Network connection failed\" ErrorCode=\"1026\" SuppressedEventCount=\"0\" FromAddress=\"127.0.0.1:38156:tls\" Machine=\"127.0.0.1:4500\" LogGroup=\"default\" Roles=\"CC,CD,RV\" /&gt;\n</code></pre>\n<p>Obviously it makes total sense why my go fdb client couldn\u2019t connect, but I don\u2019t understand why this caused fdbcli to not work either. The TLS files used by fdbcli are only used by fdbcli, not touched by the go application. My steps were:</p>\n<ol>\n<li>Run fdbcli - coordinator unreachable</li>\n<li>Stop go application</li>\n<li>Exit fdbcli</li>\n<li>Run fdbcli - coordinator reachable</li>\n</ol>\n<p>I\u2019m running everything on the same machine (go application, fdbcli, fdbservers) and my cluster has just 1 coordinator.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 1,
        "updated_at": "2022-02-08T02:05:12.340Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 77,
        "reads": 21,
        "readers_count": 20,
        "score": 384.2,
        "yours": false,
        "topic_id": 3152,
        "topic_slug": "could-not-use-fdbcli-because-of-a-separate-badly-tls-configured-fdb-client",
        "display_username": "Amanda",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 810,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/could-not-use-fdbcli-because-of-a-separate-badly-tls-configured-fdb-client/3152/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      }
    ],
    "stream": [
      10663
    ]
  },
  "timeline_lookup": [
    [
      1,
      1352
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Could not use fdbcli because of a (separate) badly-TLS-configured fdb client?",
  "id": 3152,
  "title": "Could not use fdbcli because of a (separate) badly-TLS-configured fdb client?",
  "posts_count": 1,
  "created_at": "2022-02-08T02:05:12.257Z",
  "views": 1794,
  "reply_count": 0,
  "like_count": 0,
  "last_posted_at": "2022-02-08T02:05:12.340Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "could-not-use-fdbcli-because-of-a-separate-badly-tls-configured-fdb-client",
  "category_id": 17,
  "word_count": 564,
  "deleted_at": null,
  "user_id": 810,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_3152",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 1,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 1,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "(Solved) Correct setup of TLS for FoundationDB",
      "id": 1037,
      "title": "(Solved) Correct setup of TLS for FoundationDB",
      "slug": "solved-correct-setup-of-tls-for-foundationdb",
      "posts_count": 8,
      "reply_count": 3,
      "highest_post_number": 8,
      "image_url": null,
      "created_at": "2019-01-18T13:14:34.597Z",
      "last_posted_at": "2020-12-03T19:46:59.291Z",
      "bumped": true,
      "bumped_at": "2020-12-03T19:46:59.291Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 3516,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 483,
            "username": "Smerity",
            "name": "Stephen Merity",
            "avatar_template": "/user_avatar/forums.foundationdb.org/smerity/{size}/482_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 120,
            "username": "josephg",
            "name": "Seph Gentle",
            "avatar_template": "/user_avatar/forums.foundationdb.org/josephg/{size}/84_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 790,
            "username": "shubham4060",
            "name": "Shubham",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/s/0ea827/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "TLS setup on Mac and Linux",
      "id": 1188,
      "title": "TLS setup on Mac and Linux",
      "slug": "tls-setup-on-mac-and-linux",
      "posts_count": 11,
      "reply_count": 3,
      "highest_post_number": 11,
      "image_url": null,
      "created_at": "2019-02-27T23:46:10.601Z",
      "last_posted_at": "2019-03-05T21:06:08.324Z",
      "bumped": true,
      "bumped_at": "2019-03-05T21:06:08.324Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 958,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 525,
            "username": "samir",
            "name": "Samir",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/s/ea666f/{size}.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "TLS implemenation for foundationdb",
      "id": 3503,
      "title": "TLS implemenation for foundationdb",
      "slug": "tls-implemenation-for-foundationdb",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2022-08-17T16:16:01.361Z",
      "last_posted_at": "2022-08-18T04:03:11.190Z",
      "bumped": true,
      "bumped_at": "2022-08-18T11:36:36.646Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 566,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 1116,
            "username": "gvddk",
            "name": "Deekshit kumar",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/bbce88/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Set up fdb to use TLS failure with N2_ConnectError",
      "id": 3020,
      "title": "Set up fdb to use TLS failure with N2_ConnectError",
      "slug": "set-up-fdb-to-use-tls-failure-with-n2-connecterror",
      "posts_count": 9,
      "reply_count": 3,
      "highest_post_number": 9,
      "image_url": null,
      "created_at": "2021-11-19T08:38:17.530Z",
      "last_posted_at": "2021-11-23T00:53:27.886Z",
      "bumped": true,
      "bumped_at": "2021-11-23T05:48:39.795Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1054,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 1029,
            "username": "liuyan",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/839c29/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Issue with TLS in foundationdb docker container",
      "id": 2504,
      "title": "Issue with TLS in foundationdb docker container",
      "slug": "issue-with-tls-in-foundationdb-docker-container",
      "posts_count": 5,
      "reply_count": 2,
      "highest_post_number": 5,
      "image_url": null,
      "created_at": "2021-01-05T02:45:20.081Z",
      "last_posted_at": "2021-01-05T06:25:52.461Z",
      "bumped": true,
      "bumped_at": "2021-01-05T06:25:52.461Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 614,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 772,
            "username": "antonprabin",
            "name": "Prabin Poulose",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/7cd45c/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 810,
        "username": "amanda",
        "name": "Amanda",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/67e7ee/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      }
    ],
    "created_by": {
      "id": 810,
      "username": "amanda",
      "name": "Amanda",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/67e7ee/{size}.png"
    },
    "last_poster": {
      "id": 810,
      "username": "amanda",
      "name": "Amanda",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/67e7ee/{size}.png"
    }
  },
  "bookmarks": []
}