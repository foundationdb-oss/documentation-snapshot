{
  "post_stream": {
    "posts": [
      {
        "id": 11364,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-01T00:26:40.508Z",
        "cooked": "<p>I was wondering what the current status of <a href=\"https://github.com/apple/foundationdb/pull/3349\" rel=\"noopener nofollow ugc\">this</a> PR is and if we might see changes to <code>commit_unknown_result</code> in the next 6-12 months?</p>\n<p><code>commit_unknown_result</code> is a retry able error in most language bindings including Rust. Something that I am considering doing in my layer, is to make this a non-retryable error. Has this approach been tried before? If so, can you please share your experience.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-01T00:26:40.508Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 72,
        "reads": 26,
        "readers_count": 25,
        "score": 370.2,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/pull/3349",
            "internal": false,
            "reflection": false,
            "title": "Make commit_unknown_results unlikely by sfc-gh-mpilman \u00b7 Pull Request #3349 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 7
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 11373,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2022-07-01T14:32:07.850Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/andrew.noyes\">@andrew.noyes</a> had a different idea for this problem, but I can\u2019t seem to find his write up at the moment.</p>\n<p>My PR would mostly need to be correctness and performance tested. But currently this doesn\u2019t have a high priority.</p>\n<aside class=\"quote no-group\" data-username=\"rajivr\" data-post=\"1\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rajivr/48/1100_2.png\" class=\"avatar\"> rajivr:</div>\n<blockquote>\n<p>Something that I am considering doing in my layer, is to make this a non-retryable error.</p>\n</blockquote>\n</aside>\n<p>What\u2019s the reasoning for this? I understand <code>commit_unknown_result</code> is harder to handle for applications, but there\u2019s also value in having bindings being consistent. Of course, if you talk about a more high-level layer (I am not sure \u2013 are you talking about the rust bindings or some more complex layer?), this might make much more sense.</p>\n<p>For a layer I think it would be cool if they would solve the problem and make every transaction idempotent. For idempotent transactions <code>commit_unknown_result</code> is a non-issue. Depending on the data model your layer uses this might be much easier than solving the problem in FDB.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-01T14:32:07.850Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 26,
        "readers_count": 25,
        "score": 20.2,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11379,
        "name": "",
        "username": "andrew.noyes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
        "created_at": "2022-07-01T16:50:39.005Z",
        "cooked": "<p>Here\u2019s the write-up: <a href=\"https://github.com/sfc-gh-anoyes/foundationdb/blob/anoyes/idempotency-keys-design/design/idempotency_keys.md\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">foundationdb/idempotency_keys.md at anoyes/idempotency-keys-design \u00b7 sfc-gh-anoyes/foundationdb \u00b7 GitHub</a>.</p>\n<p>It\u2019s actually a bit out of date (one thing I plan to do is rewrite it to use the terminology of \u201cidempotency id\u201d instead of \u201cidempotency key\u201d because so far it has been confusing lol), but then main ideas are there. I would not plan on me landing this in the next 6-12 months, although it is a possibility.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-01T16:50:39.005Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 23,
        "readers_count": 22,
        "score": 4.6,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/sfc-gh-anoyes/foundationdb/blob/anoyes/idempotency-keys-design/design/idempotency_keys.md",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/idempotency_keys.md at anoyes/idempotency-keys-design \u00b7 sfc-gh-anoyes/foundationdb \u00b7 GitHub",
            "clicks": 12
          }
        ],
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 14,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11381,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-01T23:18:13.503Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"2\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>What\u2019s the reasoning for this? I understand <code>commit_unknown_result</code> is harder to handle for applications, but there\u2019s also value in having bindings being consistent. Of course, if you talk about a more high-level layer (I am not sure \u2013 are you talking about the rust bindings or some more complex layer?), this might make much more sense.</p>\n</blockquote>\n</aside>\n<p>Sorry, my last comment was not clear. I was referring to higher-level layer that I would build on top of the rust bindings. I had no plans of changing the behavior of rust bindings.</p>\n<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"2\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>For a layer I think it would be cool if they would solve the problem and make every transaction idempotent. For idempotent transactions <code>commit_unknown_result</code> is a non-issue. Depending on the data model your layer uses this might be much easier than solving the problem in FDB.</p>\n</blockquote>\n</aside>\n<p>Since I started this thread, I\u2019ve been thinking more about this issue and have sketched out an initial design for fdb-rl crate. It uses ideas from your design, but tries to implement it in a layer. <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>I\u2019ll share the design document early next week.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-01T23:23:59.651Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 9.4,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11406,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-06T02:31:59.326Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/markus.pilman\">@markus.pilman</a> <a class=\"mention\" href=\"/u/andrew.noyes\">@andrew.noyes</a>  here is the <a href=\"https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit?usp=sharing\" rel=\"noopener nofollow ugc\">fdb-rl Rust Create Idempotency Design</a> document.</p>\n<p>I would really appreciate if you could please review it and let me know your feedback.</p>\n<p>Also if you can suggest other FDB community members whose feedback would be valuable, please let me know and I will also request them for their inputs.</p>\n<p>Thanks in advance! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-06T02:55:52.575Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 20,
        "readers_count": 19,
        "score": 9.0,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit?usp=sharing",
            "internal": false,
            "reflection": false,
            "title": "fdb-rl Crate Idempotency Design - Google Docs",
            "clicks": 11
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11435,
        "name": "",
        "username": "andrew.noyes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
        "created_at": "2022-07-08T23:01:18.062Z",
        "cooked": "<p>I took a look - makes sense to me. One thing I\u2019ll mention is that the way providing automatic idempotency interacts with setting a transaction timeout is very subtle and slightly different from commit_unknown_result. Before replying with commit_unknown_result the fdb client ensures that the commit is <em>no longer in-flight</em>, which is important. A commit that fails with transaction_timed_out is <em>still in-flight</em>, so it could commit <em>after</em> you read the sentinel key.</p>\n<p>Also maybe I missed it but I don\u2019t think the doc mentions what happens if the sentinel key could have been garbage-collected when you read it.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-08T23:01:18.062Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 19,
        "readers_count": 18,
        "score": 18.8,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 14,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11442,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-11T05:50:31.576Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"andrew.noyes\" data-post=\"6\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/andrew.noyes/48/443_2.png\" class=\"avatar\"> andrew.noyes:</div>\n<blockquote>\n<p>A commit that fails with transaction_timed_out is <em>still in-flight</em>, so it could commit <em>after</em> you read the sentinel key.</p>\n</blockquote>\n</aside>\n<p>Thanks a lot for mentioning the issue with <code>transaction_timed_out</code>. I completely forgot about it! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>You had also mentioned the following in a previous <a href=\"https://forums.foundationdb.org/t/how-are-you-testing-your-layers/3324/4\">thread</a>.</p>\n<aside class=\"quote no-group\" data-username=\"andrew.noyes\" data-post=\"4\" data-topic=\"3324\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/andrew.noyes/48/443_2.png\" class=\"avatar\"><a href=\"https://forums.foundationdb.org/t/how-are-you-testing-your-layers/3324/4\">How are you testing your layers?</a></div>\n<blockquote>\n<p>For <code>transaction_timed_out</code> this isn\u2019t so bad, as the default retry loop (i.e. <code>on_error</code>) does not consider <code>transaction_timed_out</code> to be retryable. It does however consider <code>cluster_version_changed</code> to be retryable.</p>\n</blockquote>\n</aside>\n<p>Are there any other <a href=\"https://apple.github.io/foundationdb/api-error-codes.html\" rel=\"noopener nofollow ugc\">error codes</a> similar to <code>cluster_version_changed</code> that has the behavior of being retryable while the transaction is still in-flight?</p>\n<p>In order to correctly deal with in-flight transactions for non-idempotent transactions, would the following mechanism work?</p>\n<ol>\n<li>\n<p>In the event we receive a <code>transaction_timed_out</code> or <code>cluster_version_changed</code>, wait for a specific duration of time, for example 10 seconds.</p>\n</li>\n<li>\n<p>The in-flight transaction would have, by this time, either been committed, or the transaction would have been rejected due to the 5 second limit.</p>\n</li>\n<li>\n<p>After 10 seconds, attempt to read the sentinel key again. This time if we are able to read the sentinel key, that would mean a successful commit. Missing sentinel key would mean the previous transaction failed to commit and would also not commit in the future.</p>\n</li>\n</ol>\n<aside class=\"quote no-group\" data-username=\"andrew.noyes\" data-post=\"6\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/andrew.noyes/48/443_2.png\" class=\"avatar\"> andrew.noyes:</div>\n<blockquote>\n<p>Also maybe I missed it but I don\u2019t think the doc mentions what happens if the sentinel key could have been garbage-collected when you read it.</p>\n</blockquote>\n</aside>\n<p>That would be an error in the garbage collection algorithm. For the design to work correctly, the garbage collection process must leave a threshold (for example: 72 hours) of sentinel keys untouched.</p>\n<p>I\u2019ve updated the document reflect this (Tracking is now enabled, so you can easily find the edit).</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-11T10:33:56.230Z",
        "reply_count": 1,
        "reply_to_post_number": 6,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 17,
        "readers_count": 16,
        "score": 8.4,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/api-error-codes.html",
            "internal": false,
            "reflection": false,
            "title": "Error Codes \u2014 FoundationDB 7.1",
            "clicks": 1
          },
          {
            "url": "https://forums.foundationdb.org/t/how-are-you-testing-your-layers/3324/4",
            "internal": true,
            "reflection": false,
            "title": "How are you testing your layers?",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11446,
        "name": "",
        "username": "andrew.noyes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
        "created_at": "2022-07-11T17:05:22.954Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"rajivr\" data-post=\"7\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rajivr/48/1100_2.png\" class=\"avatar\"> rajivr:</div>\n<blockquote>\n<p>Are there any other <a href=\"https://apple.github.io/foundationdb/api-error-codes.html\" rel=\"noopener nofollow ugc\">error codes</a> similar to <code>cluster_version_changed</code> that has the behavior of being retryable while the transaction is still in-flight?</p>\n</blockquote>\n</aside>\n<p>I think that\u2019s the only one.</p>\n<aside class=\"quote no-group\" data-username=\"rajivr\" data-post=\"7\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rajivr/48/1100_2.png\" class=\"avatar\"> rajivr:</div>\n<blockquote>\n<p>In order to correctly deal with in-flight transactions for non-idempotent transactions, would the following mechanism work?</p>\n</blockquote>\n</aside>\n<p>The mechanism foundationdb uses internally to ensure that a commit is no longer in-flight is to commit a transaction with a write conflict range that intersects the in-flight transaction\u2019s read conflict range, or to get a read version that\u2019s more than MAX_WRITE_TRANSACTION_LIFE_VERSIONS (5e6) beyond that in-flight transaction\u2019s read version. Clock-based approaches have the downside of relying on clocks being trustworthy.</p>\n<aside class=\"quote no-group\" data-username=\"rajivr\" data-post=\"7\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rajivr/48/1100_2.png\" class=\"avatar\"> rajivr:</div>\n<blockquote>\n<p>That would be an error in the garbage collection algorithm. For the design to work correctly, the garbage collection process must leave a threshold (for example: 72 hours) of sentinel keys untouched.</p>\n</blockquote>\n</aside>\n<p>No matter what threshold you choose it\u2019s still theoretically possible to attempt to read a sentinel key that would have been garbage collected.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-11T17:05:22.954Z",
        "reply_count": 1,
        "reply_to_post_number": 7,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 14,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11452,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-12T03:47:52.087Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"andrew.noyes\" data-post=\"8\" data-topic=\"3413\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/andrew.noyes/48/443_2.png\" class=\"avatar\"> andrew.noyes:</div>\n<blockquote>\n<p>The mechanism foundationdb uses internally to ensure that a commit is no longer in-flight is to commit a transaction with a write conflict range that intersects the in-flight transaction\u2019s read conflict range,</p>\n</blockquote>\n</aside>\n<p>Thanks for the reply. Maybe I can use a very similar approach. Please let me know your thoughts on the following.</p>\n<p>Currently the sentinel key-value has the following form.</p>\n<pre><code class=\"lang-auto\">TenantRoot/(TENANT_METADATA,\n            IDEMPOTENCY_DATA,\n            incarnation: int,\n            read_version: i64, \n            idempotency_uuid: uuid,) = (commit_vs: versionstamp,)\n</code></pre>\n<p>I could also introduce a \u201cconflict\u201d key range of the following form. There would be a one-to-one correspondence between a given sentinel-key and its associated \u201cconflict\u201d range.</p>\n<p>(No data would be written in the \u201cconflict\u201d range).</p>\n<pre><code class=\"lang-auto\">TenantRoot/(TENANT_METADATA,\n            IDEMPOTENCY_CONFLICT_RANGE,\n            incarnation: int,\n            read_version: i64,\n            idempotency_uuid: uuid,)\n</code></pre>\n<p>When a transaction first attempts to write the sentinel key, I would include a read conflict range on the sentinel key\u2019s \u201cconflict\u201d range. Lets name this transaction T1 and the conflict range T1_Conflict_Range.</p>\n<p>In the event T1 fails with <code>transaction_timed_out</code> or <code>cluster_version_changed</code>, before attempting a retry, I would create a new transaction T2.</p>\n<p>Transaction T2 would be very simple transaction that would attempt to do a write conflict range on T1_Conflict_Range, and commit.</p>\n<p>After T2 successfully commits, I can attempt the retry logic. A successful T2 commit would indicate</p>\n<ul>\n<li><em>Either</em> T1 successfully committed (for which we did not get an acknowledgement), followed by a successful T2 commit</li>\n<li><em>Or</em> T2 successfully committed, and T1 will no longer be able to commit.</li>\n</ul>\n<p>In either of the cases after T2 commits successfully, I should be able to rely on the presence or absence of the sentinel-key for subsequent decisions.</p>\n<p>Do you see any potential issues here?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-12T03:48:57.012Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 19,
        "readers_count": 18,
        "score": 28.8,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11478,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-15T05:16:28.801Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/andrew.noyes\">@andrew.noyes</a> As I was updating the design document, I noticed a discrepancy between documentation and a forum post for <code>transaction_timed_out</code> and <code>transaction_cancelled</code>.</p>\n<p>In the FDB documentation section for <a href=\"https://apple.github.io/foundationdb/developer-guide.html#non-retryable-errors\" rel=\"noopener nofollow ugc\">Non-Retryable Errors</a>, it is mentioned that we will get a <code>transaction_timed_out</code> error in-case we set a timeout in our transaction options.</p>\n<p>However, <a href=\"https://forums.foundationdb.org/t/how-to-do-status-check-using-the-java-api/534/6\">this</a> forum post by <a class=\"mention\" href=\"/u/alloc\">@alloc</a> seems to indicate that we will get a <code>transaction_cancelled</code> error.</p>\n<aside class=\"quote no-group\" data-username=\"alloc\" data-post=\"6\" data-topic=\"534\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alloc/48/9_2.png\" class=\"avatar\"><a href=\"https://forums.foundationdb.org/t/how-to-do-status-check-using-the-java-api/534/6\">How to do status check using the Java API</a></div>\n<blockquote>\n<p>One issue with using our timeouts, though, is that the error that gets returned is \u201ctransaction_cancelled\u201d, which can also happen if you cancel the transaction yourself (rather than something like \u201ctransacion_timed_out\u201d). So, your mileage may vary.</p>\n</blockquote>\n</aside>\n<p>I was wondering if there was some subtlety that I might be missing here?</p>\n<p>In order understand the error conditions better, I\u2019ve created the following table. Could you please let me know in case there is a mistake.</p>\n<div class=\"md-table\">\n<table>\n<thead>\n<tr>\n<th><strong>Error Name</strong></th>\n<th><strong>on_error retry?</strong></th>\n<th><strong>Possible in-flight transaction</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>commit_unknown_result</code></td>\n<td>Yes</td>\n<td>No</td>\n</tr>\n<tr>\n<td><code>cluster_version_changed</code></td>\n<td>Yes</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><code>operation_cancelled</code></td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><code>transaction_timed_out</code></td>\n<td>No</td>\n<td>Yes</td>\n</tr>\n<tr>\n<td><code>transaction_cancelled</code></td>\n<td>???</td>\n<td>???</td>\n</tr>\n</tbody>\n</table>\n</div><p>Regarding <code>transaction_cancelled</code>, is it something <code>on_error</code> automatically retries? Also from a FDB client perspective, does the possibility of an in-flight transaction exist when we get a <code>transaction_cancelled</code> error?</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-15T05:17:00.171Z",
        "reply_count": 1,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 17,
        "readers_count": 16,
        "score": 13.4,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/developer-guide.html#non-retryable-errors",
            "internal": false,
            "reflection": false,
            "title": "Developer Guide \u2014 FoundationDB 7.1",
            "clicks": 1
          },
          {
            "url": "https://forums.foundationdb.org/t/how-to-do-status-check-using-the-java-api/534/6",
            "internal": true,
            "reflection": false,
            "title": "How to do status check using the Java API",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11485,
        "name": "",
        "username": "andrew.noyes",
        "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
        "created_at": "2022-07-15T20:03:19.262Z",
        "cooked": "<p>I confirmed that a transaction which sets a timeout fails with error code <code>transaction_timed_out</code> (error code 1031), so it\u2019s a different error than if you cancel the transaction.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-15T20:03:19.262Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 14,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11491,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-19T13:15:21.784Z",
        "cooked": "<p>Thanks <a class=\"mention\" href=\"/u/andrew.noyes\">@andrew.noyes</a>. I noticed another potential inconsistency. In the section on <a href=\"https://apple.github.io/foundationdb/developer-guide.html#transaction-cancellation\" rel=\"noopener nofollow ugc\">Transaction cancellation</a>, in the python code documentation it says,</p>\n<blockquote>\n<p>On the 6th time, on_error() will throw retry_limit_exceeded rather than resetting and retrying.</p>\n</blockquote>\n<p>I was unable to find <code>retry_limit_exceeded</code> in the list of documented <a href=\"https://apple.github.io/foundationdb/api-error-codes.html\" rel=\"noopener nofollow ugc\">error codes</a>.</p>\n<p>What error code will we get when the retry limit is exceeded?</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-19T13:15:21.784Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 16,
        "readers_count": 15,
        "score": 13.2,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/developer-guide.html#transaction-cancellation",
            "internal": false,
            "reflection": false,
            "title": "Developer Guide \u2014 FoundationDB 7.1",
            "clicks": 1
          },
          {
            "url": "https://apple.github.io/foundationdb/api-error-codes.html",
            "internal": false,
            "reflection": false,
            "title": "Error Codes \u2014 FoundationDB 7.1",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 14,
          "username": "andrew.noyes",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11494,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2022-07-19T21:39:41.015Z",
        "cooked": "<p>That seems to be an error in the documentation. If you hit the retry limit, it should just return the error that you last encountered (i.e. it could be <code>transaction_too_old</code>, <code>not_committed</code>, etc.).</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-19T21:39:41.015Z",
        "reply_count": 1,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 16,
        "readers_count": 15,
        "score": 13.2,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11499,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-20T12:27:13.316Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> <a class=\"mention\" href=\"/u/andrew.noyes\">@andrew.noyes</a> <a class=\"mention\" href=\"/u/markus.pilman\">@markus.pilman</a> Thanks a lot for the replies to this thread.</p>\n<p>I think design doc almost done. Below is the link to the latest version. When you get a chance, please give it a read, and let me know your feedback.</p>\n<p>The design doc turned out to longer than what I had initially anticipated. I\u2019ve tried to be exhaustive and enumerate all possible issues that can occur when working with non-idempotent transactions and provided links to relevant sections in the documentation and previous forum posts.</p>\n<p>I am hoping this information will be useful to future language binding authors as well when they try to implement similar API for their language.</p>\n<aside class=\"onebox googledocs\" data-onebox-src=\"https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu\">\n  <header class=\"source\">\n\n      <a href=\"https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu\" target=\"_blank\" rel=\"noopener nofollow ugc\">docs.google.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <a href=\"https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu\" target=\"_blank\" rel=\"noopener nofollow ugc\"><span class=\"googledocs-onebox-logo g-docs-logo\"></span></a>\n\n<h3><a href=\"https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu\" target=\"_blank\" rel=\"noopener nofollow ugc\">fdb-rl  Crate Idempotency Design</a></h3>\n\n<p>fdb-rl Rust Create Idempotency Design  Motivation Idempotency is a concept that occurs repeatedly when working with distributed systems. Being able to correctly reason about idempotency property and side-effects plays an important role when we are...</p>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 14,
        "updated_at": "2022-07-20T12:27:13.316Z",
        "reply_count": 0,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 15,
        "readers_count": 14,
        "score": 18.0,
        "yours": false,
        "topic_id": 3413,
        "topic_slug": "make-commit-unknown-results-unlikely-pr-status",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu",
            "internal": false,
            "reflection": false,
            "title": "fdb-rl Crate Idempotency Design - Google Docs",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/make-commit-unknown-results-unlikely-pr-status/3413/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      11364,
      11373,
      11379,
      11381,
      11406,
      11435,
      11442,
      11446,
      11452,
      11478,
      11485,
      11491,
      11494,
      11499
    ]
  },
  "timeline_lookup": [
    [
      1,
      1209
    ],
    [
      2,
      1208
    ],
    [
      5,
      1204
    ],
    [
      6,
      1201
    ],
    [
      7,
      1199
    ],
    [
      8,
      1198
    ],
    [
      10,
      1195
    ],
    [
      11,
      1194
    ],
    [
      12,
      1190
    ],
    [
      14,
      1189
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Make commit_unknown_results unlikely - PR status",
  "id": 3413,
  "title": "Make commit_unknown_results unlikely - PR status",
  "posts_count": 14,
  "created_at": "2022-07-01T00:26:40.443Z",
  "views": 798,
  "reply_count": 12,
  "like_count": 1,
  "last_posted_at": "2022-07-20T12:27:13.316Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "make-commit-unknown-results-unlikely-pr-status",
  "category_id": 5,
  "word_count": 2019,
  "deleted_at": null,
  "user_id": 946,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_3413",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 14,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Automatically providing transaction idempotency",
      "id": 1873,
      "title": "Automatically providing transaction idempotency",
      "slug": "automatically-providing-transaction-idempotency",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2020-01-09T21:49:57.799Z",
      "last_posted_at": "2020-01-09T22:19:29.603Z",
      "bumped": true,
      "bumped_at": "2020-01-09T22:19:29.603Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 3,
      "views": 1045,
      "category_id": 9,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 708,
            "username": "gabikliot",
            "name": "Gabriel Kliot",
            "avatar_template": "/user_avatar/forums.foundationdb.org/gabikliot/{size}/749_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 15,
            "username": "markus.pilman",
            "name": "Markus Pilman",
            "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "A few design-pattern + check-my-understanding questions",
      "id": 1153,
      "title": "A few design-pattern + check-my-understanding questions",
      "slug": "a-few-design-pattern-check-my-understanding-questions",
      "posts_count": 10,
      "reply_count": 6,
      "highest_post_number": 10,
      "image_url": null,
      "created_at": "2019-02-19T15:18:58.329Z",
      "last_posted_at": "2019-02-21T19:51:53.686Z",
      "bumped": true,
      "bumped_at": "2019-02-21T19:51:53.686Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 2273,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 519,
            "username": "JamesThompson",
            "name": "James Thompson",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/c67d28/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 173,
            "username": "jkominek",
            "name": "Jay Kominek",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jkominek/{size}/140_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Question regarding retry logic and transaction get_versionstamp API",
      "id": 2985,
      "title": "Question regarding retry logic and transaction get_versionstamp API",
      "slug": "question-regarding-retry-logic-and-transaction-get-versionstamp-api",
      "posts_count": 6,
      "reply_count": 3,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2021-11-02T12:02:49.561Z",
      "last_posted_at": "2021-11-07T05:37:25.761Z",
      "bumped": true,
      "bumped_at": "2021-11-07T12:00:37.390Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 4,
      "views": 651,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 946,
            "username": "rajivr",
            "name": "Rajiv M Ranganath",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "How MVCC works here",
      "id": 2764,
      "title": "How MVCC works here",
      "slug": "how-mvcc-works-here",
      "posts_count": 4,
      "reply_count": 1,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2021-06-20T19:43:33.177Z",
      "last_posted_at": "2021-06-22T03:19:48.917Z",
      "bumped": true,
      "bumped_at": "2021-06-22T03:19:48.917Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 865,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 954,
            "username": "vorandrew",
            "name": "Andrew Vorobyov",
            "avatar_template": "/user_avatar/forums.foundationdb.org/vorandrew/{size}/1117_2.png",
            "trust_level": 0
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 14,
            "username": "andrew.noyes",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Cannot commit transaction that reads the metadataVersion key after changing it",
      "id": 1833,
      "title": "Cannot commit transaction that reads the metadataVersion key after changing it",
      "slug": "cannot-commit-transaction-that-reads-the-metadataversion-key-after-changing-it",
      "posts_count": 7,
      "reply_count": 3,
      "highest_post_number": 7,
      "image_url": null,
      "created_at": "2019-12-11T22:52:33.816Z",
      "last_posted_at": "2019-12-13T13:23:15.818Z",
      "bumped": true,
      "bumped_at": "2019-12-13T14:11:35.389Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1297,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 946,
        "username": "rajivr",
        "name": "Rajiv M Ranganath",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "post_count": 8,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 14,
        "username": "andrew.noyes",
        "name": "",
        "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 15,
        "username": "markus.pilman",
        "name": "Markus Pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 946,
      "username": "rajivr",
      "name": "Rajiv M Ranganath",
      "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
    },
    "last_poster": {
      "id": 946,
      "username": "rajivr",
      "name": "Rajiv M Ranganath",
      "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
    },
    "links": [
      {
        "url": "https://github.com/sfc-gh-anoyes/foundationdb/blob/anoyes/idempotency-keys-design/design/idempotency_keys.md",
        "title": "foundationdb/idempotency_keys.md at anoyes/idempotency-keys-design \u00b7 sfc-gh-anoyes/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 12,
        "user_id": 14,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit?usp=sharing",
        "title": "fdb-rl Crate Idempotency Design - Google Docs",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 11,
        "user_id": 946,
        "domain": "docs.google.com",
        "root_domain": "google.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/pull/3349",
        "title": "Make commit_unknown_results unlikely by sfc-gh-mpilman \u00b7 Pull Request #3349 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/edit#heading=h.j5rt0bz7wlqu",
        "title": "fdb-rl Crate Idempotency Design - Google Docs",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 946,
        "domain": "docs.google.com",
        "root_domain": "google.com"
      },
      {
        "url": "https://apple.github.io/foundationdb/developer-guide.html#transaction-cancellation",
        "title": "Developer Guide \u2014 FoundationDB 7.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://apple.github.io/foundationdb/api-error-codes.html",
        "title": "Error Codes \u2014 FoundationDB 7.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://forums.foundationdb.org/t/how-are-you-testing-your-layers/3324/4",
        "title": "How are you testing your layers?",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://apple.github.io/foundationdb/developer-guide.html#non-retryable-errors",
        "title": "Developer Guide \u2014 FoundationDB 7.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      }
    ]
  },
  "bookmarks": []
}