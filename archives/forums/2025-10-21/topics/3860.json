{
  "post_stream": {
    "posts": [
      {
        "id": 12579,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-17T10:27:13.989Z",
        "cooked": "<p>Hi FDB Team,</p>\n<p>Today a storage server in one of our FDB clusters running 6.3.25 with SQLite reported an internal error. Looking at the KeyvalueStoreSQLite.actor.cpp it looks like it was expecting more than 1 fragment during a Cursor getNext() call. But the root cause to this error is not clear to us.</p>\n<p>We would really appreciate if you  could help us to understand what may cause this error.</p>\n<p>fdb status:</p>\n<pre><code class=\"lang-auto\">  10.0.46.245:4501       (  6% cpu;  7% machine; 0.000 Gbps;  6% disk IO; 4.3 GB / 8.0 GB RAM  )\n    Last logged error: StorageServerFailed: internal_error at Fri Mar 17 07:35:52 2023\n</code></pre>\n<p>fdbmonitor log:</p>\n<pre><code class=\"lang-auto\">Time=\"1678695262.344335\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Started FoundationDB Process Monitor 6.3 (v6.3.25)\nTime=\"1678695262.344583\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Watching conf file /var/dynamic-conf/fdbmonitor.conf\nTime=\"1678695262.344598\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Watching conf dir /var/dynamic-conf/ (2)\nTime=\"1678695262.344618\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Loading configuration /var/dynamic-conf/fdbmonitor.conf\nTime=\"1678695262.344818\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Starting fdbserver.1\nTime=\"1678695262.345167\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\": Launching /usr/bin/fdbserver (11) for fdbserver.1\nTime=\"1678695262.417711\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\": FDBD joined cluster.\nTime=\"1678695263.968410\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Could not remove inotify conf file watch, continuing...\nTime=\"1678695263.968461\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Watching conf file /var/dynamic-conf/fdbmonitor.conf\nTime=\"1678695263.968474\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Watching conf dir /var/dynamic-conf/ (4)\nTime=\"1678695263.968483\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Loading configuration /var/dynamic-conf/fdbmonitor.conf\nTime=\"1678695263.968617\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbmonitor\": Updated configuration for fdbserver.1\nTime=\"1679038552.040874\" Severity=\"40\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\": Assertion fragments != 1 failed @ /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp 1076:\nTime=\"1679038552.040915\" Severity=\"40\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\":   addr2line -e fdbserver.debug -p -C -f -i 0x25aef74 0xcc890d 0xcc91fc 0xcce387 0xb39b6c 0xb35e59 0x25a28a6 0x7f287b896190\n</code></pre>\n<p>error stacktrace:</p>\n<pre><code class=\"lang-auto\">addr2line -e fdbserver.debug.x86_64 -p -C -f -i 0x25aef74 0xcc890d 0xcc91fc 0xcce387 0xb39b6c 0xb35e59 0x25a28a6 0x7f287b896190\ninternal_error_impl(char const*, char const*, int) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Error.cpp:66\nRawCursor::DefragmentingReader::getNext() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:1076\nRawCursor::getRange(KeyRangeRef, int, int) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:1173\nKeyValueStoreSQLite::Reader::action(KeyValueStoreSQLite::Reader::ReadRangeAction&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:1698\n (inlined by) TypedAction&lt;KeyValueStoreSQLite::Reader, KeyValueStoreSQLite::Reader::ReadRangeAction&gt;::operator()(IThreadPoolReceiver*) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/IThreadPool.h:76\nyield(TaskPriority) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/flow.h:1043\n (inlined by) WorkPool&lt;Coroutine, ThreadUnsafeSpinLock, true&gt;::Worker::run() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:145\nCoroutine::wrapRun() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:82\n (inlined by) Coroutine::entry(void*) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:86\nCoro_StartWithArg at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbrpc/libcoroutine/Coro.c:250\n?? ??:0\n</code></pre>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-17T10:27:13.989Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 17,
        "reads": 25,
        "readers_count": 24,
        "score": 90.0,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 12586,
        "name": "Jingyu Zhou",
        "username": "jzhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "created_at": "2023-03-18T02:56:35.015Z",
        "cooked": "<p>Looks like this is an assertion failure at KeyValueStoreSQLite.actor.cpp:1076. I\u2019ve never seen this before and am not sure what\u2019s wrong. It\u2019s safe to exclude this server and let DD to rebalance data off this storage server to solve the problem.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-18T02:56:35.015Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 22,
        "readers_count": 21,
        "score": 19.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Jingyu Zhou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 454,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12589,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-18T11:39:24.549Z",
        "cooked": "<p>Thank your for the response.<br>\nExcluding the node was precisely our approach. But we have now seen this error in two nodes running in different hosts and different disks. So we would like to continue with the root cause analysis.<br>\nThe nodes are running version 6.3.25 in a managed kubernetes cluster with managed disks.<br>\nThe only pattern we have been able to find so far is that both hosts had been running for more than 300 hundred days and they have heavy read and write load.</p>\n<p>We would really appreciate if you could help us with the Root Cause Analysis.</p>\n<p>Maybe unrelated but in another cluster with the same pattern we have seen 4 failures in the last week. But these errors point to SQLite database corruption. The errors are different but we observe the same pattern. Same k8s provider, +300 days old disks, and heavy traffic. If you think this should be discussed in a separate thread let me know and I will gladly open a new one.</p>\n<p>It is not clear to us whether these are caused by disk/filesystem errors leading to database corruption or SQLite bugs. Since we are using managed disks on a cloud provider we have limited visibility of the storage layer. Because FDB uses non vanilla SQLite we would appreciate if you could let us know how to troubleshoot the following errors on the SQLite side of things.</p>\n<p>This error happened twice in two different SS in the same cluster:</p>\n<pre><code class=\"lang-auto\">Time=\"1679109778.883363\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\": database corruption line 5463\n</code></pre>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463\" target=\"_blank\" rel=\"noopener nofollow ugc\">apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-c\">\n      <ol class=\"start lines\" start=\"5453\" style=\"counter-reset: li-counter 5452 ;\">\n          <li>\t\trc = verifyParentChildLink(pBt, ovflParent, ovflPgno);</li>\n          <li>\t\tif (rc != SQLITE_OK)</li>\n          <li>\t\t\treturn rc;</li>\n          <li>\n          </li>\n<li>\t\tPgno iNext = 0;</li>\n          <li>\t\tMemPage* pOvfl = 0;</li>\n          <li>\t\tif (ovflPgno &lt; 2 || ovflPgno &gt; btreePagecount(pBt)) {</li>\n          <li>\t\t\t/* 0 is not a legal page number and page 1 cannot be an</li>\n          <li>\t\t\t** overflow page. Therefore if ovflPgno&lt;2 or past the end of the</li>\n          <li>\t\t\t** file the database must be corrupt. */</li>\n          <li class=\"selected\">\t\t\treturn SQLITE_CORRUPT_BKPT;</li>\n          <li>\t\t}</li>\n          <li>\t\tif (nOvfl) {</li>\n          <li>\t\t\trc = getOverflowPage(pBt, ovflPgno, &amp;pOvfl, &amp;iNext);</li>\n          <li>\t\t\tif (rc)</li>\n          <li>\t\t\t\treturn rc;</li>\n          <li>\t\t}</li>\n          <li>\n          </li>\n<li>\t\tif ((pOvfl || ((pOvfl = btreePageLookup(pBt, ovflPgno)) != 0)) &amp;&amp;</li>\n          <li>\t\t    sqlite3PagerPageRefcount(pOvfl-&gt;pDbPage) != 1) {</li>\n          <li>\t\t\t/* There is no reason any cursor should have an outstanding reference</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<pre><code class=\"lang-auto\">$ addr2line -e fdbserver.debug.x86_64 -p -C -f -i 0x26440fc 0x2645120 0x26454b1 0x1503171 0x150396d 0x1503ab5 0x14f00ea 0x14f03c2 0x82bdc9 0x14fbe27 0x14fc7d5 0xa40a10 0xa40ce2 0x82bdc9 0x14f0c40 0x14f0dec 0xa40a10 0xa40ce2 0x82bdc9 0xb4a0bf 0xc47a60 0x25ecee7 0x7cf95d 0x7f9a9a77a555\nstd::string::_M_rep() const at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3322\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string(std::string const&amp;) at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.tcc:613\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; std::operator+&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, char const*) at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:5967\n (inlined by) TraceEvent::backtrace(std::string const&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1235\nstd::string::_M_rep() const at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3322\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string() at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3640\n (inlined by) TraceEvent::log() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1254\nTraceEventFields::~TraceEventFields() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.h:70\n (inlined by) TraceEvent::~TraceEvent() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1292\n</code></pre>\n<p>This error also was reported twice by two different SS:</p>\n<pre><code class=\"lang-auto\">Time=\"1679110567.026536\" Severity=\"10\" LogGroup=\"foundationdb-cluster\" Process=\"fdbserver.1\": database corruption line 4002\n</code></pre>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002\" target=\"_blank\" rel=\"noopener nofollow ugc\">apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-c\">\n      <ol class=\"start lines\" start=\"3992\" style=\"counter-reset: li-counter 3991 ;\">\n          <li>\t\t\t\t\tsqlite3PagerUnref(pDbPage);</li>\n          <li>\t\t\t\t\toffset = 0;</li>\n          <li>\t\t\t\t\tamt -= a;</li>\n          <li>\t\t\t\t\tpBuf += a;</li>\n          <li>\t\t\t\t}</li>\n          <li>\t\t\t}</li>\n          <li>\t\t}</li>\n          <li>\t}</li>\n          <li>\n          </li>\n<li>\tif (rc == SQLITE_OK &amp;&amp; amt &gt; 0) {</li>\n          <li class=\"selected\">\t\treturn SQLITE_CORRUPT_BKPT;</li>\n          <li>\t}</li>\n          <li>\treturn rc;</li>\n          <li>}</li>\n          <li>\n          </li>\n<li>/*</li>\n          <li>** Read part of the key associated with cursor pCur.  Exactly</li>\n          <li>** \"amt\" bytes will be transfered into pBuf[].  The transfer</li>\n          <li>** begins at \"offset\".</li>\n          <li>**</li>\n          <li>** The caller must ensure that pCur is pointing to a valid row</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<pre><code class=\"lang-auto\">$ addr2line -e fdbserver.debug.x86_64 -p -C -f -i 0x26440fc 0x2645120 0x26454b1 0xcc57e6 0xcc6191 0xcc632c 0xcc8ab1 0xcce387 0xb39b6c 0xb35e59 0x25a28a6 0x7fcf2f748190\nstd::string::_M_rep() const at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3322\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::basic_string(std::string const&amp;) at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.tcc:613\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; std::operator+&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;(std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt; const&amp;, char const*) at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:5967\n (inlined by) TraceEvent::backtrace(std::string const&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1235\nstd::string::_M_rep() const at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3322\n (inlined by) std::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;::~basic_string() at /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3640\n (inlined by) TraceEvent::log() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1254\nTraceEventFields::~TraceEventFields() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.h:70\n (inlined by) TraceEvent::~TraceEvent() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/Trace.cpp:1292\nSQLiteDB::checkError(char const*, int) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:289\nRawCursor::getEncodedRow(Arena&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:762\nRawCursor::DefragmentingReader::parse() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:991\nRawCursor::getRange(KeyRangeRef, int, int) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:1156\nKeyValueStoreSQLite::Reader::action(KeyValueStoreSQLite::Reader::ReadRangeAction&amp;) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/KeyValueStoreSQLite.actor.cpp:1698\n (inlined by) TypedAction&lt;KeyValueStoreSQLite::Reader, KeyValueStoreSQLite::Reader::ReadRangeAction&gt;::operator()(IThreadPoolReceiver*) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/IThreadPool.h:76\nyield(TaskPriority) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/flow/flow.h:1043\n (inlined by) WorkPool&lt;Coroutine, ThreadUnsafeSpinLock, true&gt;::Worker::run() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:145\nCoroutine::wrapRun() at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:82\n (inlined by) Coroutine::entry(void*) at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbserver/CoroFlow.actor.cpp:86\nCoro_StartWithArg at /home/foundationdb_ci/src/oOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOoOo/foundationdb/fdbrpc/libcoroutine/Coro.c:250\n?? ??:0\n</code></pre>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-18T11:39:24.549Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 23,
        "readers_count": 22,
        "score": 29.6,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/btree.c at 97cc643cef69f92cd69521c35892174a20afaac3 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 1
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/btree.c at 97cc643cef69f92cd69521c35892174a20afaac3 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12590,
        "name": "Jingyu Zhou",
        "username": "jzhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "created_at": "2023-03-18T21:16:33.572Z",
        "cooked": "<p>From the error <code>SQLITE_CORRUPT_BKPT</code>, this seems to indicate a data corruption detected:</p>\n<pre><code class=\"lang-auto\">#define SQLITE_CORRUPT_BKPT sqlite3CorruptError(__LINE__)\n</code></pre>\n<p>Since you mentioned the disk is old and under heavy traffic, I\u2019d suspect it\u2019s probably disk corruption problems (hardware errors?) and would just replace these disks (migrate to other storage servers by excluding them and adding new storage servers).</p>\n<p>Do you have consistencycheck role running? This role can detect data corruptions by comparing data replicas in a constant interval.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-18T21:16:33.572Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 22,
        "readers_count": 21,
        "score": 14.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Jingyu Zhou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1128,
          "username": "manfontan",
          "name": "Manuel Fontan",
          "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": true,
        "staff": true,
        "user_id": 454,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12592,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-19T00:09:05.306Z",
        "cooked": "<p>Thank you. We are in the process of excluding old nodes. Hopefully that will make things better.</p>\n<p>AFAIK consistency check is not currently supported by the operator. We will evaluate running it manually.<br>\nI will also open an issue in the operator repo to request the enhancement.</p>\n<p>Again thank you very much for your time.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-19T00:09:36.738Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 4.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 454,
          "username": "jzhou",
          "name": "Jingyu Zhou",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12593,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-19T16:35:35.931Z",
        "cooked": "<p>Hi</p>\n<p>Unfortunately after excluding the nodes running older disks we recently hit the same error <code>line 4002</code></p><aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002\" target=\"_blank\" rel=\"noopener nofollow ugc\">apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-c\">\n      <ol class=\"start lines\" start=\"3992\" style=\"counter-reset: li-counter 3991 ;\">\n          <li>\t\t\t\t\tsqlite3PagerUnref(pDbPage);</li>\n          <li>\t\t\t\t\toffset = 0;</li>\n          <li>\t\t\t\t\tamt -= a;</li>\n          <li>\t\t\t\t\tpBuf += a;</li>\n          <li>\t\t\t\t}</li>\n          <li>\t\t\t}</li>\n          <li>\t\t}</li>\n          <li>\t}</li>\n          <li>\n          </li>\n<li>\tif (rc == SQLITE_OK &amp;&amp; amt &gt; 0) {</li>\n          <li class=\"selected\">\t\treturn SQLITE_CORRUPT_BKPT;</li>\n          <li>\t}</li>\n          <li>\treturn rc;</li>\n          <li>}</li>\n          <li>\n          </li>\n<li>/*</li>\n          <li>** Read part of the key associated with cursor pCur.  Exactly</li>\n          <li>** \"amt\" bytes will be transfered into pBuf[].  The transfer</li>\n          <li>** begins at \"offset\".</li>\n          <li>**</li>\n          <li>** The caller must ensure that pCur is pointing to a valid row</li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>This is a relatively new disk running for less than 2 months. And this is the 3th occurrence of the error within a week. All reported by different nodes running of different hosts. So hardware malfunction is starting to look like less likely. At least it doesn\u2019t seem to be the only reason.</p>\n<p>The <strong>consistencycheck</strong> documentation is not very informative. Could you provide some guidance to get it up and running and how to check the generated information?</p>\n<p>If you have any other ideas/hypothesis or strategies to progress the root cause analysis we would really appreciate any help you could provide.</p>\n<p>Thank you for your time and effort.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-19T16:35:35.931Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 22,
        "readers_count": 21,
        "score": 29.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/btree.c at 6c1d02a14f479de1a76507ad3e71da5a7cd848dc \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12594,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-19T18:35:22.781Z",
        "cooked": "<p>I found this issue and managed to run the process manually:</p><aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/apple/foundationdb/issues/7933\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/issues/7933\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/apple/foundationdb</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewbox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/apple/foundationdb/issues/7933\" target=\"_blank\" rel=\"noopener nofollow ugc\">Is there any detailed documentation about consistencycheck?</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2022-08-19\" data-time=\"02:39:45\" data-timezone=\"UTC\">02:39AM - 19 Aug 22 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/libo-sober\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"libo-sober\" src=\"https://global.discourse-cdn.com/foundationdb/original/2X/6/6ac39ce2bf0a956e8badaf846b1e9131ea515f96.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\">\n          libo-sober\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          documentation\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">For example:\nHow do I check if it is running?\nHow to configure consistency che<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">\u2026</a></span><span class=\"excerpt hidden\">ck related parameters?\nHow to view the running status of consistency check?\nCan I configure it in foundationdb.conf?\nThanks! Sincerely.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>It will be great if this info makes it to the documentation <img src=\"https://emoji.discourse-cdn.com/twitter/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-19T18:35:22.781Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 20,
        "readers_count": 19,
        "score": 9.0,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/issues/7933",
            "internal": false,
            "reflection": false,
            "title": "Is there any detailed documentation about consistencycheck? \u00b7 Issue #7933 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12598,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-20T09:56:25.043Z",
        "cooked": "<p>Hi again,<br>\nThe consistency check has been running for several hours now. Looks like it is still reading data. But it is hard to tell how much progress it has made.<br>\n<img src=\"https://emoji.discourse-cdn.com/twitter/thinking.png?v=12\" title=\":thinking:\" class=\"emoji\" alt=\":thinking:\" loading=\"lazy\" width=\"20\" height=\"20\"> How does the check report a successful run?<br>\nThe only activity I see so far is in the trace logs. <code>ConsistencyCheck_*</code> but it is hard to tell if the test finished just reading the logs.</p>\n<p>Thank you <img src=\"https://emoji.discourse-cdn.com/twitter/bowing_man.png?v=12\" title=\":bowing_man:\" class=\"emoji\" alt=\":bowing_man:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-20T09:56:25.043Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 4.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 1128,
          "username": "manfontan",
          "name": "Manuel Fontan",
          "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12599,
        "name": "Manuel Fontan",
        "username": "manfontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "created_at": "2023-03-20T10:12:20.102Z",
        "cooked": "<p>Ok I see the check finished from the logs.</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1679284849.196455\" DateTime=\"2023-03-20T04:00:49Z\" Type=\"ConsistencyCheck_FinishedCheck\" ID=\"0000000000000000\" Repetitions=\"0\" ThreadID=\"16350227908004932116\" Machine=\"redacted\" LogGroup=\"foundationdb-cluster\" Roles=\"TS\" /\n</code></pre>\n<p>My assumption is that it succeeded since it logged the completion and no failures were logged:</p>\n<p>Based on this I expect <code>TestFailure</code> Warning or Error messages to be logged when the test fails:<br>\n<a href=\"https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/workloads/ConsistencyCheck.actor.cpp#L143\" rel=\"noopener nofollow ugc\">ConsistencyCheck.actor.cpp#L143</a></p>\n<p>If my understanding is not correct please correct me <img src=\"https://emoji.discourse-cdn.com/twitter/sweat_smile.png?v=12\" title=\":sweat_smile:\" class=\"emoji\" alt=\":sweat_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>If there is a better way of tracking completion and errors please let me know.</p>\n<p>Thank you.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-20T10:19:59.476Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 10,
        "reads": 21,
        "readers_count": 20,
        "score": 54.2,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Manuel Fontan",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/workloads/ConsistencyCheck.actor.cpp#L143",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/ConsistencyCheck.actor.cpp at 97cc643cef69f92cd69521c35892174a20afaac3 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1128,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12612,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2023-03-21T18:32:38.648Z",
        "cooked": "<p>This is almost certainly caused by your disk breaking the disk durability contract.</p>\n<p>Blocks on disk have checksums to prevent corruption, but this cannot protect from \u201clost writes\u201d, where a page update which is fsync()'d remains at its previous state instead when later read back from disk.  Checksums do not help here because the old state of the page had a valid checksum, the page was just never updated to the new content.</p>\n<p>A lost write can cause BTree invariant violations which are the type of errors you are seeing.  A lost write can also cause stale data to be returned from the SQLite tree without it detecting an invariant violation internally.  In the fragment error you saw, SQLite itself did not detect an issue and so it returned a bad result, but this broke an invariant in the FDB KV modeling layer on top of the SQLite tree which adds record fragmenting to avoid a high slack space issue with SQLite\u2019s structure.  If the record were not fragmented, the error would not have been detected by the KV modeling layer and a bad result would have been returned from the storage engine.</p>\n<p>There is an incredible amount of simulated and real world testing and at-scale usage of the SQLite storage engine, and its code in FDB and the underlying SQLite code have not changed meaningfully in many years.  A lost write can cause all of the issues you have seen, and is the most likely cause.</p>\n<p>The good news is, we\u2019ve encountered badly behaving disks before and so there is an FDB feature you can turn on which will prove that this is what is happening.</p>\n<p>If you set this option in your FDB conf file in the fdbserver section</p>\n<pre><code class=\"lang-auto\">knob_page_write_checksum_history = 50000000\n</code></pre>\n<p>then FDB track written block checksums within a process\u2019s lifetime for the first 50,000,000 4k blocks of space in your data files, and use these to verify the checksums of any of those blocks when read back from disk later after cache eviction.  If a mismatch is found, it will log a <code>AsyncFileLostWriteDetected</code> event.</p>\n<p>I suggest enabling this on your cluster and looking for these events.  The memory overhead of this feature is approximately the history size setting * 8, so around 400MB of memory to track 50 million blocks which would cover all blocks of a 200GB data file.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-21T18:32:38.648Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 235,
        "reads": 22,
        "readers_count": 21,
        "score": 1304.4,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 6
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12640,
        "name": "Lars Hagen",
        "username": "larshagen",
        "avatar_template": "/user_avatar/forums.foundationdb.org/larshagen/{size}/776_2.png",
        "created_at": "2023-03-27T10:50:47.149Z",
        "cooked": "<p>Thank you for the thorough explanation <img src=\"https://emoji.discourse-cdn.com/twitter/+1.png?v=12\" title=\":+1:\" class=\"emoji\" alt=\":+1:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>We have now rolled out the checksum history to a subset of our clusters, and we have seen an occurrence of <code>AsyncFileLostWriteDetected</code>. We are now investigating the issue together with our disk vendor.</p>\n<p>When we do see these issues, is there any way to recover, other than wiping the disk completely and waiting for replication from other pods?</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-27T10:50:47.149Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 21,
        "readers_count": 20,
        "score": 24.2,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Lars Hagen",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 7,
          "username": "SteavedHams",
          "name": "Steve Atherton",
          "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 724,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12650,
        "name": "Lars Hagen",
        "username": "larshagen",
        "avatar_template": "/user_avatar/forums.foundationdb.org/larshagen/{size}/776_2.png",
        "created_at": "2023-03-29T08:11:37.630Z",
        "cooked": "<p>Is it relevant that we have changed the knob <code>MAX_STORAGE_COMMIT_TIME</code> from 120 to 3600 seconds?</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-29T08:11:37.630Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 20,
        "readers_count": 19,
        "score": 14.0,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Lars Hagen",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 724,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12653,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2023-03-29T18:45:42.948Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"larshagen\" data-post=\"11\" data-topic=\"3860\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/larshagen/48/776_2.png\" class=\"avatar\"> larshagen:</div>\n<blockquote>\n<p>When we do see these issues, is there any way to recover, other than wiping the disk completely and waiting for replication from other pods?</p>\n</blockquote>\n</aside>\n<p>No, and even this does not guarantee recovery because silently corrupted data may have already been read and replicated elsewhere as part of FDB data movement.</p>\n<aside class=\"quote no-group\" data-username=\"larshagen\" data-post=\"12\" data-topic=\"3860\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/larshagen/48/776_2.png\" class=\"avatar\"> larshagen:</div>\n<blockquote>\n<p>Is it relevant that we have changed the knob <code>MAX_STORAGE_COMMIT_TIME</code> from 120 to 3600 seconds?</p>\n</blockquote>\n</aside>\n<p>No.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-29T18:45:42.948Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 2,
        "incoming_link_count": 0,
        "reads": 20,
        "readers_count": 19,
        "score": 9.0,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12655,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2023-03-30T02:48:06.633Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"SteavedHams\" data-post=\"13\" data-topic=\"3860\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/steavedhams/48/18_2.png\" class=\"avatar\"> SteavedHams:</div>\n<blockquote>\n<p>No, and even this does not guarantee recovery because silently corrupted data may have already been read and replicated elsewhere as part of FDB data movement.</p>\n</blockquote>\n</aside>\n<p>I was wondering if the storage fault model for Redwood engine has been document somewhere? I would be really interested to learn the types of storage faults that Redwood might be able to recover from, which SQLite might not be able to.</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-30T04:13:33.972Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 1,
        "incoming_link_count": 4,
        "reads": 20,
        "readers_count": 19,
        "score": 44.0,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12659,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2023-03-30T08:28:13.386Z",
        "cooked": "<p>Redwood\u2019s corruption protection is essentially the same as the SQLite engine - Pages on disk have an XXH3_64bits checksum and the page location within the file is included as part of the checksum input.  This means that:</p>\n<ul>\n<li>A corrupted page should fail verification</li>\n<li>If pages are swapped around somehow such as by filesystem or disk metadata corruption such that reading page X returns a page that was written as some other page Y the read would fail verification</li>\n</ul>\n<p>This scheme can not protect against disk contract breaking lost writes (as in, omitting a write that is both write-ack\u2019d and fsync-ack\u2019d, leaving prior block content unmodified), which is fundamentally hard to do for any data structures which individually reuse and update pages.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 15,
        "updated_at": "2023-03-30T08:29:36.270Z",
        "reply_count": 0,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 19,
        "readers_count": 18,
        "score": 23.8,
        "yours": false,
        "topic_id": 3860,
        "topic_slug": "internal-error-keyvaluestoresqlite-actor-cpp",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/internal-error-keyvaluestoresqlite-actor-cpp/3860/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      12579,
      12586,
      12589,
      12590,
      12592,
      12593,
      12594,
      12598,
      12599,
      12612,
      12640,
      12650,
      12653,
      12655,
      12659
    ]
  },
  "timeline_lookup": [
    [
      1,
      949
    ],
    [
      3,
      948
    ],
    [
      6,
      947
    ],
    [
      10,
      945
    ],
    [
      11,
      939
    ],
    [
      12,
      938
    ],
    [
      13,
      937
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Internal_error KeyvalueStoreSQLite.actor.cpp",
  "id": 3860,
  "title": "Internal_error KeyvalueStoreSQLite.actor.cpp",
  "posts_count": 15,
  "created_at": "2023-03-17T10:27:13.924Z",
  "views": 1130,
  "reply_count": 7,
  "like_count": 8,
  "last_posted_at": "2023-03-30T08:28:13.386Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "internal-error-keyvaluestoresqlite-actor-cpp",
  "category_id": 7,
  "word_count": 2758,
  "deleted_at": null,
  "user_id": 1128,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_3860",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 15,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 5,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Io_error on all FDB storage machines",
      "id": 2317,
      "title": "Io_error on all FDB storage machines",
      "slug": "io-error-on-all-fdb-storage-machines",
      "posts_count": 14,
      "reply_count": 5,
      "highest_post_number": 14,
      "image_url": null,
      "created_at": "2020-08-28T18:35:27.154Z",
      "last_posted_at": "2020-09-05T03:29:36.922Z",
      "bumped": true,
      "bumped_at": "2020-09-05T03:29:36.922Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 1935,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 810,
            "username": "amanda",
            "name": "Amanda",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/67e7ee/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 14,
            "username": "andrew.noyes",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 260,
            "username": "jared2501",
            "name": "Jared2501",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Foundationdb seems keep reinitialising itself after client hang",
      "id": 1437,
      "title": "Foundationdb seems keep reinitialising itself after client hang",
      "slug": "foundationdb-seems-keep-reinitialising-itself-after-client-hang",
      "posts_count": 6,
      "reply_count": 2,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2019-06-10T10:10:13.209Z",
      "last_posted_at": "2019-06-26T18:08:03.629Z",
      "bumped": true,
      "bumped_at": "2019-06-26T18:08:03.629Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1222,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 602,
            "username": "ppggff",
            "name": "ppggff",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ppggff/{size}/855_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 166,
            "username": "gaurav",
            "name": "gaurav",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
            "trust_level": 3
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "A precise test oracle for FoundationDB simulation workloads",
      "id": 289,
      "title": "A precise test oracle for FoundationDB simulation workloads",
      "slug": "a-precise-test-oracle-for-foundationdb-simulation-workloads",
      "posts_count": 11,
      "reply_count": 7,
      "highest_post_number": 11,
      "image_url": null,
      "created_at": "2018-04-27T14:04:16.394Z",
      "last_posted_at": "2018-04-30T00:17:47.601Z",
      "bumped": true,
      "bumped_at": "2018-04-30T00:20:48.970Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1249,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Fdbserver error in a cluster with double redundancy",
      "id": 2348,
      "title": "Fdbserver error in a cluster with double redundancy",
      "slug": "fdbserver-error-in-a-cluster-with-double-redundancy",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2020-09-20T18:50:42.932Z",
      "last_posted_at": "2020-09-22T07:33:44.911Z",
      "bumped": true,
      "bumped_at": "2020-09-22T11:25:55.307Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 3,
      "views": 859,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 714,
            "username": "tuk",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/b5ac83/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 14,
            "username": "andrew.noyes",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Technical overview of the database",
      "id": 135,
      "title": "Technical overview of the database",
      "slug": "technical-overview-of-the-database",
      "posts_count": 27,
      "reply_count": 15,
      "highest_post_number": 27,
      "image_url": null,
      "created_at": "2018-04-20T15:30:31.788Z",
      "last_posted_at": "2019-01-11T23:25:47.462Z",
      "bumped": true,
      "bumped_at": "2019-01-11T23:25:47.462Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 64,
      "views": 12958,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 96,
            "username": "idiot",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/i/f04885/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 443,
            "username": "junius",
            "name": "junius",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f08c70/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 1128,
        "username": "manfontan",
        "name": "Manuel Fontan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png",
        "post_count": 7,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 7,
        "username": "SteavedHams",
        "name": "Steve Atherton",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 454,
        "username": "jzhou",
        "name": "Jingyu Zhou",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "moderator": true,
        "trust_level": 2
      },
      {
        "id": 724,
        "username": "larshagen",
        "name": "Lars Hagen",
        "avatar_template": "/user_avatar/forums.foundationdb.org/larshagen/{size}/776_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 946,
        "username": "rajivr",
        "name": "Rajiv M Ranganath",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      }
    ],
    "created_by": {
      "id": 1128,
      "username": "manfontan",
      "name": "Manuel Fontan",
      "avatar_template": "/user_avatar/forums.foundationdb.org/manfontan/{size}/1370_2.png"
    },
    "last_poster": {
      "id": 7,
      "username": "SteavedHams",
      "name": "Steve Atherton",
      "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/issues/7933",
        "title": "Is there any detailed documentation about consistencycheck? \u00b7 Issue #7933 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 1128,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/6c1d02a14f479de1a76507ad3e71da5a7cd848dc/contrib/sqlite/btree.c#L4002",
        "title": "foundationdb/btree.c at 6c1d02a14f479de1a76507ad3e71da5a7cd848dc \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 1128,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L4002",
        "title": "foundationdb/btree.c at 97cc643cef69f92cd69521c35892174a20afaac3 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 1128,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/97cc643cef69f92cd69521c35892174a20afaac3/fdbserver/sqlite/btree.c#L5463",
        "title": "foundationdb/btree.c at 97cc643cef69f92cd69521c35892174a20afaac3 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 1128,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}