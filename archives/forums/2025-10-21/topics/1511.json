{
  "post_stream": {
    "posts": [
      {
        "id": 4622,
        "name": "",
        "username": "eastern-grey",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/c67d28/{size}.png",
        "created_at": "2019-07-09T04:23:16.606Z",
        "cooked": "<p>I have three machines running on a shared datacenter network that sees some packet loss:</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/f8d09cdaf53a5d47bcb4afb77a2bd3bbde3fc6f3.png\" alt=\"10%20pm\" data-base62-sha1=\"zv7mwJt1dJqo7RU4nndOsaieaqf\" width=\"690\" height=\"222\"></p>\n<p>When I change from running 1 proxy on each of the machines, to a single proxy on one machine, the worst case latency improves considerably:</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/7273e66e8b5ce69167c933a48a5971a7ddfbd66d.png\" alt=\"57%20pm\" data-base62-sha1=\"gkuKhynNWcp0XXUG4yMKQZG9D4x\" width=\"596\" height=\"500\"></p>\n<p>The current single proxy server is running at about 20% CPU.</p>\n<p>The documentation advises against reducing the default number of proxy servers. Is this because a single proxy server may be a bottleneck at a higher throughput, or are there other reasons why there should be more than one even at smaller workloads? If a single proxy is a bad idea, I saw one forum post where a user had multiple proxy processes running on a single server - would that be a sensible alternative?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2019-07-09T04:23:16.606Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 392,
        "reads": 32,
        "readers_count": 31,
        "score": 1961.4,
        "yours": false,
        "topic_id": 1511,
        "topic_slug": "proxies-and-packet-loss-retransmits",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/are-spikes-of-500ms-maxrowreadlatency-normal/1508/7",
            "internal": true,
            "reflection": true,
            "title": "Are spikes of 500ms+ MaxRowReadLatency normal?",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 619,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/proxies-and-packet-loss-retransmits/1511/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 4635,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-07-11T00:21:10.037Z",
        "cooked": "<p>Getting a read version requires all the proxies to talk to each other.  If there\u2019s one proxy, there is no communication.  If you run multiple proxies on one host, you\u2019re only doing local TCP delivery, which is also faster.  Given the network flakiness that you have, the same packet/connection drop and retransmit tail latency will happen between proxies, leading to doubly high GRV latency.  At commit time, proxies talk to all the resolvers, and all the TLogs, leading to potentially triply high latency.</p>\n<p>Running proxies on separate machines is recommended because commits are first sent to the proxy.  Running them all on one machine means that all commits to your database go through one machine, and thus the write bandwidth for your database is limited by what one NIC can achieve.  If write bandwidth isn\u2019t a concern, and latency is, then running multiple proxies on one machine is fine.  Running one proxy or multiple in that situation would purely depend on CPU usage.  If your benchmarks of how you expect your application to use FDB show that with one proxy, your latency is fine and CPU/memory of the one proxy is fine, then it sounds like <code>proxies=1</code> is a just fine configuration for you.  I\u2019d recommend placing the resolver on the same machine in that case as well.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2019-07-11T00:21:10.037Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 26,
        "readers_count": 25,
        "score": 15.2,
        "yours": false,
        "topic_id": 1511,
        "topic_slug": "proxies-and-packet-loss-retransmits",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/proxies-and-packet-loss-retransmits/1511/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4648,
        "name": "",
        "username": "eastern-grey",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/c67d28/{size}.png",
        "created_at": "2019-07-12T03:27:46.174Z",
        "cooked": "<p>Appreciate you taking the time to reply Alex. Moving the resolver seems to have helped a little as well.</p>\n<p>The datacenter provides the option of an additional private network, but it requires all machines on the network to be in the same rack. I thought this would mean I\u2019d have to keep all the log and storage servers in one spot if I wanted to improve the latency, so I\u2019m happy to see that simply reducing the proxies is an option for now. And if the workload outgrows what a single machine can handle, I\u2019m guessing one option would be to run a small set of machines on a private network to handle client+proxy+resolver traffic, while keeping the log and storage servers in separate locations. I\u2019m impressed at the flexibility that fdb\u2019s separate server roles afford.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2019-07-12T03:27:46.174Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 24,
        "readers_count": 23,
        "score": 9.8,
        "yours": false,
        "topic_id": 1511,
        "topic_slug": "proxies-and-packet-loss-retransmits",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 619,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/proxies-and-packet-loss-retransmits/1511/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      4622,
      4635,
      4648
    ]
  },
  "timeline_lookup": [
    [
      1,
      2297
    ],
    [
      2,
      2295
    ],
    [
      3,
      2294
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Proxies and packet loss/retransmits",
  "id": 1511,
  "title": "Proxies and packet loss/retransmits",
  "posts_count": 3,
  "created_at": "2019-07-09T04:23:16.512Z",
  "views": 1326,
  "reply_count": 1,
  "like_count": 0,
  "last_posted_at": "2019-07-12T03:27:46.174Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "proxies-and-packet-loss-retransmits",
  "category_id": 7,
  "word_count": 504,
  "deleted_at": null,
  "user_id": 619,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/f8d09cdaf53a5d47bcb4afb77a2bd3bbde3fc6f3_2_1024x329.png",
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1511",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 3,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 2,
  "show_read_indicator": false,
  "thumbnails": [
    {
      "max_width": null,
      "max_height": null,
      "width": 1620,
      "height": 522,
      "url": "https://global.discourse-cdn.com/foundationdb/original/1X/f8d09cdaf53a5d47bcb4afb77a2bd3bbde3fc6f3.png"
    },
    {
      "max_width": 1024,
      "max_height": 1024,
      "width": 1024,
      "height": 329,
      "url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/f8d09cdaf53a5d47bcb4afb77a2bd3bbde3fc6f3_2_1024x329.png"
    }
  ],
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "FDB 6.2 - proxies processes have 100% CPU usage",
      "id": 3584,
      "title": "FDB 6.2 - proxies processes have 100% CPU usage",
      "slug": "fdb-6-2-proxies-processes-have-100-cpu-usage",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2022-10-10T17:18:33.089Z",
      "last_posted_at": "2022-10-10T21:01:58.532Z",
      "bumped": true,
      "bumped_at": "2022-10-10T21:01:58.532Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 380,
      "category_id": 17,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 716,
            "username": "erplus",
            "name": "erplus",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/7feea3/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 14,
            "username": "andrew.noyes",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/andrew.noyes/{size}/443_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Why doesn&rsquo;t my cluster performance scale when I double the number of machines?",
      "id": 640,
      "title": "Why doesn't my cluster performance scale when I double the number of machines?",
      "slug": "why-doesnt-my-cluster-performance-scale-when-i-double-the-number-of-machines",
      "posts_count": 21,
      "reply_count": 16,
      "highest_post_number": 21,
      "image_url": null,
      "created_at": "2018-08-15T09:26:47.588Z",
      "last_posted_at": "2018-08-17T07:32:00.164Z",
      "bumped": true,
      "bumped_at": "2018-08-17T07:32:00.164Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 3323,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 255,
            "username": "aqua",
            "name": "Matt Lohier",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 68,
            "username": "daverosenthal",
            "name": "Dave Rosenthal",
            "avatar_template": "/user_avatar/forums.foundationdb.org/daverosenthal/{size}/51_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 321,
            "username": "poma",
            "name": "Roman Semenov",
            "avatar_template": "/user_avatar/forums.foundationdb.org/poma/{size}/325_2.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Cluster tuning cookbook",
      "id": 520,
      "title": "Cluster tuning cookbook",
      "slug": "cluster-tuning-cookbook",
      "posts_count": 27,
      "reply_count": 19,
      "highest_post_number": 27,
      "image_url": null,
      "created_at": "2018-06-19T14:35:25.802Z",
      "last_posted_at": "2019-02-01T12:38:24.733Z",
      "bumped": true,
      "bumped_at": "2019-02-01T12:38:24.733Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 12,
      "views": 8885,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 310,
            "username": "shamatar",
            "name": "Alexander",
            "avatar_template": "/user_avatar/forums.foundationdb.org/shamatar/{size}/315_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 41,
            "username": "amirouche",
            "name": "Amirouche",
            "avatar_template": "/user_avatar/forums.foundationdb.org/amirouche/{size}/1911_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 502,
            "username": "nikolas.ioannou",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/5daacb/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Production optimizations",
      "id": 601,
      "title": "Production optimizations",
      "slug": "production-optimizations",
      "posts_count": 21,
      "reply_count": 14,
      "highest_post_number": 21,
      "image_url": null,
      "created_at": "2018-07-30T21:18:56.894Z",
      "last_posted_at": "2018-08-15T04:47:23.743Z",
      "bumped": true,
      "bumped_at": "2018-08-15T04:47:23.743Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 6473,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 311,
            "username": "ThomasJ",
            "name": "Thomas Johson",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 255,
            "username": "aqua",
            "name": "Matt Lohier",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Transaction implement related doubt",
      "id": 757,
      "title": "Transaction implement related doubt",
      "slug": "transaction-implement-related-doubt",
      "posts_count": 5,
      "reply_count": 3,
      "highest_post_number": 5,
      "image_url": null,
      "created_at": "2018-10-09T11:25:07.598Z",
      "last_posted_at": "2018-10-20T15:44:06.612Z",
      "bumped": true,
      "bumped_at": "2018-10-20T15:53:29.815Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1095,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 386,
            "username": "zycHacker",
            "name": "zycHacker",
            "avatar_template": "/user_avatar/forums.foundationdb.org/zychacker/{size}/385_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 15,
            "username": "markus.pilman",
            "name": "Markus Pilman",
            "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 619,
        "username": "eastern-grey",
        "name": "",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/c67d28/{size}.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 619,
      "username": "eastern-grey",
      "name": "",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/c67d28/{size}.png"
    },
    "last_poster": {
      "id": 619,
      "username": "eastern-grey",
      "name": "",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/e/c67d28/{size}.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/are-spikes-of-500ms-maxrowreadlatency-normal/1508/7",
        "title": "Are spikes of 500ms+ MaxRowReadLatency normal?",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 1,
        "user_id": 619,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}