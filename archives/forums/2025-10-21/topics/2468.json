{
  "post_stream": {
    "posts": [
      {
        "id": 8842,
        "name": "Srujan Narkedamalli",
        "username": "srujann",
        "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png",
        "created_at": "2020-12-07T14:26:04.858Z",
        "cooked": "<p>We recently upgraded our <code>fdb-java</code> library version from <code>5.2.8</code> to <code>6.2.22</code> and observed that latency for some of our queries increased by ~18%. FDB client and server version used are <code>6.2.20</code> and the only change is <code>fdb-java</code> library version. So we tried out different <code>fdb-java</code> versions (available on maven) and found that this increase started occurring from <code>fdb-java</code> version <code>6.1.8</code> onwards. Looking at <code>fdb-java</code> library code, it looks like there were quite some changes between <code>6.0.18</code> (the latest version where we don\u2019t latency increase) and <code>6.1.8</code>. Below is our query latency data for different versions of <code>fdb-java</code> library. Would appreciate any help with addressing this problem.</p>\n<p>FDB client and server version: 6.2.20</p>\n<pre><code class=\"lang-auto\">FoundationDB CLI 6.2 (v6.2.20)\nsource version 77b5171e81754f2fda8869703d662e59d85b7f23\nprotocol fdb00b062010001\n</code></pre>\n<p>Query latencies for different versions of fdb-java library:</p>\n<div class=\"md-table\">\n<table>\n<thead>\n<tr>\n<th>FDB Java Lib version</th>\n<th>Query latency average % difference from baseline</th>\n<th>Query latency range</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>6.2.22</td>\n<td>+18%</td>\n<td>~19-21 seconds</td>\n</tr>\n<tr>\n<td>6.2.10</td>\n<td>+18%</td>\n<td>~19-21 seconds</td>\n</tr>\n<tr>\n<td>6.1.9</td>\n<td>+18%</td>\n<td>~19-21 seconds</td>\n</tr>\n<tr>\n<td>6.1.8</td>\n<td>+18%</td>\n<td>~19-21 seconds</td>\n</tr>\n<tr>\n<td>6.0.18</td>\n<td>0 %</td>\n<td>~16-17 seconds</td>\n</tr>\n<tr>\n<td>6.0.15</td>\n<td>0%</td>\n<td>~16-17 seconds</td>\n</tr>\n<tr>\n<td>5.2.8 (baseline)</td>\n<td>0%</td>\n<td>~16-17 seconds</td>\n</tr>\n</tbody>\n</table>\n</div>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-07T14:26:04.858Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 11,
        "reads": 23,
        "readers_count": 22,
        "score": 59.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "Srujan Narkedamalli",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 858,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 8843,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-12-07T17:36:26.020Z",
        "cooked": "<p>What does your query look like inside the block being timed?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-07T17:36:26.020Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 19,
        "readers_count": 18,
        "score": 8.8,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8854,
        "name": "Srujan Narkedamalli",
        "username": "srujann",
        "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png",
        "created_at": "2020-12-08T17:04:11.321Z",
        "cooked": "<p>Below is a snippet of code that shows the FDB queries in the timed block. It involves multiple queries to FDB. First, a range query is issued FDB and for each of the rows returned in the first query we issue another range query (which typically yields only 1 row). So, its n+1 range queries to FDB. We do batch the queries using a <a href=\"https://github.com/wavefrontHQ/foundationdb-utils/blob/master/src/main/java/com/wavefront/fdb/utils/BatchReader.java\" rel=\"noopener nofollow ugc\">BatchReader</a> in our open source library.</p>\n<pre><code class=\"lang-auto\">// first query to fetch metadata\nIterator&lt;KeyValue&gt; metadata = db.getBatchReader().getRangeAsync(\n          (F&lt;ReadTransaction, AsyncIterable&lt;KeyValue&gt;&gt;) input -&gt;\n              input.getRange(startRange, endRange, 1000, false, StreamingMode.WANT_ALL)).get(1, TimeUnit.MINUTES);\n\n// queries for each entry in metadata\nIterator&lt;CompletableFuture&lt;List&lt;KeyValye&gt;&gt;&gt; records = transform(metadata,\n        metadataRow -&gt; {\n          byte[] rowKey = extractRowKey(metadataRow)\n          return db.getBatchReader().\n              getRangeAsync((F&lt;ReadTransaction, AsyncIterable&lt;KeyValue&gt;&gt;)\n                  input -&gt; input.getRange(Range.startsWith(rowKey)));\n        }); \n</code></pre>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-08T17:04:11.321Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 3.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "Srujan Narkedamalli",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/wavefrontHQ/foundationdb-utils/blob/master/src/main/java/com/wavefront/fdb/utils/BatchReader.java",
            "internal": false,
            "reflection": false,
            "title": "foundationdb-utils/BatchReader.java at master \u00b7 wavefrontHQ/foundationdb-utils \u00b7 GitHub",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 858,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8859,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-12-09T00:19:55.870Z",
        "cooked": "<p>Does this code involve the tuple layer or creating <code>Database</code> objects in Java? There were some substantive changes to both of these so ruling either or both out could make this easier.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-09T00:19:55.870Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8860,
        "name": "Srujan Narkedamalli",
        "username": "srujann",
        "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png",
        "created_at": "2020-12-09T01:25:33.233Z",
        "cooked": "<p>No new objects for <code>com.apple.foundationdb.Database</code> class are created in this code. We reuse an instance that is already created at the startup but new <code>Transaction</code> objects are created.</p>\n<p>Can you clarify what you mean by tuple layer? As part of the timed code, rows are decoded using calls like  <code>Tuples.getLong()</code> and <code>Tuples.getBytes()</code> but this <code>Tuples</code> class is within our code and not from <code>fdb-java</code> library. So this did not change between different version of bindings used.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-09T01:25:33.233Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "Srujan Narkedamalli",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 858,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8861,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-12-09T01:41:22.760Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"srujann\" data-post=\"5\" data-topic=\"2468\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/srujann/48/996_2.png\" class=\"avatar\"> srujann:</div>\n<blockquote>\n<p>Can you clarify what you mean by tuple layer?</p>\n</blockquote>\n</aside>\n<p>I was referring to the FDB Tuple layer in the bindings that helps with packing and unpacking tuples into byte strings suitable for keys and values. It sounds like you aren\u2019t using it.</p>\n<p>I\u2019m not sure what else is different between the two versions, but the rest of the changeset should be small. I\u2019ll have to take a deeper look.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-09T01:41:22.760Z",
        "reply_count": 0,
        "reply_to_post_number": 5,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 3.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8866,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-12-09T21:11:49.271Z",
        "cooked": "<p>There\u2019s not much else that seems to have changed between 6.0.18 and 6.1.8 that I can see. There is one change to make it so that we are no longer creating a throwable when we have a non-error result, which you could try undoing and seeing if it makes a difference:</p>\n<aside class=\"onebox githubpullrequest\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/pull/1236\" target=\"_blank\" rel=\"noopener\">github.com/apple/foundationdb</a>\n  </header>\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Pull Request\">\n    <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 12 16\" aria-hidden=\"true\"><path d=\"M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/apple/foundationdb/pull/1236\" target=\"_blank\" rel=\"noopener\">FDBExceptions are no longer created upon successful operation completion</a>\n    </h4>\n\n    <div class=\"branches\">\n      <code>apple:master</code> \u2190 <code>alecgrieser:01235-no-successful-exceptions</code>\n    </div>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2019-03-05\" data-time=\"05:51:45\" data-timezone=\"UTC\">05:51AM - 05 Mar 19 UTC</span>\n      </div>\n\n      <div class=\"user\">\n        <a href=\"https://github.com/alecgrieser\" target=\"_blank\" rel=\"noopener\">\n          <img alt=\"alecgrieser\" src=\"https://global.discourse-cdn.com/foundationdb/original/1X/4d5841377939ca99f304e342c8427c3bfeb88bb1.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\">\n          alecgrieser\n        </a>\n      </div>\n\n      <div class=\"lines\" title=\"1 commits changed 4 files with 9 additions and 3 deletions\">\n        <a href=\"https://github.com/apple/foundationdb/pull/1236/files\" target=\"_blank\" rel=\"noopener\">\n          <span class=\"added\">+9</span>\n          <span class=\"removed\">-3</span>\n        </a>\n      </div>\n    </div>\n\n  </div>\n</div>\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>There\u2019s also some changes in <code>ByteArrayUtil</code>, though unless you are calling the changed functions in here directly, I think the only way you could encounter the changes is by using the Tuple layer. They are also intended to benefit performance:</p>\n<aside class=\"onebox githubpullrequest\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/pull/1207\" target=\"_blank\" rel=\"noopener\">github.com/apple/foundationdb</a>\n  </header>\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Pull Request\">\n    <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 12 16\" aria-hidden=\"true\"><path d=\"M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/apple/foundationdb/pull/1207\" target=\"_blank\" rel=\"noopener\">Java: Tuple serialization/deserialization uses fewer allocations</a>\n    </h4>\n\n    <div class=\"branches\">\n      <code>apple:master</code> \u2190 <code>alecgrieser:tuple-performance-cache-packed</code>\n    </div>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2019-02-28\" data-time=\"18:16:38\" data-timezone=\"UTC\">06:16PM - 28 Feb 19 UTC</span>\n      </div>\n\n      <div class=\"user\">\n        <a href=\"https://github.com/alecgrieser\" target=\"_blank\" rel=\"noopener\">\n          <img alt=\"alecgrieser\" src=\"https://global.discourse-cdn.com/foundationdb/original/1X/4d5841377939ca99f304e342c8427c3bfeb88bb1.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\">\n          alecgrieser\n        </a>\n      </div>\n\n      <div class=\"lines\" title=\"12 commits changed 12 files with 2137 additions and 592 deletions\">\n        <a href=\"https://github.com/apple/foundationdb/pull/1207/files\" target=\"_blank\" rel=\"noopener\">\n          <span class=\"added\">+2137</span>\n          <span class=\"removed\">-592</span>\n        </a>\n      </div>\n    </div>\n\n  </div>\n</div>\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>I guess I should also check, you aren\u2019t using the <code>Subspace</code> or <code>Directory</code> functionality from the Java bindings, are you? These make use of the <code>Tuple</code> layer.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-09T21:11:49.271Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 18,
        "readers_count": 17,
        "score": 18.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/pull/1236",
            "internal": false,
            "reflection": false,
            "clicks": 1
          },
          {
            "url": "https://github.com/apple/foundationdb/pull/1207",
            "internal": false,
            "reflection": false,
            "clicks": 1
          },
          {
            "url": "https://github.com/alecgrieser",
            "internal": false,
            "reflection": false,
            "title": "alecgrieser (Alec Grieser) \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/pull/1236/files",
            "internal": false,
            "reflection": false,
            "title": "FDBExceptions are no longer created upon successful operation completion by alecgrieser \u00b7 Pull Request #1236 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/pull/1207/files",
            "internal": false,
            "reflection": false,
            "title": "Java: Tuple serialization/deserialization uses fewer allocations by alecgrieser \u00b7 Pull Request #1207 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8868,
        "name": "Srujan Narkedamalli",
        "username": "srujann",
        "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png",
        "created_at": "2020-12-09T23:55:28.419Z",
        "cooked": "<p>We are not using <code>Subspace</code>, <code>Directory</code> and <code>ByteArrayUtil</code> classes in this code. So likely we are not hitting <code>Tuple</code> layer.  Will try undoing the exception handling change you mentioned. Is there anything else I can try with to narrow down the problem?</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-09T23:55:28.419Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 3.6,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "Srujan Narkedamalli",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 858,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 8871,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-12-10T17:38:00.486Z",
        "cooked": "<p>I don\u2019t have any other specific things to check. You could always try bisecting the various changes that went into it, though, if it turns out the one I suggested above isn\u2019t it. I don\u2019t know if this is completely comprehensive, but here are the PRs from our release notes that should cover the major changes:</p>\n<pre><code class=\"lang-auto\">* Java: Successful commits and range reads no longer create ``FDBException`` objects, which avoids wasting resources and reduces memory pressure. `(Issue #1235) &lt;https://github.com/apple/foundationdb/issues/1235&gt;`_\n* The API to create a database has been simplified across the bindings. All changes are backward compatible with previous API versions, with one exception in Java noted below. `(PR #942) &lt;https://github.com/apple/foundationdb/pull/942&gt;`_\n* Java: Deprecated ``FDB.createCluster`` and ``Cluster``. The preferred way to get a ``Database`` is by using ``FDB.open``, which should work in both new and old API versions. `(PR #942) &lt;https://github.com/apple/foundationdb/pull/942&gt;`_\n* Java: Removed ``Cluster(long cPtr, Executor executor)`` constructor. This is API breaking for any code that has subclassed the ``Cluster`` class and is not protected by API versioning. `(PR #942) &lt;https://github.com/apple/foundationdb/pull/942&gt;`_\n* Java: Several methods relevant to read-only transactions have been moved into the ``ReadTransaction`` interface.\n* Java: Tuples now cache previous hash codes and equality checking no longer requires packing the underlying Tuples. `(PR #1166) &lt;https://github.com/apple/foundationdb/pull/1166&gt;`_\n* Java: Tuple performance has been improved to use fewer allocations when packing and unpacking. `(Issue #1206) &lt;https://github.com/apple/foundationdb/issues/1206&gt;`_\n* Java: Unpacking a Tuple with a byte array or string that is missing the end-of-string character now throws an error. `(Issue #671) &lt;https://github.com/apple/foundationdb/issues/671&gt;`_\n* Java: Unpacking a Tuple constrained to a subset of the underlying array now throws an error when it encounters a truncated integer. `(Issue #672) &lt;https://github.com/apple/foundationdb/issues/672&gt;`_\n</code></pre>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2020-12-10T17:38:00.486Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 16,
        "readers_count": 15,
        "score": 8.2,
        "yours": false,
        "topic_id": 2468,
        "topic_slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/query-latency-increase-in-fdb-java-library-version-6-1-8-onwards/2468/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      8842,
      8843,
      8854,
      8859,
      8860,
      8861,
      8866,
      8868,
      8871
    ]
  },
  "timeline_lookup": [
    [
      1,
      1779
    ],
    [
      3,
      1778
    ],
    [
      7,
      1777
    ],
    [
      9,
      1776
    ]
  ],
  "suggested_topics": [],
  "tags": [
    "bindings",
    "performance"
  ],
  "tags_descriptions": {},
  "fancy_title": "Query latency increase in fdb-java library version 6.1.8 onwards",
  "id": 2468,
  "title": "Query latency increase in fdb-java library version 6.1.8 onwards",
  "posts_count": 9,
  "created_at": "2020-12-07T14:26:04.787Z",
  "views": 766,
  "reply_count": 4,
  "like_count": 0,
  "last_posted_at": "2020-12-10T17:38:00.486Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "query-latency-increase-in-fdb-java-library-version-6-1-8-onwards",
  "category_id": 7,
  "word_count": 1083,
  "deleted_at": null,
  "user_id": 858,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2468",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 9,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 2,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Clj-foundationdb - Clojure bindings over Java wrapper",
      "id": 393,
      "title": "Clj-foundationdb - Clojure bindings over Java wrapper",
      "slug": "clj-foundationdb-clojure-bindings-over-java-wrapper",
      "posts_count": 6,
      "reply_count": 3,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2018-05-10T09:39:50.001Z",
      "last_posted_at": "2018-05-10T16:00:56.888Z",
      "bumped": true,
      "bumped_at": "2018-05-10T16:00:56.888Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 4,
      "views": 1013,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 231,
            "username": "xtreak",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/x/ad7895/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "On Potential Memory Leaking due to FDB Java Library getRange on a Transaction",
      "id": 1603,
      "title": "On Potential Memory Leaking due to FDB Java Library getRange on a Transaction",
      "slug": "on-potential-memory-leaking-due-to-fdb-java-library-getrange-on-a-transaction",
      "posts_count": 5,
      "reply_count": 3,
      "highest_post_number": 5,
      "image_url": null,
      "created_at": "2019-08-30T22:59:33.728Z",
      "last_posted_at": "2019-08-31T18:40:10.044Z",
      "bumped": true,
      "bumped_at": "2019-08-31T18:40:10.044Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 653,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 531,
            "username": "jltz",
            "name": "Jun Li",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/c0e974/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 16,
            "username": "ashishnm",
            "name": "Ashish Motivala",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b5e925/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "FoundationDB 6.1.8 Released",
      "id": 1390,
      "title": "FoundationDB 6.1.8 Released",
      "slug": "foundationdb-6-1-8-released",
      "posts_count": 5,
      "reply_count": 1,
      "highest_post_number": 5,
      "image_url": null,
      "created_at": "2019-05-24T00:58:40.692Z",
      "last_posted_at": "2019-05-28T22:36:20.920Z",
      "bumped": true,
      "bumped_at": "2019-05-28T22:36:20.920Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 8,
      "views": 796,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 166,
            "username": "gaurav",
            "name": "gaurav",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 94,
            "username": "alvin",
            "name": "Alvin Moore",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b5a626/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 158,
            "username": "aseipp",
            "name": "Austin Seipp",
            "avatar_template": "/user_avatar/forums.foundationdb.org/aseipp/{size}/124_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Issues Using Java API on Long Running JVM",
      "id": 693,
      "title": "Issues Using Java API on Long Running JVM",
      "slug": "issues-using-java-api-on-long-running-jvm",
      "posts_count": 4,
      "reply_count": 0,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2018-09-11T17:18:08.844Z",
      "last_posted_at": "2018-09-12T18:23:10.519Z",
      "bumped": true,
      "bumped_at": "2018-09-12T18:23:10.519Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 1013,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 369,
            "username": "ricky.saltzer",
            "name": "Ricky Saltzer",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/f17d59/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "JanusGraph FoundationDB storage adapter",
      "id": 286,
      "title": "JanusGraph FoundationDB storage adapter",
      "slug": "janusgraph-foundationdb-storage-adapter",
      "posts_count": 4,
      "reply_count": 0,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2018-04-26T22:29:18.204Z",
      "last_posted_at": "2018-04-27T20:10:43.943Z",
      "bumped": true,
      "bumped_at": "2018-04-27T20:10:43.943Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 3792,
      "category_id": 9,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 191,
            "username": "twilmes",
            "name": "Ted Wilmes",
            "avatar_template": "/user_avatar/forums.foundationdb.org/twilmes/{size}/552_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 30,
            "username": "wwilson",
            "name": "Will Wilson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 4,
            "username": "bbc",
            "name": "Ben Collins",
            "avatar_template": "/user_avatar/forums.foundationdb.org/bbc/{size}/4_2.png",
            "trust_level": 2
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 5,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 858,
        "username": "srujann",
        "name": "Srujan Narkedamalli",
        "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 858,
      "username": "srujann",
      "name": "Srujan Narkedamalli",
      "avatar_template": "/user_avatar/forums.foundationdb.org/srujann/{size}/996_2.png"
    },
    "last_poster": {
      "id": 12,
      "username": "ajbeamon",
      "name": "A.J. Beamon",
      "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
    },
    "links": [
      {
        "url": "https://github.com/wavefrontHQ/foundationdb-utils/blob/master/src/main/java/com/wavefront/fdb/utils/BatchReader.java",
        "title": "foundationdb-utils/BatchReader.java at master \u00b7 wavefrontHQ/foundationdb-utils \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 858,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/pull/1207",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 12,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/pull/1236",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 12,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}