{
  "post_stream": {
    "posts": [
      {
        "id": 1751,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-07-30T21:18:57.115Z",
        "cooked": "<p>Hi,</p>\n<p>Finally my cluster is up and running so I was able to do some significant testing. At this point, we\u2019re using it as a cache, with a very simple transaction logic</p>\n<pre><code class=\"lang-go\">_, err = db.Transact(func(tr fdb.Transaction) (ret interface{}, err error) {\n    future := tr.Get(sub.Pack(tuple.Tuple{\"cache\", ID}))\n    res := future.MustGet()\n\n    if len(res) == 0 {\n        tr.Set(sub.Pack(tuple.Tuple{\"cache\", ID}), []byte(strconv.FormatInt(time.Now().UnixNano(), 10)))\n\n        processChan &lt;- id\n    }\n\n    return\n})\n</code></pre>\n<p>I tested three different deployments, all on GCP (google cloud)</p>\n<ol>\n<li>3 servers - each 4 vcpu, 16GB ram, 1TB ssd</li>\n<li>3 servers - each 32 vcpu, 120GB ram, 1TB ssd</li>\n<li>11 servers - each 4 vcpu, 16GB ram, 375GB NVME SSD</li>\n</ol>\n<p>I\u2019m running FDB with double redundancy and <code>ssd</code> mode. Each server has equivalent of processes to vcpus (4 has 4, 32 has 32 \u2026). Each servers also has one coordinator, so 3 servers will have 3 coordinators).</p>\n<p>There are 80 servers running that run the above code and do some other stuff, with each at 60 gourutines (each goroutines creates a single connection to FDB).</p>\n<p>With the 1) setting, I started running into issues that the disk IO was too high and the latency was way up.</p>\n<p>Then I switched to 2), especially because GCP has different SSD performance based on how many cores the <a href=\"https://cloud.google.com/compute/docs/disks/performance\" rel=\"nofollow noopener\">server has</a>. The max you can get out of the setup is around 32 cores and 1TB, especially for writes.</p>\n<p>This setup immediately showed improvements, while the HDD throughput (for writes) was running as high as 300MB/s on those three servers.</p>\n<p>And finally I switched to 3) where I got way more servers all running NVME disks. This setup is running in testing \u201cproduction\u201d for last 3 days so I have the most data for it. One of the confusing things I\u2019m seeing is that the server is reporting ~90% disk IO but nor IOPS nor the throughput is at any significant number and I can\u2019t get it any higher. I though that NVME will be showing the best results, but it\u2019s far from it.</p>\n<p>Here is a dump from <code>status details</code></p>\n<pre><code class=\"lang-auto\">fdb&gt; status details\n\nUsing cluster file `fdb.cluster'.\n\nCould not communicate with all of the coordination servers.\n  The database will remain operational as long as we\n  can connect to a quorum of servers, however the fault\n  tolerance of the system is reduced as long as the\n  servers remain disconnected.\n\n  10.240.0.252:4500  (reachable)\n  10.240.1.34:4500  (unreachable)\n  10.240.1.155:4500  (reachable)\n  10.240.1.171:4500  (reachable)\n  10.240.2.103:4500  (reachable)\n  10.240.3.144:4500  (reachable)\n  10.240.3.192:4500  (reachable)\n  10.240.4.228:4500  (unreachable)\n  10.240.5.32:4500  (reachable)\n  10.240.5.59:4500  (reachable)\n  10.240.10.139:4500  (reachable)\n\nConfiguration:\n  Redundancy mode        - double\n  Storage engine         - ssd-2\n  Coordinators           - 11\n\nCluster:\n  FoundationDB processes - 36\n  Machines               - 9\n  Memory availability    - 3.8 GB per process on machine with least available\n                           &gt;&gt;&gt;&gt;&gt; (WARNING: 4.0 GB recommended) &lt;&lt;&lt;&lt;&lt;\n  Retransmissions rate   - 2 Hz\n  Fault Tolerance        - 1 machine\n  Server time            - 07/30/18 14:10:22\n\nData:\n  Replication health     - Healthy\n  Moving data            - 0.000 GB\n  Sum of key-value sizes - 114.105 GB\n  Disk space used        - 298.159 GB\n\nOperating space:\n  Storage server         - 321.6 GB free on most full server\n  Log server             - 321.6 GB free on most full server\n\nWorkload:\n  Read rate              - 90375 Hz\n  Write rate             - 7996 Hz\n  Transactions started   - 90130 Hz\n  Transactions committed - 2664 Hz\n  Conflict rate          - 200 Hz\n\nBackup and DR:\n  Running backups        - 0\n  Running DRs            - 0\n\nProcess performance details:\n  10.240.0.252:4500      ( 29% cpu; 31% machine; 0.018 Gbps; 50% disk IO; 2.9 GB / 3.8 GB RAM  )\n  10.240.0.252:4501      ( 26% cpu; 31% machine; 0.018 Gbps; 49% disk IO; 2.9 GB / 3.8 GB RAM  )\n  10.240.0.252:4502      ( 26% cpu; 31% machine; 0.018 Gbps; 49% disk IO; 2.8 GB / 3.8 GB RAM  )\n  10.240.0.252:4503      ( 30% cpu; 31% machine; 0.018 Gbps; 49% disk IO; 2.8 GB / 3.8 GB RAM  )\n  10.240.1.155:4500      ( 64% cpu; 48% machine; 0.049 Gbps; 46% disk IO; 3.1 GB / 3.9 GB RAM  )\n  10.240.1.155:4501      ( 64% cpu; 48% machine; 0.049 Gbps; 48% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.1.155:4502      ( 27% cpu; 48% machine; 0.049 Gbps; 48% disk IO; 2.7 GB / 3.9 GB RAM  )\n  10.240.1.155:4503      ( 27% cpu; 48% machine; 0.049 Gbps; 49% disk IO; 3.0 GB / 3.9 GB RAM  )\n  10.240.1.171:4500      ( 31% cpu; 30% machine; 0.017 Gbps; 46% disk IO; 3.0 GB / 3.8 GB RAM  )\n  10.240.1.171:4501      ( 28% cpu; 30% machine; 0.017 Gbps; 47% disk IO; 2.7 GB / 3.8 GB RAM  )\n  10.240.1.171:4502      ( 30% cpu; 30% machine; 0.017 Gbps; 47% disk IO; 2.9 GB / 3.8 GB RAM  )\n  10.240.1.171:4503      ( 29% cpu; 30% machine; 0.017 Gbps; 47% disk IO; 2.7 GB / 3.8 GB RAM  )\n  10.240.2.103:4500      ( 32% cpu; 36% machine; 0.030 Gbps; 48% disk IO; 3.1 GB / 3.9 GB RAM  )\n  10.240.2.103:4501      ( 29% cpu; 36% machine; 0.030 Gbps; 48% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.2.103:4502      ( 36% cpu; 36% machine; 0.030 Gbps; 49% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.2.103:4503      ( 37% cpu; 36% machine; 0.030 Gbps; 49% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.3.144:4500      ( 31% cpu; 32% machine; 0.017 Gbps; 47% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.3.144:4501      ( 30% cpu; 32% machine; 0.017 Gbps; 46% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.3.144:4502      ( 31% cpu; 32% machine; 0.017 Gbps; 47% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.3.144:4503      ( 29% cpu; 32% machine; 0.017 Gbps; 46% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.3.192:4500      ( 35% cpu; 53% machine; 0.042 Gbps; 84% disk IO; 3.0 GB / 3.9 GB RAM  )\n  10.240.3.192:4501      ( 68% cpu; 53% machine; 0.042 Gbps; 84% disk IO; 3.0 GB / 3.9 GB RAM  )\n  10.240.3.192:4502      ( 33% cpu; 53% machine; 0.042 Gbps; 84% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.3.192:4503      ( 74% cpu; 53% machine; 0.042 Gbps; 84% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.5.32:4500       ( 65% cpu; 43% machine; 0.034 Gbps; 88% disk IO; 3.0 GB / 3.9 GB RAM  )\n  10.240.5.32:4501       ( 36% cpu; 43% machine; 0.034 Gbps; 89% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.5.32:4502       ( 33% cpu; 43% machine; 0.034 Gbps; 86% disk IO; 3.0 GB / 3.9 GB RAM  )\n  10.240.5.32:4503       ( 30% cpu; 43% machine; 0.034 Gbps; 84% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.5.59:4500       ( 31% cpu; 29% machine; 0.018 Gbps; 47% disk IO; 3.0 GB / 3.8 GB RAM  )\n  10.240.5.59:4501       ( 27% cpu; 29% machine; 0.018 Gbps; 47% disk IO; 2.9 GB / 3.8 GB RAM  )\n  10.240.5.59:4502       ( 29% cpu; 29% machine; 0.018 Gbps; 47% disk IO; 2.9 GB / 3.8 GB RAM  )\n  10.240.5.59:4503       ( 28% cpu; 29% machine; 0.018 Gbps; 47% disk IO; 2.7 GB / 3.8 GB RAM  )\n  10.240.10.139:4500     ( 26% cpu; 36% machine; 0.035 Gbps; 87% disk IO; 3.1 GB / 3.9 GB RAM  )\n  10.240.10.139:4501     ( 23% cpu; 36% machine; 0.035 Gbps; 83% disk IO; 2.8 GB / 3.9 GB RAM  )\n  10.240.10.139:4502     ( 29% cpu; 36% machine; 0.035 Gbps; 86% disk IO; 2.9 GB / 3.9 GB RAM  )\n  10.240.10.139:4503     ( 58% cpu; 36% machine; 0.035 Gbps; 87% disk IO; 3.1 GB / 3.9 GB RAM  )\n\nClient time: 07/30/18 14:10:20\n</code></pre>\n<p>I would appreciate any pointers regarding the best setup that allows the highest utilization of the resources.</p>\n<p>Some of my questions</p>\n<ul>\n<li>is it better to have many smaller servers or a few large ones?</li>\n<li>what is the most optimal configuration for a single server?</li>\n<li>I\u2019m still pretty confused by the <a href=\"https://apple.github.io/foundationdb/configuration.html#guidelines-for-setting-process-class\" rel=\"nofollow noopener\">process class</a>. Do I set them up manually? Do I let the client/server to decide which ones to dedicate or should I choose them manually?</li>\n<li>It seems like NVME disks may not be optimal for FDB. Is it better to use just SSD?</li>\n</ul>\n<p>Anything else that you would suggest?</p>\n<p>BTW I must say the resiliency of the system if mind-blowing. I took down one server to expand it and everything worked incredibly well. Each time I brought the server back the whole cluster synced within couple of minutes and I could move on on the next one.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T21:18:57.115Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1077,
        "reads": 176,
        "readers_count": 175,
        "score": 5467.0,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/configuration.html#guidelines-for-setting-process-class",
            "internal": false,
            "reflection": false,
            "title": "Configuration \u2014 FoundationDB 5.2",
            "clicks": 7
          },
          {
            "url": "https://cloud.google.com/compute/docs/disks/performance",
            "internal": false,
            "reflection": false,
            "title": "Optimizing Persistent Disk and Local SSD Performance \u00a0|\u00a0 Compute Engine Documentation \u00a0|\u00a0 Google Cloud",
            "clicks": 4
          },
          {
            "url": "https://forums.foundationdb.org/t/warning-a-single-process-is-both-a-transaction-log-and-a-storage-server/1529/2",
            "internal": true,
            "reflection": true,
            "title": "WARNING A single process is both a transaction log and a storage server",
            "clicks": 2
          },
          {
            "url": "https://forums.foundationdb.org/t/how-to-spin-up-foundationdb-cluster-in-aws/1198/2",
            "internal": true,
            "reflection": true,
            "title": "How to spin up foundationdb cluster in aws",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 2
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 1752,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2018-07-30T22:31:31.062Z",
        "cooked": "<p>How are the IDs being generated? Are they sequential or random?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T22:31:31.062Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 150,
        "readers_count": 149,
        "score": 79.8,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1753,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-07-30T22:44:11.250Z",
        "cooked": "<p>Well, they are sequential-ish in groups. Some groups are pretty large, some are smaller.</p>\n<p>It looks like this in the database<br>\n<code>namespace/source/cache/id</code> or in a real example</p>\n<pre><code class=\"lang-auto\">discover/platform1/cache/8n7M-UYSIJA\ndiscover/platform1/cache/_YOg9_pbsnk\ndiscover/platform1/cache/4HN41of8WK8\ndiscover/platform1/cache/5u85ljWc8ck\ndiscover/platform1/cache/R15juwpxYu0\ndiscover/platform2/cache/1808674919186284\ndiscover/platform2/cache/1930138083685906\ndiscover/platform1/cache/UVf55-LvRHQ\ndiscover/platform1/cache/9sT0AMIL88E\ndiscover/platform2/cache/1990978757644243\ndiscover/platform2/cache/1363389550372795\ndiscover/platform1/cache/hmYu-Cjk3CI\ndiscover/platform1/cache/n8uXo5Scwfk\ndiscover/platform1/cache/h0arxNpGdXE\ndiscover/platform2/cache/693874064116539\ndiscover/platform2/cache/10215744445793392\ndiscover/platform2/cache/10215965264421613\ndiscover/platform2/cache/1885408654837611\ndiscover/platform2/cache/1796496660388522\ndiscover/platform2/cache/1541671129225742\n....\n</code></pre>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T22:44:11.250Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 153,
        "readers_count": 152,
        "score": 55.4,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1754,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2018-07-30T23:06:12.979Z",
        "cooked": "<p>If you\u2019re writing sequentially to a range of keys, it can produce the effect you\u2019re seeing where one disk is being disproportionately stressed. From what you\u2019re describing that could be what\u2019s happening.</p>\n<p>Try writing to a completely random range of keys and see if you see the same issues.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T23:06:12.979Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 139,
        "readers_count": 138,
        "score": 47.6,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1755,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2018-07-30T23:11:00.369Z",
        "cooked": "<p>I realize this isn\u2019t useful for your application! Just as a diagnosis.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T23:11:00.369Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 134,
        "readers_count": 133,
        "score": 26.6,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1756,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-07-30T23:15:53.563Z",
        "cooked": "<p>That is unfortunately not possible. We have no control over the keys as they are coming from external services at a pace that we also have no control over.</p>\n<p>I may be wrong, but this may not be the a big issue. If you look at the servers, it\u2019s not great but it\u2019s also not super uneven.</p>\n<p>Could you maybe took a shot at my questions about the general structure of the cluster? What\u2019s the best setup, how to maybe think about it, anything else that could be helpful?</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T23:15:53.563Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 136,
        "readers_count": 135,
        "score": 32.0,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1757,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2018-07-30T23:18:32.026Z",
        "cooked": "<p>Unfortunately, I am not a FoundationDB expert, I\u2019ve just ran across that specific issue before and had it manifest in that way with high IO on one server due to a hot key range.</p>\n<p>You can try separating the transaction logging disk from the storage disk which I do know helps.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T23:18:32.026Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 137,
        "readers_count": 136,
        "score": 42.2,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1758,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-07-30T23:21:48.392Z",
        "cooked": "<p>Oh gotcha. Appreciate your pointers though!</p>\n<p>The transaction logging disk is separate, if you are referring to the log dir</p>\n<pre><code class=\"lang-auto\">datadir = /var/lib/foundationdb/data/$ID\nlogdir = /var/log/foundationdb\n</code></pre>\n<pre><code class=\"lang-auto\">Filesystem      Size  Used Avail Use% Mounted on\nudev            7.4G     0  7.4G   0% /dev\ntmpfs           1.5G   12M  1.5G   1% /run\n/dev/sda1        30G  5.1G   24G  18% /\ntmpfs           7.4G  4.0K  7.4G   1% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           7.4G     0  7.4G   0% /sys/fs/cgroup\ntmpfs           1.5G     0  1.5G   0% /run/user/1010\n/dev/nvme0n1    369G   31G  319G   9% /var/lib/foundationdb/data\n</code></pre>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-07-30T23:21:48.392Z",
        "reply_count": 1,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 138,
        "readers_count": 137,
        "score": 62.6,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1765,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2018-08-01T00:02:56.195Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"1\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>is it better to have many smaller servers or a few large ones?</li>\n</ul>\n</blockquote>\n</aside>\n<p>What I\u2019d actually suggest optimizing for is a process:disk ratio.  32 processes : 1 disk is probably a bit too much.  Doing 1-2 processes per SSD is a thing that I\u2019ve generally seen able to reach saturation of an SSD before, and anything above that just means an increase in disk latency but not throughput.</p>\n<p>FDB will, by default, recruit a storage server on every process, so having 32 processes connected in a cluster will, if process classes aren\u2019t specified, mean 32 storage servers all competing for disk accesses.</p>\n<p>This advice applies a bit more to bare metal than VMs.  I\u2019ve generally only seem VM providers offer you one disk, so in that sense, it\u2019s better to run more VMs that are smaller than fewer larger VMs because that gives you a better process:disk ratio.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"1\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>what is the most optimal configuration for a single server?</li>\n</ul>\n</blockquote>\n</aside>\n<p>Running 1 log per disk, or 2 storage servers per disk, and setting the rest of the processes you might run as stateless will probably give you full throughput, and the best latency.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"1\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>I\u2019m still pretty confused by the <a href=\"https://apple.github.io/foundationdb/configuration.html#guidelines-for-setting-process-class\">process class</a>. Do I set them up manually? Do I let the client/server to decide which ones to dedicate or should I choose them manually?</li>\n</ul>\n</blockquote>\n</aside>\n<p>You would need to set them up manually.  Did you already see <a href=\"https://forums.foundationdb.org/t/cluster-tuning-cookbook/520\">this thread</a>?</p>\n<p>Admittedly, these really do need to get easier to use, or preferably not necessary to understand at all to get a well performing FDB cluster.  But until then, it helps to specify your cluster layout.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"1\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>It seems like NVME disks may not be optimal for FDB. Is it better to use just SSD?</li>\n</ul>\n</blockquote>\n</aside>\n<p>I would expect NVMe disks to be better for FDB, and by the metrics that FDB, or any database should care about, NVMe drives should be much better.  If you do <code>iotop</code>, or some equivalent process that can break down disk usage by process, can you double check it is indeed <code>fdbserver</code>?</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"8\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<p>The transaction logging disk is separate, if you are referring to the log dir</p>\n</blockquote>\n</aside>\n<p><code>logdir</code> is where our textual logs go, but not the transaction log data files.  Those still go into datadir.  The only way to prevent a storage server being recruited on the same process as a transaction log is to use process classes.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-01T00:02:56.195Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 2,
        "incoming_link_count": 46,
        "reads": 143,
        "readers_count": 142,
        "score": 258.4,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520",
            "internal": true,
            "reflection": false,
            "title": "Cluster tuning cookbook",
            "clicks": 55
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1776,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-08-01T22:20:47.660Z",
        "cooked": "<p>Thanks <a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a> for the answer. I read and re-read it multiple times including the thread you pointed me to and I think I have more questions than I got answers to.</p>\n<p>Maybe you could help me (and others) to understand how to properly structure a cluster. I read <a href=\"https://forums.foundationdb.org/t/cluster-tuning-cookbook/520/7?u=thomasj\">here</a> the suggestion how to split 8 servers, but what am I not understanding is how would you deploy and expand something like this. What if you don\u2019t have 8 but 100 servers?</p>\n<p>So here are some questions that I\u2019m struggling with (lets consider that I have 10 servers with a preference to expand to more):</p>\n<p>You suggested that each server should be dedicated to a very specific class. So now if you have 4 core server, then 1 process will be lets say <code>class=storage</code> and the rest would be <code>stateless</code>. If it\u2019s 4 core server, then for 10 servers, there are 40 cores, but only 10 assigned to storage/transactions and lets say 8 proxies and 5 logs.</p>\n<ul>\n<li>What about the rest? What are those going to do?</li>\n<li>Additionally how would you structure those servers, specially hard-drives? Are they equal (e.g. 1TB space each?)</li>\n<li>What about coordinators? Is it sensible to make one process from each \u201cphysical\u201d server a coordinator? What is coordinator anyway. Is it a process that is dedicated to something, or just a discovery mechanism and it truly doesn\u2019t matter how many are there?</li>\n<li>What\u2019s the best spread of classes? Based on this <a href=\"https://apple.github.io/foundationdb/configuration.html#guidelines-process-class-config\" rel=\"nofollow noopener\">guide</a> it looks like 10 for logs, 9 for proxies. From your example you had 2 for logs, 6 for storage. So extrapolating that on 10 servers: 7 storage, 3 logs, 30 stateless with 10 of them used as proxies (on 4 core server)</li>\n<li>Would it be more sensible to have just 2 core server then?</li>\n</ul>\n<p>Also one other question. I just altered the cluster to</p>\n<pre><code class=\"lang-auto\">Configuration:\n  Redundancy mode        - double\n  Storage engine         - ssd-2\n  Coordinators           - 9\n  Desired Proxies        - 5\n  Desired Logs           - 8\n</code></pre>\n<p>but there is no information on which process is utilized and what class is being assigned.</p>\n<p>I still have each server to have both data and log class</p>\n<pre><code class=\"lang-auto\">[fdbserver.4500]\nclass=stateless\n[fdbserver.4501]\nclass=storage\n[fdbserver.4502]\nclass=transaction\n[fdbserver.4503]\nclass=stateless\n</code></pre>\n<p>as I need to figure out how to do the deployment across equal servers unequally.</p>\n<p>Thank you for your help!</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-01T22:20:47.660Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 37,
        "reads": 144,
        "readers_count": 143,
        "score": 218.8,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520/7",
            "internal": true,
            "reflection": false,
            "title": "Cluster tuning cookbook",
            "clicks": 17
          },
          {
            "url": "https://apple.github.io/foundationdb/configuration.html#guidelines-process-class-config",
            "internal": false,
            "reflection": false,
            "title": "Configuration \u2014 FoundationDB 5.2",
            "clicks": 7
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1782,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2018-08-02T19:33:54.706Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"10\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>What about the rest? What are those going to do?</li>\n</ul>\n</blockquote>\n</aside>\n<p>Probably 80-90 of the 100 severs are just going to be running storage servers.  It\u2019s probably slightly better to not assign them any process class, rather than assign them storage process class, so that in the case of failures, you have processes to fall back on that you can recruit other roles from.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"10\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>Additionally how would you structure those servers, specially hard-drives? Are they equal (e.g. 1TB space each?)</li>\n</ul>\n</blockquote>\n</aside>\n<p>It doesn\u2019t really matter, depending on your workload.  Data distribution aims to keep the used space percent roughly equal among storage servers.  So nothing bad will happen if your run a cluster, half with 1TB drives and half with 10TB drives.</p>\n<p>You will, however, have created a cluster where you have 10x more disk time for some data than other data.  If you\u2019re randomly reading keys from your database, 1TB storage servers are 10x more likely to have that data in memory, and if they don\u2019t, have 10x less requests going to their drives. If you have largely cold data, then this won\u2019t matter.  If you\u2019re latency sensitive, then you want to size your drives equally, and preferably to match your IO/s,</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"10\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>What about coordinators? Is it sensible to make one process from each \u201cphysical\u201d server a coordinator? What is coordinator anyway. Is it a process that is dedicated to something, or just a discovery mechanism and it truly doesn\u2019t matter how many are there?</li>\n</ul>\n</blockquote>\n</aside>\n<p>Think of coordinators as a zookeeper cluster.  You\u2019ll want to run 2n+1 of then, where n is the number of failures you can take and keep running.  If you\u2019re running in triple replication, then n=2.  If you\u2019re running double replication, then n=1.</p>\n<p>If you\u2019re running across multiple DC\u2019s, it\u2019s best to adjust this math a little bit, so that you have 2n+1 coordinators per DC, as always having a local coordinator will save you WAN traffic.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"10\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>What\u2019s the best spread of classes? Based on this <a href=\"https://apple.github.io/foundationdb/configuration.html#guidelines-process-class-config\">guide</a> it looks like 10 for logs, 9 for proxies. From your example you had 2 for logs, 6 for storage. So extrapolating that on 10 servers: 7 storage, 3 logs, 30 stateless with 10 of them used as proxies (on 4 core server)</li>\n</ul>\n</blockquote>\n</aside>\n<p>The exact best number of logs and proxies is going to vary strongly based on your workload.  You essentially want the minimum number of them that can still support your load with some overhead left for safety.</p>\n<p>My very rough guess would be to say when running with with the <code>ssd</code> storage engine, you\u2019ll probably want about 1 log for every 8 storage servers, and probably around 1 proxy per log.  But I would strongly suggest running some representative performance test, and varying the number of proxies and logs until you find an optimal spot.</p>\n<aside class=\"quote no-group\" data-username=\"ThomasJ\" data-post=\"10\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/48.png\" class=\"avatar\"> ThomasJ:</div>\n<blockquote>\n<ul>\n<li>Would it be more sensible to have just 2 core server then?</li>\n</ul>\n</blockquote>\n</aside>\n<p>Quite possibly, yes.  The extra cores could be useful to run stateless roles, but they have their own demands.  Proxies and logs are both network bandwidth hungry, as all commits in the system flow through them, so it\u2019s good to plan out their network bandwidth allocations as well.</p>\n<p>I\u2019m used to thinking about this in a bare metal world, and not one in which your disk (and network?) scales with the number of cores you have.  FDB, overall, should be more disk and network bottlenecked than CPU, as its primary job is to do IO.</p>\n<p>If you\u2019re writing any layers to run on top of FDB, then extra cores alongside your storage servers are great places to run you layers processes \u2013 both from a latency and binpacking perspective.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-02T19:33:54.706Z",
        "reply_count": 0,
        "reply_to_post_number": 10,
        "quote_count": 1,
        "incoming_link_count": 373,
        "reads": 133,
        "readers_count": 132,
        "score": 1921.4,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 2
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1784,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2018-08-02T20:03:56.006Z",
        "cooked": "<p>Thanks for that write up <a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a>, I too had questions about good baseline ratios of different process classes to start with when deploying more processes into the cluster. So far I had just been doing that by trial and error until I got a passable result compared to what my intuition said should be happening.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-02T20:03:56.006Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 117,
        "readers_count": 116,
        "score": 63.4,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1789,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2018-08-02T22:32:25.458Z",
        "cooked": "<p>The 1 log : 8 ssd storage ratio is only roughly what I\u2019ve seen.  I\u2019m being very specific about <code>ssd</code>, because the memory storage engine can apply mutations to durable storage faster, so the ratio changes.  I <em>think</em> it\u2019s closer to 1:2, but it\u2019s not a thing I\u2019ve benchmarked as often.</p>\n<p>Ideally, you\u2019d run a <code>single ssd proxy=5 log=5</code> 1 storage server cluster, run a write heavy benchmark, and look at the trace files from the storage server to determine what rate of mutations your storage server can apply on your hardware.  Then do the same with a <code>single ssd proxy=5 log=1</code> 10 storage server cluster, and see what rate of mutations one tlog can support.</p>\n<p>These two figures then give you your ratios.  Each additional tlog and proxy you add isn\u2019t going to give you quite as much benefit as the last, but your goal is to make sure that you have enough tlogs to be able to feed your storage servers at their full rate, and then give yourself an extra little bit of headroom so that you aren\u2019t running your cluster at 100% and thus getting poor latency.</p>\n<p>This is, of course, assuming you\u2019re targeting being able to do full write throughput.  If you have a lot of cold data, and care more about commit latency, then running with less proxies or logs than your maximum would be a better option.</p>\n<p>I filed <a href=\"https://github.com/apple/foundationdb/issues/552\" rel=\"nofollow noopener\">Storage Server recruitment should consider existing recruited roles #552</a> a bit ago, as explicitly assigning process classes is mostly about keeping storage servers away from other latency-critical parts of the system.  I don\u2019t really have any ideas on how we would do better auto-configuration of proxies and logs, as changing them invokes a recovery, and a recovery means O(hundreds of milliseconds) write downtime / latency spike.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-02T22:32:25.458Z",
        "reply_count": 2,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 268,
        "reads": 116,
        "readers_count": 115,
        "score": 1433.2,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/issues/552",
            "internal": false,
            "reflection": false,
            "title": "Storage Server recruitment should consider existing recruited roles \u00b7 Issue #552 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 16
          },
          {
            "url": "https://forums.foundationdb.org/t/how-to-troubleshoot-throughput-performance-degrade/1436/9",
            "internal": true,
            "reflection": true,
            "title": "How to troubleshoot throughput performance degrade?",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 2
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1790,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-08-03T01:54:03.534Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a> this is all incredibly helpful. I spend weeks reading through the docs and preparing for spinning the cluster, I got a bit blindsided by the challenges of actually optimizing the cluster. But this helps a lot.</p>\n<p>I still run a very suboptimal cluster at this point, but even with it I see a lot of improvement. My next step is going to be try to follow your guidance and rebuild the cluster with those parameters, specifically [<strong>24 servers, each 2cpu/8GB ram, 375GB local ssd</strong>] and running them with these settings:</p>\n<ul>\n<li>double ssd</li>\n<li>20x with 1 storage and 1 stateless</li>\n<li>4x  with 1 transaction and 1 stateless</li>\n<li>4 coordinators</li>\n<li>4x proxy</li>\n</ul>\n<p>Also need to figure out backup somehow, but that\u2019s for later. This means that I will have 24 processes in <code>stateless</code>, 4 recruited as <code>proxy</code> and the rest just idling.</p>\n<p>Does it sound about right to you?</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-08T17:04:53.801Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 110,
        "readers_count": 109,
        "score": 42.0,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1852,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2018-08-09T02:47:48.830Z",
        "cooked": "<p>(Oh, sorry, apparently I never hit reply.)</p>\n<p>I\u2019m glad to have helped. <img src=\"https://emoji.discourse-cdn.com/twitter/slightly_smiling_face.png?v=5\" title=\":slightly_smiling_face:\" class=\"emoji\" alt=\":slightly_smiling_face:\"></p>\n<p>Your proposed layout sounds good to me.  It\u2019d be an interesting test to see if 2x storage servers per host runs better than 1x storage server.</p>\n<p>The FDB documentation should probably be scrubbed clean of the <code>transaction</code> class, which should probably be replaced with the <code>log</code> class.  <code>transaction</code> allows either a transaction log or a proxy to be recruited there, oddly.  Looking back over the documentation on setting process classes, much of the above thread should probably be shuffled into the documentation also.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-09T02:47:48.830Z",
        "reply_count": 1,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 110,
        "readers_count": 109,
        "score": 52.0,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 311,
          "username": "ThomasJ",
          "name": "Thomas Johson",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1856,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-08-09T05:08:48.132Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"15\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>It\u2019d be an interesting test to see if 2x storage servers per host runs better than 1x storage server.</p>\n</blockquote>\n</aside>\n<p>In that case I will stick with 4 CPUs, 2 storage, 2 stateless.</p>\n<p>Would you also suggest to do 2x log?</p>\n<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"15\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>The FDB documentation should probably be scrubbed clean of the <code>transaction</code> class, which should probably be replaced with the <code>log</code> class.</p>\n</blockquote>\n</aside>\n<p>Oh, good one. Didn\u2019t know that. Will replace transaction with <code>log</code>.</p>\n<p>I made changes to the existing cluster (still running <code>storage</code> and <code>transaction</code> on the same server) and getting incredible performance.</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-09T05:08:48.132Z",
        "reply_count": 1,
        "reply_to_post_number": 15,
        "quote_count": 1,
        "incoming_link_count": 5,
        "reads": 108,
        "readers_count": 107,
        "score": 51.6,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1887,
        "name": "Matt Lohier",
        "username": "aqua",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
        "created_at": "2018-08-15T01:02:00.696Z",
        "cooked": "<p>Hi Thomas,</p>\n<p>I have been asking myself those same questions. It\u2019s good to see I wasn\u2019t the only one. Thank you very much <a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a> for your inputs!<br>\nI have followed your thinking process, and I am now wondering if you deployed those FDB machines with different configurations depending on each role your were assigning them. And if so, how you achieved that unequal deployment (to reuse your term)?  Manually or with some sort of automation/reproducibility\u2026 ?</p>\n<p>And do you mind confirming that you organised your 24 servers in 2 groups (configuration template):</p>\n<ul>\n<li>20 x configured with 2 processes (class=storage, class=stateless)</li>\n<li>4 x configured with 2 processes (class=log, class=stateless)</li>\n</ul>\n<p>Then applied the following fdbcli configure commands:<br>\nconfigure proxies=4<br>\ncoordinators addr1 addr2 addr3 addr4</p>\n<p>Looking forward to hearing from you<br>\nThank you so much / Matt</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-15T01:02:00.696Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 104,
        "readers_count": 103,
        "score": 30.8,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Matt Lohier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 311,
          "username": "ThomasJ",
          "name": "Thomas Johson",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 255,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1889,
        "name": "Matt Lohier",
        "username": "aqua",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
        "created_at": "2018-08-15T01:24:20.146Z",
        "cooked": "<p>Hi Alex,</p>\n<p>I am interested in running your suggested benchmarks however I am wondering if I am reading this properly\u2026</p>\n<p>You ask to run a first test with <code>single ssd proxy=5 log=5</code> and then a second one with <code>single ssd proxy=5 log=1</code> but is it a typo that you are changing the cluster size? You\u2019re mentioning a cluster of 1 storage server for the first test, and then a cluster of 10 storage servers for the second time. I\u2019m a bit puzzled why would that be\u2026 I thought I would stick to a cluster of 10 for both tests.</p>\n<p>Thank you for your assistance!</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-15T01:24:20.146Z",
        "reply_count": 0,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 99,
        "readers_count": 98,
        "score": 44.8,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Matt Lohier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 255,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1890,
        "name": "Thomas Johson",
        "username": "ThomasJ",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "created_at": "2018-08-15T01:54:17.494Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"aqua\" data-post=\"17\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/48.png\" class=\"avatar\"> aqua:</div>\n<blockquote>\n<p>I have followed your thinking process, and I am now wondering if you deployed those FDB machines with different configurations depending on each role your were assigning them.</p>\n</blockquote>\n</aside>\n<p>Actually no. I deployed equal servers, <code>4 vCPU, 16GB RAM, 500GB SSD</code> with 4 fdb processes, 2 for <code>storage</code> and 2 for <code>stateless</code>. On two servers I swapped the 2x <code>storage</code> for 2x <code>log</code> and then I went with <code>ssd double</code>, 4 coordinators and 4 desired logs, 2 resolvers and 3 proxies.</p>\n<aside class=\"quote no-group\" data-username=\"aqua\" data-post=\"17\" data-topic=\"601\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/48.png\" class=\"avatar\"> aqua:</div>\n<blockquote>\n<ul>\n<li>20 x configured with 2 processes (class=storage, class=stateless)</li>\n<li>4 x configured with 2 processes (class=log, class=stateless)</li>\n</ul>\n</blockquote>\n</aside>\n<p>Correct.</p>\n<p>We\u2019re still testing this deployment. I\u2019m going to try one more, where we swap SSD for Local SSD on all servers. We are particularly trying to find out how many concurrent reads from how many external servers can we do.</p>\n<p>A smaller cluster that is running for a while is doing actually pretty well (9 servers, 4 vcpu, 16GB RAM, \u2026).</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-15T01:54:17.494Z",
        "reply_count": 1,
        "reply_to_post_number": 17,
        "quote_count": 1,
        "incoming_link_count": 9,
        "reads": 102,
        "readers_count": 101,
        "score": 70.2,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Thomas Johson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 311,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1891,
        "name": "Matt Lohier",
        "username": "aqua",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
        "created_at": "2018-08-15T02:10:15.520Z",
        "cooked": "<p>Thank you Thomas for your fast response, it\u2019s awesome. Everything makes sense, I\u2019ll try the same cluster on AWS with NVME SSD disks.</p>\n<p>Have you compared the performance of both clusters (9 instances vs 24), and do you see a linear(-fish) performance improvement? I still don\u2019t understand how (or have verified that) performance is improved with larger cluster size. In my case I was getting the same results with a cluster of 10 instances, and one of 20 instances (but I had left the process class unspecified (so default to storage server)).</p>\n<p>Thanks!</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 21,
        "updated_at": "2018-08-15T02:10:15.520Z",
        "reply_count": 1,
        "reply_to_post_number": 19,
        "quote_count": 0,
        "incoming_link_count": 10,
        "reads": 104,
        "readers_count": 103,
        "score": 75.6,
        "yours": false,
        "topic_id": 601,
        "topic_slug": "production-optimizations",
        "display_username": "Matt Lohier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 311,
          "username": "ThomasJ",
          "name": "Thomas Johson",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 255,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/production-optimizations/601/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      1751,
      1752,
      1753,
      1754,
      1755,
      1756,
      1757,
      1758,
      1765,
      1776,
      1782,
      1784,
      1789,
      1790,
      1852,
      1856,
      1887,
      1889,
      1890,
      1891,
      1892
    ]
  },
  "timeline_lookup": [
    [
      1,
      2640
    ],
    [
      9,
      2639
    ],
    [
      10,
      2638
    ],
    [
      11,
      2637
    ],
    [
      15,
      2631
    ],
    [
      17,
      2625
    ]
  ],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Production optimizations",
  "id": 601,
  "title": "Production optimizations",
  "posts_count": 21,
  "created_at": "2018-07-30T21:18:56.894Z",
  "views": 6473,
  "reply_count": 14,
  "like_count": 6,
  "last_posted_at": "2018-08-15T04:47:23.743Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "production-optimizations",
  "category_id": 7,
  "word_count": 4920,
  "deleted_at": null,
  "user_id": 311,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_601",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 21,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 311,
        "username": "ThomasJ",
        "name": "Thomas Johson",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 81,
        "username": "ryanworl",
        "name": "Ryan Worl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "post_count": 5,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 255,
        "username": "aqua",
        "name": "Matt Lohier",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 311,
      "username": "ThomasJ",
      "name": "Thomas Johson",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png"
    },
    "last_poster": {
      "id": 311,
      "username": "ThomasJ",
      "name": "Thomas Johson",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520",
        "title": "Cluster tuning cookbook",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 55,
        "user_id": 13,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520/7",
        "title": "Cluster tuning cookbook",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 17,
        "user_id": 311,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://github.com/apple/foundationdb/issues/552",
        "title": "Storage Server recruitment should consider existing recruited roles \u00b7 Issue #552 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 16,
        "user_id": 13,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://apple.github.io/foundationdb/configuration.html#guidelines-process-class-config",
        "title": "Configuration \u2014 FoundationDB 5.2",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 311,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://apple.github.io/foundationdb/configuration.html#guidelines-for-setting-process-class",
        "title": "Configuration \u2014 FoundationDB 5.2",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 311,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://cloud.google.com/compute/docs/disks/performance",
        "title": "Optimizing Persistent Disk and Local SSD Performance \u00a0|\u00a0 Compute Engine Documentation \u00a0|\u00a0 Google Cloud",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 311,
        "domain": "cloud.google.com",
        "root_domain": "google.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/warning-a-single-process-is-both-a-transaction-log-and-a-storage-server/1529/2",
        "title": "WARNING A single process is both a transaction log and a storage server",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 2,
        "user_id": 13,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/how-to-spin-up-foundationdb-cluster-in-aws/1198/2",
        "title": "How to spin up foundationdb cluster in aws",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 1,
        "user_id": 13,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}