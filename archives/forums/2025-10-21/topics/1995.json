{
  "post_stream": {
    "posts": [
      {
        "id": 6385,
        "name": "Aayushi Malik",
        "username": "aymalik",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png",
        "created_at": "2020-03-02T10:49:07.008Z",
        "cooked": "<p>Hi there,</p>\n<p>I noticed that the Record Layer planner performs a full range scan where it isn\u2019t required.<br>\nA record of type R with primary key k was queried using the query below.</p>\n<pre><code>  RecordQuery.newBuilder()\n      .setRecordType(\"R\")\n      .setSort(Key.Expressions.field(\"k\"),true)\n      .build();\n</code></pre>\n<p>The query plan was then found to be:</p>\n<pre><code>  Query Plan: Scan(&lt;,&gt;) | [R]\n</code></pre>\n<p>However, a more optimal plan would be:</p>\n<pre><code>  Query Plan: [IS R]\n</code></pre>\n<p>Note that  k is a primary key exclusively for record type R and no other record type, yet the planner scans all records instead of scanning only those record types that have k as their primary key.</p>\n<p>Also, this issue is similar to <a href=\"https://github.com/FoundationDB/fdb-record-layer/issues/744\" rel=\"nofollow noopener\">this one</a> yet I\u2019m adding this here to highlight the fact that the issue persists even when recordType() is not concatenated in the primary key.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2020-03-02T10:49:07.008Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 36,
        "reads": 28,
        "readers_count": 27,
        "score": 200.6,
        "yours": false,
        "topic_id": 1995,
        "topic_slug": "full-range-scan-performed-in-sort-when-not-required",
        "display_username": "Aayushi Malik",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/issues/744",
            "internal": false,
            "reflection": false,
            "title": "Record Type comparison not included as able to satisfy a sort \u00b7 Issue #744 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 3
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 737,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/full-range-scan-performed-in-sort-when-not-required/1995/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 6391,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2020-03-02T17:15:43.630Z",
        "cooked": "<p>Got it. This does look like it\u2019s highly related to that other issue. I\u2019ll add this to that one.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2020-03-02T17:15:43.630Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 28,
        "readers_count": 27,
        "score": 10.6,
        "yours": false,
        "topic_id": 1995,
        "topic_slug": "full-range-scan-performed-in-sort-when-not-required",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/full-range-scan-performed-in-sort-when-not-required/1995/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6392,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2020-03-02T17:17:23.034Z",
        "cooked": "<p>Interestingly, that issue suggests that the plan that should be produced for that scan is actually an <em>error</em>:</p>\n<blockquote>\n<p>Note that if one includes the record type key in the sort predicate, then it will do a full scan. If one omits the record type key (which it should be able to), then it throws an error.</p>\n</blockquote>\n<p>Not sure what the discrepancy is from.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2020-03-02T17:17:23.034Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 28,
        "readers_count": 27,
        "score": 15.6,
        "yours": false,
        "topic_id": 1995,
        "topic_slug": "full-range-scan-performed-in-sort-when-not-required",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 8,
          "username": "alloc",
          "name": "Alec Grieser",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/full-range-scan-performed-in-sort-when-not-required/1995/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6402,
        "name": "Aayushi Malik",
        "username": "aymalik",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png",
        "created_at": "2020-03-03T10:16:53.281Z",
        "cooked": "<p>Thanks for your response. I think this discrepancy stems from the fact that in one case the primary key has recordType() concatenated in it and in the other it doesn\u2019t.</p>\n<p>When the primary key has recordType() concatenated, it throws an error when recordType() is omitted in the sort expression as it isn\u2019t able to map the sort expression to any index/primary key.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2020-03-03T10:16:53.281Z",
        "reply_count": 0,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 25,
        "readers_count": 24,
        "score": 5.0,
        "yours": false,
        "topic_id": 1995,
        "topic_slug": "full-range-scan-performed-in-sort-when-not-required",
        "display_username": "Aayushi Malik",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 8,
          "username": "alloc",
          "name": "Alec Grieser",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 737,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/full-range-scan-performed-in-sort-when-not-required/1995/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      6385,
      6391,
      6392,
      6402
    ]
  },
  "timeline_lookup": [
    [
      1,
      2059
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Full range scan performed in sort when not required",
  "id": 1995,
  "title": "Full range scan performed in sort when not required",
  "posts_count": 4,
  "created_at": "2020-03-02T10:49:06.926Z",
  "views": 987,
  "reply_count": 2,
  "like_count": 1,
  "last_posted_at": "2020-03-03T10:16:53.281Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "full-range-scan-performed-in-sort-when-not-required",
  "category_id": 12,
  "word_count": 295,
  "deleted_at": null,
  "user_id": 737,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1995",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 4,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 2,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Number types in Tuples may not be null | Reverse scan",
      "id": 1912,
      "title": "Number types in Tuples may not be null | Reverse scan",
      "slug": "number-types-in-tuples-may-not-be-null-reverse-scan",
      "posts_count": 4,
      "reply_count": 2,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2020-01-27T13:38:56.010Z",
      "last_posted_at": "2020-02-20T14:50:37.088Z",
      "bumped": true,
      "bumped_at": "2020-02-20T14:50:37.088Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 992,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 653,
            "username": "VibhutiD",
            "name": "Vibhuti Dembi",
            "avatar_template": "/user_avatar/forums.foundationdb.org/vibhutid/{size}/668_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Range scan not being truncated by primary key filter when an additional Or component present in And component",
      "id": 1996,
      "title": "Range scan not being truncated by primary key filter when an additional Or component present in And component",
      "slug": "range-scan-not-being-truncated-by-primary-key-filter-when-an-additional-or-component-present-in-and-component",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2020-03-02T12:25:09.669Z",
      "last_posted_at": "2020-03-03T10:11:33.746Z",
      "bumped": true,
      "bumped_at": "2020-03-03T10:11:33.746Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 640,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 737,
            "username": "aymalik",
            "name": "Aayushi Malik",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Split long record causes conflict with other record",
      "id": 2160,
      "title": "Split long record causes conflict with other record",
      "slug": "split-long-record-causes-conflict-with-other-record",
      "posts_count": 4,
      "reply_count": 2,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2020-06-04T05:04:39.122Z",
      "last_posted_at": "2020-06-10T18:04:42.683Z",
      "bumped": true,
      "bumped_at": "2020-06-10T18:04:42.683Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 3,
      "views": 932,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 775,
            "username": "iamquang95",
            "name": "Quang Le Hong",
            "avatar_template": "/user_avatar/forums.foundationdb.org/iamquang95/{size}/889_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Mixed ascending/descending sort?",
      "id": 1582,
      "title": "Mixed ascending/descending sort?",
      "slug": "mixed-ascending-descending-sort",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2019-08-12T21:35:24.255Z",
      "last_posted_at": "2019-08-12T23:19:20.337Z",
      "bumped": true,
      "bumped_at": "2019-08-12T23:19:20.337Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1070,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 173,
            "username": "jkominek",
            "name": "Jay Kominek",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jkominek/{size}/140_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "FunctionKeyExpression is not honored when evaluating the QueryPlan",
      "id": 1937,
      "title": "FunctionKeyExpression is not honored when evaluating the QueryPlan",
      "slug": "functionkeyexpression-is-not-honored-when-evaluating-the-queryplan",
      "posts_count": 9,
      "reply_count": 5,
      "highest_post_number": 9,
      "image_url": null,
      "created_at": "2020-02-11T14:48:22.721Z",
      "last_posted_at": "2020-03-04T06:45:04.928Z",
      "bumped": true,
      "bumped_at": "2020-03-04T06:45:04.928Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 960,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 712,
            "username": "rahul-nitkkr",
            "name": "Rahul Roy",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rahul-nitkkr/{size}/754_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 34,
            "username": "scgray",
            "name": "Scott Gray",
            "avatar_template": "/user_avatar/forums.foundationdb.org/scgray/{size}/30_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 219,
            "username": "MMcM",
            "name": "Mike McMahon",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 653,
            "username": "VibhutiD",
            "name": "Vibhuti Dembi",
            "avatar_template": "/user_avatar/forums.foundationdb.org/vibhutid/{size}/668_2.png",
            "trust_level": 1
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 8,
        "username": "alloc",
        "name": "Alec Grieser",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 737,
        "username": "aymalik",
        "name": "Aayushi Malik",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 737,
      "username": "aymalik",
      "name": "Aayushi Malik",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png"
    },
    "last_poster": {
      "id": 737,
      "username": "aymalik",
      "name": "Aayushi Malik",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/aca169/{size}.png"
    },
    "links": [
      {
        "url": "https://github.com/FoundationDB/fdb-record-layer/issues/744",
        "title": "Record Type comparison not included as able to satisfy a sort \u00b7 Issue #744 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 737,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}