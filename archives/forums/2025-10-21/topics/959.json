{
  "post_stream": {
    "posts": [
      {
        "id": 2875,
        "name": "Adam Kocoloski",
        "username": "kocolosk",
        "avatar_template": "/user_avatar/forums.foundationdb.org/kocolosk/{size}/412_2.png",
        "created_at": "2018-12-13T23:01:25.218Z",
        "cooked": "<p>Hi folks, I\u2019ve been digesting the region configuration docs and am hoping to check my understanding. How would you recommend configuring an FDB cluster to achieve the following?</p>\n<ol>\n<li>synchronous replication of transaction logs to two nearby \u201cfault domains\u201d</li>\n<li>asynchronous replication to a distant \u201cfault domain\u201d</li>\n<li>local replicas of each key in three nearby \u201cfault domains\u201d</li>\n<li>at least one replica in the distant \u201cfault domain\u201d</li>\n</ol>\n<p>I\u2019m specifically using \u201cfault domain\u201d here because I think I might be struggling a bit with the semantics of regions, datacenters, and data halls and the way those map to concepts in public cloud infrastructure. The example given in the docs covers requirements 1, 2, and 4, but then we bump into the fact that there can only be one primary datacenter in a region. If that datacenter fails then we need to failover the entire region.</p>\n<p>The documentation suggests to map \u201cdatacenter\u201d to \u201cavailability zone\u201d in cloud infrastructure, but what about treating an AZ as a data hall? It seems to me that this would allow something like</p>\n<ul>\n<li>configure each region with one datacenter</li>\n<li>use <code>three_data_hall</code> redundancy with the AZ as <code>locality_data_hall</code>\n</li>\n<li>omit the <code>satellite_redundancy_mode</code> setting altogether</li>\n</ul>\n<p>which would hit all 4 requirements. Does that make sense? Or is it a design point of FoundationDB\u2019s region support saying \u201cif an availability zone fails, we\u2019re getting the heck out of the region ASAP\u201d</p>\n<p>One other related question: is it possible to set a different redundancy mode in the \u201cbackup\u201d region\u2019s primary datacenter? I see some reference in the code to parameters like <code>remote_redundancy_mode</code>; is that relevant here?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2018-12-13T23:01:25.218Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 277,
        "reads": 83,
        "readers_count": 82,
        "score": 1396.6,
        "yours": false,
        "topic_id": 959,
        "topic_slug": "multi-region-configuration-spreading-copies-inside-a-region-across-azs",
        "display_username": "Adam Kocoloski",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/help-converting-cloud-az-region-requirements-to-region-dc-setup/3898",
            "internal": true,
            "reflection": true,
            "title": "Help converting cloud AZ & Region requirements to Region & DC setup?",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 423,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/multi-region-configuration-spreading-copies-inside-a-region-across-azs/959/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 2878,
        "name": "Evan Tschannen",
        "username": "Evan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
        "created_at": "2018-12-14T23:12:25.133Z",
        "cooked": "<p>This setup does make sense, and should work.</p>\n<p>As you were saying, in your region configuration you would have two regions each with only one datacenter. Processes within those two regions all have the same \u201cdatacenter\u201d, however you give them a different \u201cdata_hall\u201d based on their availability zone.</p>\n<p>It is currently not possible to have different numbers of replicas in each region. This is something that should be supported when we implement generic region configurations.</p>\n<p>One huge warning is that the simulator does not currently test this configuration. I can try testing this setup if you are going to deploy using this configuration.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2018-12-14T23:12:57.986Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 76,
        "readers_count": 75,
        "score": 35.2,
        "yours": false,
        "topic_id": 959,
        "topic_slug": "multi-region-configuration-spreading-copies-inside-a-region-across-azs",
        "display_username": "Evan Tschannen",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 54,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/multi-region-configuration-spreading-copies-inside-a-region-across-azs/959/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2880,
        "name": "Adam Kocoloski",
        "username": "kocolosk",
        "avatar_template": "/user_avatar/forums.foundationdb.org/kocolosk/{size}/412_2.png",
        "created_at": "2018-12-15T00:23:05.532Z",
        "cooked": "<p>OK got it, thanks Evan.</p>\n<p>Fixing the number of replicas to be the same in both regions is fine for now. Does it specifically mean that we would need to run <code>three_data_hall</code> in both regions in this case?</p>\n<p>On the simulation front \u2026 is it just the combination of <code>three_data_hall</code> and multi-region that is not tested? At the moment I would say this seems like an attractive option for us, although the fact that it wasn\u2019t already in the simulator makes me wonder if I\u2019m missing a downside <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=6\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"> We\u2019re still in the design phase at the moment but will definitely keep this detail in mind as we get closer to deployment.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2018-12-15T00:23:05.532Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 74,
        "readers_count": 73,
        "score": 29.8,
        "yours": false,
        "topic_id": 959,
        "topic_slug": "multi-region-configuration-spreading-copies-inside-a-region-across-azs",
        "display_username": "Adam Kocoloski",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 423,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/multi-region-configuration-spreading-copies-inside-a-region-across-azs/959/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2886,
        "name": null,
        "username": "num",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/db5fbb/{size}.png",
        "created_at": "2018-12-18T13:38:00.340Z",
        "cooked": "<p>Evan, could you please add this configuration (<code>three_data_hall</code> + multi-region) to simulator?</p>\n<p>Since <code>three_datacenter</code> redundancy mode is <a href=\"https://apple.github.io/foundationdb/configuration.html?highlight=configuration#choosing-a-redundancy-mode\" rel=\"nofollow noopener\">not compatible</a> with region configuration, this would be a good configuration for our deployment since it allows using 3 availability zones as \u201cdata halls\u201d using <code>three_data_hall</code> redundancy mode and another region with the same setup as a backup with automatic failover.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 4,
        "updated_at": "2018-12-18T13:38:00.340Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 70,
        "readers_count": 69,
        "score": 19.0,
        "yours": false,
        "topic_id": 959,
        "topic_slug": "multi-region-configuration-spreading-copies-inside-a-region-across-azs",
        "display_username": null,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/configuration.html?highlight=configuration#choosing-a-redundancy-mode",
            "internal": false,
            "reflection": false,
            "title": "Configuration \u2014 FoundationDB 6.0",
            "clicks": 17
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 378,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/multi-region-configuration-spreading-copies-inside-a-region-across-azs/959/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      2875,
      2878,
      2880,
      2886
    ]
  },
  "timeline_lookup": [
    [
      1,
      2504
    ],
    [
      2,
      2503
    ],
    [
      4,
      2499
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Multi-region configuration - spreading copies inside a region across AZs",
  "id": 959,
  "title": "Multi-region configuration - spreading copies inside a region across AZs",
  "posts_count": 4,
  "created_at": "2018-12-13T23:01:25.118Z",
  "views": 1469,
  "reply_count": 0,
  "like_count": 0,
  "last_posted_at": "2018-12-18T13:38:00.340Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "multi-region-configuration-spreading-copies-inside-a-region-across-azs",
  "category_id": 7,
  "word_count": 558,
  "deleted_at": null,
  "user_id": 423,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_959",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 4,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 3,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Evenly split replicas across datacenters",
      "id": 1522,
      "title": "Evenly split replicas across datacenters",
      "slug": "evenly-split-replicas-across-datacenters",
      "posts_count": 4,
      "reply_count": 1,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2019-07-16T08:17:58.120Z",
      "last_posted_at": "2019-07-19T02:26:53.342Z",
      "bumped": true,
      "bumped_at": "2019-07-19T02:26:53.342Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 559,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 542,
            "username": "jonahwest",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/90db22/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Replication method consideration",
      "id": 1410,
      "title": "Replication method consideration",
      "slug": "replication-method-consideration",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2019-05-30T12:13:55.382Z",
      "last_posted_at": "2019-05-31T00:39:24.107Z",
      "bumped": true,
      "bumped_at": "2019-05-31T00:39:24.107Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 792,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 595,
            "username": "Choboz",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/c/65b543/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Help converting cloud AZ &amp; Region requirements to Region &amp; DC setup?",
      "id": 3898,
      "title": "Help converting cloud AZ & Region requirements to Region & DC setup?",
      "slug": "help-converting-cloud-az-region-requirements-to-region-dc-setup",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2023-04-10T15:00:24.699Z",
      "last_posted_at": "2023-04-10T16:01:05.179Z",
      "bumped": true,
      "bumped_at": "2023-04-10T16:01:05.179Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 339,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest single",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 1237,
            "username": "danthegoodman",
            "name": "Dan Goodman",
            "avatar_template": "/user_avatar/forums.foundationdb.org/danthegoodman/{size}/1567_2.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "How to Configure region&rsquo;s in FoundationDB?",
      "id": 1691,
      "title": "How to Configure region's in FoundationDB?",
      "slug": "how-to-configure-regions-in-foundationdb",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2019-10-22T13:51:23.037Z",
      "last_posted_at": "2019-10-24T01:35:30.162Z",
      "bumped": true,
      "bumped_at": "2019-10-24T01:35:30.162Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1604,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 650,
            "username": "Karthikn6793",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/karthikn6793/{size}/748_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Cross Datacenter/Region?",
      "id": 186,
      "title": "Cross Datacenter/Region?",
      "slug": "cross-datacenter-region",
      "posts_count": 10,
      "reply_count": 3,
      "highest_post_number": 10,
      "image_url": null,
      "created_at": "2018-04-21T18:09:15.229Z",
      "last_posted_at": "2018-06-14T19:55:13.933Z",
      "bumped": true,
      "bumped_at": "2018-06-14T19:55:13.933Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 3406,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 130,
            "username": "aphistic",
            "name": "Erik Davidson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/aphistic/{size}/90_2.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 183,
            "username": "tylerchr",
            "name": "Tyler",
            "avatar_template": "/user_avatar/forums.foundationdb.org/tylerchr/{size}/143_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 423,
        "username": "kocolosk",
        "name": "Adam Kocoloski",
        "avatar_template": "/user_avatar/forums.foundationdb.org/kocolosk/{size}/412_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 54,
        "username": "Evan",
        "name": "Evan Tschannen",
        "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "moderator": true,
        "trust_level": 1
      },
      {
        "id": 378,
        "username": "num",
        "name": null,
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/db5fbb/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 423,
      "username": "kocolosk",
      "name": "Adam Kocoloski",
      "avatar_template": "/user_avatar/forums.foundationdb.org/kocolosk/{size}/412_2.png"
    },
    "last_poster": {
      "id": 378,
      "username": "num",
      "name": null,
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/db5fbb/{size}.png"
    },
    "links": [
      {
        "url": "https://apple.github.io/foundationdb/configuration.html?highlight=configuration#choosing-a-redundancy-mode",
        "title": "Configuration \u2014 FoundationDB 6.0",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 17,
        "user_id": 378,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://forums.foundationdb.org/t/help-converting-cloud-az-region-requirements-to-region-dc-setup/3898",
        "title": "Help converting cloud AZ & Region requirements to Region & DC setup?",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 1,
        "user_id": 1237,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}