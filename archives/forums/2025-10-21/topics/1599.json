{
  "post_stream": {
    "posts": [
      {
        "id": 4977,
        "name": "Mikael Rapp ",
        "username": "Zatte",
        "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png",
        "created_at": "2019-08-28T14:21:46.582Z",
        "cooked": "<p>Hi,</p>\n<p>Has there been any thoughts/experiments of having a more standardized RPC (such as gRPC) over the current specialized c-bindings? I can see this being both a layer/gateway but also something that could potentially fit into the core(?).</p>\n<p>I\u2019m a little curios to develop a POC gateway but before walking down such a path I wanted to check if there is any prior work or knowledge to either build on or disqualify such an initiative (I know close 0 zero about the internal logic of the c-bindings).</p>\n<p>Background: As a go-developer I\u2019m not a big fan of depending on cgo <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-28T14:21:46.582Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 284,
        "reads": 67,
        "readers_count": 66,
        "score": 1440.4,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Mikael Rapp ",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 339,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 4979,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2019-08-28T15:45:08.756Z",
        "cooked": "<p>One of the major changes in FoundationDB 6.2 is that we now use <a href=\"https://google.github.io/flatbuffers/\" rel=\"nofollow noopener\">FlatBuffers</a> as a serialization protocol. This would make an effort to reimplement the c client a bit easier\u2026</p>\n<p>That being said, writing your own client won\u2019t be trivial. Our client contains a lot of logic and we rely on the fact that we can control the client (for example for load balancing). Some things in the c client are highly non-trivial (the <code>ReadYourWritesTransaction</code> implementation in the client is one of the most complex parts within fdb).</p>\n<p>Because of this I wouldn\u2019t recommend writing your own Go-client. Getting it correct will be a lot of work and it will be very hard and maintenance will be a lot of work.</p>\n<p>That being said, I think we should eventually have some form of proxy that exposes a simple interface against which one can program. This can already be done as a layer (the document layer exposes a different network protocol). An alternative would be to have this maintained by fdb itself which might make things easier (however, it is not clear how service discovery would work in that case).</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-28T15:45:08.756Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 66,
        "readers_count": 65,
        "score": 23.2,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://google.github.io/flatbuffers/",
            "internal": false,
            "reflection": false,
            "title": "FlatBuffers: FlatBuffers",
            "clicks": 22
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4980,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-08-28T15:46:39.159Z",
        "cooked": "<p>There is also some related discussion <a href=\"https://forums.foundationdb.org/t/how-difficult-would-it-be-to-implement-the-wire-protocol-in-other-languages/69\">here</a>, if you\u2019re interested.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-28T15:46:39.159Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 63,
        "readers_count": 62,
        "score": 22.6,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/how-difficult-would-it-be-to-implement-the-wire-protocol-in-other-languages/69",
            "internal": true,
            "reflection": false,
            "title": "How difficult would it be to implement the wire protocol in other languages?",
            "clicks": 39
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4986,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-08-28T21:13:52.900Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"2\" data-topic=\"1599\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>One of the major changes in FoundationDB 6.2 is that we now use <a href=\"https://google.github.io/flatbuffers/\">FlatBuffers </a> as a serialization protocol. This would make an effort to reimplement the c client a bit easier\u2026</p>\n</blockquote>\n</aside>\n<p>We make arbitrary changes to the wire protocol without documenting what they are and don\u2019t maintain backwards compatilibity for them.  I\u2019m not sure using flatbuffers actually represents a meaningful improvement here, as we\u2019re not even offering flatbuffer IDL files that other folk could import.</p>\n<p>Having a piece of FDB act as a known endpoint that speaks a known protocol has been discussed as a future direction of <a href=\"https://github.com/apple/foundationdb/issues/1938\" class=\"inline-onebox\">Add support for \"Read Proxy\" role \u00b7 Issue #1938 \u00b7 apple/foundationdb \u00b7 GitHub</a> , so the idea is vaguely on our radar.  If you\u2019re interested in doing work towards that goal, then please go raise your hand and/or begin writing a design doc on the bug.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-28T21:13:52.900Z",
        "reply_count": 2,
        "reply_to_post_number": 2,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 56,
        "readers_count": 55,
        "score": 31.2,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/issues/1938",
            "internal": false,
            "reflection": false,
            "title": "Add support for \"Read Proxy\" role \u00b7 Issue #1938 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 13
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4988,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2019-08-28T23:58:44.890Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"4\" data-topic=\"1599\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>I\u2019m not sure using flatbuffers actually represents a meaningful improvement here, as we\u2019re not even offering flatbuffer IDL files that other folk could import.</p>\n</blockquote>\n</aside>\n<p>It would be fairly easy to autogenerate the IDLs\u2026 We (Snowflake) will also try to keep some amount of backwards compatibility (so that newer clients will work with older servers up to a certain version) and we\u2019ll propose patches if we find issues with that.</p>\n<p>But all that said: I think this is all kind of irrelevant. The client logic is way to complex to make a reimplementation in every supported language feasible.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-28T23:58:44.890Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 56,
        "readers_count": 55,
        "score": 11.2,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4989,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2019-08-29T04:38:35.945Z",
        "cooked": "<p>One could also probably front FDB with a gRPC service that exposed something similar to the functions in our C API (probably using gRPC streams to correspond to transaction \u201csessions\u201d, with the first operation in the stream also beginning the transaction, and a stream closure aborting any uncommitted work). Then this could be fronted with a standard load balancer and connected to in all of the \u201cstandard\u201d ways with URLs/VIPs. (One could even add authentication at this layer and/or restrict operations to certain key ranges based on the authenticated user.)</p>\n<p>In my mind, the gRPC servers use the existing C API (either though <code>libfdb_c</code> if implemented as a separate service, say, or through the <code>NativeAPI</code> directly if they are just other processes in the cluster) to handle all communication with the existing set of processes, but then they use gRPC to talk to clients. (Between Flatbuffers or Protobuf as the interchange format for gRPC I have no opinion.)</p>\n<p>If one is willing to do some amount of work on the client side, one could probably take our existing bindings and make an API compatible thing that talked to this gRPC service instead of directly to the (current) FDB processes. This is getting somewhat in the weeds, but one problem I\u2019ve often come across when thinking about this problem is what to do about the \u201cset\u201d operation, which the bindings assume are non-blocking. I think for that, one could (in the client) create a \u201cclient request queue\u201d, and operations like <code>set</code> would simply enqueue a request, and operations like <code>get</code>, which demand RYW, would wait for all outstanding set operations to complete.</p>\n<p>But before one embarked on this project, I think it would be important to have a clear idea why. (Your scientists were so preoccupied with whether or not they could, they never stopped to think about whether or not they should!) The most tangible benefit (IMO) would be that now as clients are using a protocol with a backwards compatibility story, client and server versions are no longer intertwined (ideally with tests to prove it). The other benefit would be that you no longer need to distribute a random C library, but can instead rely on the gRPC client libraries for most languages (which actually wraps a C library for some languages and reimplements everything for other languages), and connecting to a cluster looks a lot more like connecting to other services, which might be advantageous. The cost is an extra network hop, and also the complexity of getting client/server interactions right and monitoring these extra processes or the extra service. But this approach, unlike the ones outlined above, doesn\u2019t require changing FDB\u2019s server-to-server protocol (or requiring it to be backwards compatible), and it doesn\u2019t require a rewrite of RYW or the other complex things the client currently does.</p>\n<p>So, I don\u2019t know. I\u2019m somewhat ambivalent about this idea, as there are probably complexities I haven\u2019t thought of. But I think something like it could be made to work.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-08-29T04:39:36.829Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 56,
        "readers_count": 55,
        "score": 31.2,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5002,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-09-02T07:43:10.183Z",
        "cooked": "<p>FWIW, we\u2019ve written a \u201cstorage server\u201d that implements a gRPC K/V service. As a quick summary of what we have:</p>\n<ul>\n<li>The main endpoint that we offer on the gRPC server is a bi-directional stream called RunTransaction - keeping the stream open corresponds to a single open FDB transaction.</li>\n<li>On the RunTransaction bi-di stream clients can MultiGet/RangeGet/MultiPut/MultiDelete key/value pairs and the server will return responses along the stream.</li>\n<li>All of the fancy FDB client logic (i.e. RYW, retry detection, etc) happens on the gRPC server.</li>\n<li>The gRPC service is a very thin wrapper around FDB APIs and so has the same limitations: 5 second transaction duration, simple K/V API, etc\u2026</li>\n</ul>\n<p>The big two main reasons for wrapping FDB in the storage server is:</p>\n<ol>\n<li>We wanted to keep all of the \u201cstateful\u201d parts of our system contained within the storage servers. We can then schedule the storage server as a Kubernetes StatefulSet, and make all client microservices simple ReplicaSets. All of the messiness with syncing cluster files and connecting to IP addresses (instead of hostnames) goes away for clients.</li>\n<li>We write most of our microservices in Go, and so eliminating the cgo dependency meant that cross-compiling and developing across OS was much simpler (we target the cloud and also smaller ARM64 devices).</li>\n</ol>\n<p>The downside is that it\u2019s not as performant, but for us the simplicity in operation is well-worth any performance hits.</p>\n<p>I would love to open source our work here, but it\u2019s probably a bit early to do so\u2026 Happy to talk about our experiences here though!</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-09-02T07:43:10.183Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 47,
        "readers_count": 46,
        "score": 11.4,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5022,
        "name": "Mikael Rapp ",
        "username": "Zatte",
        "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png",
        "created_at": "2019-09-04T15:18:18.823Z",
        "cooked": "<p>Thanks for great feedback. Key takeaways; 1) there seems to be a few initiatives towards this goal but none public or completed;  2) there seem to be no known blockers (except maybe complexity for a full replacement).</p>\n<p>I\u2019m 100% on board the idea of wrapping the c-lib (not replacing it) and maintaining the state on a gateway.</p>\n<p>Advantages i see in having an (g)RPC gateway.</p>\n<ol>\n<li>No C-dependency (easier build systems / get started)</li>\n<li>Lightweight client Libs</li>\n<li>Forward &amp; Backward API stability</li>\n<li>Easier mocking / testing.</li>\n<li>Front the cluster with a public proxy that supports authentication. GPRC also makes switching between test/stage/prod env as easy as changing a url+credentials.</li>\n<li>I\u2019m not a fan of the clusters-file for service discovery; this complexity should be hidden to consumers (imo). The cluster file also assumes that all clients reside in a trusted environment, which I think this is a sane design decision and delimitation but it doesn\u2019t fit all deployment scenarios for which a proxy/gateway can be helpful.</li>\n<li>If the API aligns somewhat with existing KV protocols stores it might increase adoption</li>\n</ol>\n<p>To me this is a layer very close to the core which can easily be extended in itself.</p>\n<p><a class=\"mention\" href=\"/u/jared2501\">@jared2501</a> This is exactly what I had in mind :). Care to share some insights on the \u201cnot as performant\u201d part? I would expect the extra roundtrips to add (some) delay but not limit throughput. If you don\u2019t want to share the code, would you maybe share the proto-file(s) as a starting off point?</p>\n<p>Edit: Clarified <span class=\"hashtag\">#6</span></p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-09-04T18:44:48.199Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 43,
        "readers_count": 42,
        "score": 28.6,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Mikael Rapp ",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 339,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5023,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-09-04T16:17:17.493Z",
        "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"Zatte\" data-post=\"8\" data-topic=\"1599\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/zatte/48/344_2.png\" class=\"avatar\"> Zatte:</div>\n<blockquote>\n<ul>\n<li>Front the cluster with a public proxy that supports authentication. GPRC also makes switching between test/stage/prod env as easy as changing a url+credentials.</li>\n<li>I\u2019m not a fan of the clusters-file for service discovery; this complexity should be hidden to consumers (imo). The cluster file also assumes that all clients reside in a trusted environment (design decision) which is not always optimal.</li>\n</ul>\n</blockquote>\n</aside>\n<p>Just for a little context about these design decisions, one of the main principals laid out for FoundationDB was that the surface of the core key-value store should be reasonably small with many of these types of features delegated out to layers (such as an RPC KV layer). There\u2019s a little written about this <a href=\"https://apple.github.io/foundationdb/layer-concept.html\">here</a>.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-09-04T16:17:17.493Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 40,
        "readers_count": 39,
        "score": 23.0,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/layer-concept.html",
            "internal": false,
            "reflection": false,
            "title": "Layer Concept \u2014 FoundationDB 6.1",
            "clicks": 10
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5024,
        "name": "Mikael Rapp ",
        "username": "Zatte",
        "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png",
        "created_at": "2019-09-04T18:40:07.534Z",
        "cooked": "<p>Yes; sorry for being vague, i totally agree with that separation and the overall design decision/priorities of fdb; will rephrase to clarify that is complicates usage in some cases <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=9\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-09-04T18:40:07.534Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 38,
        "readers_count": 37,
        "score": 17.6,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Mikael Rapp ",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 339,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5026,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-09-05T05:22:17.587Z",
        "cooked": "<p>Yeah the main issue is around extra round trips, I would agree it doesn\u2019t reduce throughput. One thing to note is that the APIs are pretty tricky to design - the FDB bindings/APIs do a very good job at streaming data so that nodes don\u2019t OOM, talking to the minimum amount of nodes, etc. Designing this into the gRPC APIs is tricky and we make a few trade-offs to simplify (i.e. we don\u2019t stream back range requests, etc).</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 11,
        "updated_at": "2019-09-05T05:22:17.587Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 39,
        "readers_count": 38,
        "score": 12.8,
        "yours": false,
        "topic_id": 1599,
        "topic_slug": "grpc-binding-gateway",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/grpc-binding-gateway/1599/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      4977,
      4979,
      4980,
      4986,
      4988,
      4989,
      5002,
      5022,
      5023,
      5024,
      5026
    ]
  },
  "timeline_lookup": [
    [
      1,
      2246
    ],
    [
      7,
      2242
    ],
    [
      8,
      2239
    ]
  ],
  "suggested_topics": [],
  "tags": [
    "bindings"
  ],
  "tags_descriptions": {},
  "fancy_title": "gRPC binding / gateway",
  "id": 1599,
  "title": "gRPC binding / gateway",
  "posts_count": 11,
  "created_at": "2019-08-28T14:21:46.509Z",
  "views": 2275,
  "reply_count": 5,
  "like_count": 1,
  "last_posted_at": "2019-09-05T05:22:17.587Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "grpc-binding-gateway",
  "category_id": 9,
  "word_count": 1907,
  "deleted_at": null,
  "user_id": 339,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1599",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 11,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 6,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "How difficult would it be to implement the wire protocol in other languages?",
      "id": 69,
      "title": "How difficult would it be to implement the wire protocol in other languages?",
      "slug": "how-difficult-would-it-be-to-implement-the-wire-protocol-in-other-languages",
      "posts_count": 13,
      "reply_count": 5,
      "highest_post_number": 13,
      "image_url": null,
      "created_at": "2018-04-19T20:07:03.609Z",
      "last_posted_at": "2019-12-05T21:56:33.981Z",
      "bumped": true,
      "bumped_at": "2019-12-05T21:56:33.981Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 27,
      "views": 4551,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 44,
            "username": "cespare",
            "name": "Caleb Spare",
            "avatar_template": "/user_avatar/forums.foundationdb.org/cespare/{size}/36_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 120,
            "username": "josephg",
            "name": "Seph Gentle",
            "avatar_template": "/user_avatar/forums.foundationdb.org/josephg/{size}/84_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 38,
            "username": "panghy",
            "name": "Clement Pang",
            "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Current status of gRPC bindings?",
      "id": 2742,
      "title": "Current status of gRPC bindings?",
      "slug": "current-status-of-grpc-bindings",
      "posts_count": 6,
      "reply_count": 4,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2021-06-11T02:05:08.197Z",
      "last_posted_at": "2021-06-17T14:28:48.565Z",
      "bumped": true,
      "bumped_at": "2021-06-17T14:28:48.565Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 507,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 946,
            "username": "rajivr",
            "name": "Rajiv M Ranganath",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 534,
            "username": "PierreZ",
            "name": "Pierre Zemb",
            "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Lionrock: A gRPC Facade for FoundationDB and more",
      "id": 2786,
      "title": "Lionrock: A gRPC Facade for FoundationDB and more",
      "slug": "lionrock-a-grpc-facade-for-foundationdb-and-more",
      "posts_count": 8,
      "reply_count": 0,
      "highest_post_number": 8,
      "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/2X/6/68980634f6c5f94b30ac528f6809da676e790dcd_2_1024x512.png",
      "created_at": "2021-07-12T23:12:58.968Z",
      "last_posted_at": "2021-07-29T08:33:41.156Z",
      "bumped": true,
      "bumped_at": "2021-07-29T08:33:41.156Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings"
      ],
      "tags_descriptions": {},
      "like_count": 17,
      "views": 1573,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 38,
            "username": "panghy",
            "name": "Clement Pang",
            "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 534,
            "username": "PierreZ",
            "name": "Pierre Zemb",
            "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "RPC Layer Requirements and Design",
      "id": 1817,
      "title": "RPC Layer Requirements and Design",
      "slug": "rpc-layer-requirements-and-design",
      "posts_count": 8,
      "reply_count": 2,
      "highest_post_number": 8,
      "image_url": null,
      "created_at": "2019-12-05T21:53:12.450Z",
      "last_posted_at": "2020-08-24T16:26:28.945Z",
      "bumped": true,
      "bumped_at": "2020-08-24T16:26:28.945Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 1293,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 545,
            "username": "rishabh",
            "name": "Rishabh",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rishabh/{size}/540_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 467,
            "username": "jugaadi",
            "name": "Jugaadi",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jugaadi/{size}/477_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 481,
            "username": "mikerhodes",
            "name": "Mike Rhodes",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mikerhodes/{size}/480_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 393,
            "username": "ex3ndr",
            "name": "Steve Korshakov",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ex3ndr/{size}/389_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "How to scale foundation db reads",
      "id": 1108,
      "title": "How to scale foundation db reads",
      "slug": "how-to-scale-foundation-db-reads",
      "posts_count": 21,
      "reply_count": 13,
      "highest_post_number": 21,
      "image_url": null,
      "created_at": "2019-02-02T12:39:23.370Z",
      "last_posted_at": "2019-03-18T16:32:32.430Z",
      "bumped": true,
      "bumped_at": "2019-03-18T16:32:32.430Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 7,
      "views": 6504,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 504,
            "username": "preslavle",
            "name": "Preslav Le",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/9de0a6/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 337,
            "username": "mengxu",
            "name": "Meng Xu",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
            "trust_level": 2
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 339,
        "username": "Zatte",
        "name": "Mikael Rapp ",
        "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 15,
        "username": "markus.pilman",
        "name": "Markus Pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 260,
        "username": "jared2501",
        "name": "Jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 8,
        "username": "alloc",
        "name": "Alec Grieser",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 339,
      "username": "Zatte",
      "name": "Mikael Rapp ",
      "avatar_template": "/user_avatar/forums.foundationdb.org/zatte/{size}/344_2.png"
    },
    "last_poster": {
      "id": 260,
      "username": "jared2501",
      "name": "Jared2501",
      "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/how-difficult-would-it-be-to-implement-the-wire-protocol-in-other-languages/69",
        "title": "How difficult would it be to implement the wire protocol in other languages?",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 39,
        "user_id": 12,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://google.github.io/flatbuffers/",
        "title": "FlatBuffers: FlatBuffers",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 22,
        "user_id": 15,
        "domain": "google.github.io",
        "root_domain": "google.github.io"
      },
      {
        "url": "https://github.com/apple/foundationdb/issues/1938",
        "title": "Add support for \"Read Proxy\" role \u00b7 Issue #1938 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 13,
        "user_id": 13,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://apple.github.io/foundationdb/layer-concept.html",
        "title": "Layer Concept \u2014 FoundationDB 6.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 10,
        "user_id": 12,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      }
    ]
  },
  "bookmarks": []
}