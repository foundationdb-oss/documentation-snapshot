{
  "post_stream": {
    "posts": [
      {
        "id": 4308,
        "name": "",
        "username": "rayjcwu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "created_at": "2019-06-10T10:09:55.891Z",
        "cooked": "<p>My setting is 5 * i3.8xlarge for triple redundancy foundationDB cluster, each node has 32 fdbserver processes running. In total there are 10 logs, 3 resolvers, 10 proxies. Have 3 * c5.2x as API servers. My client program\u2019s traffic is about PUT:GET ~= 40:1 ratio with other expiration logic, keys are 50 bytes and values are 7 KB.</p>\n<p>During performance testing, in the beginning it could support &gt; 30K/s PUT for hours, all queue size are low all the time and no durability lag. But later throughput dropped below 6K/s for unknown reasons. After the performance degraded, with &lt; 6K/s of traffic, both log queue size and storage queue size could reach thresholds within few minutes. Even if I pause the client program and let cluster catch up, after resuming it, it fills up queue size within few minutes again. At the meantime, none of the log/storage processes are maxing out CPU.</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/9c9854ce87e53265f75154876f180812ee93f8ec.png\" alt=\"15%20AM\" width=\"505\" height=\"273\"></p>\n<p>I think there might be info in those <code>.xml</code> logs, but I\u2019m clueless on what kind of <code>&lt;Event&gt;</code> to look at.</p>\n<p>Also with &gt; 100 storage processes, there are 2 storage processes having <code>durability_lag</code> &gt; 500s, where for others it\u2019s only &lt; 100s (also bad I know). How do I let the workload distribute evenly for all storage processes?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-11T17:19:52.173Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 602,
        "reads": 107,
        "readers_count": 106,
        "score": 3021.4,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/understand-fdb-read-write-with-disk-iops-throughtput-blocksize/3852",
            "internal": true,
            "reflection": true,
            "title": "Understand FDB read/write with disk IOPS/throughtput/Blocksize",
            "clicks": 0
          },
          {
            "url": "https://forums.foundationdb.org/t/is-there-some-guide-manual-for-a-reasonable-way-to-deployment-topology/2778/3",
            "internal": true,
            "reflection": true,
            "title": "Is there some guide manual for a reasonable way to deployment topology \uff1f",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 597,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 4318,
        "name": "Meng Xu",
        "username": "mengxu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "created_at": "2019-06-11T12:45:44.058Z",
        "cooked": "<p>My guess is that the background data movement among storage servers causes the throughput degradation.</p>\n<p>It is likely that the 2 storage process that have high durability_lag hold too much data and is busy moving data to other storage processes. You can check the trace event<br>\n\u201cBgDDMountainChopper\u201d and \u201cBgDDValleyFiller\u201d for evidence:</p>\n<blockquote>\n<p>TraceEvent(priority == PRIORITY_REBALANCE_OVERUTILIZED_TEAM ? \u201cBgDDMountainChopper\u201d : \u201cBgDDValleyFiller\u201d, self-&gt;distributorId)</p>\n<pre><code>                .detail(\"SourceBytes\", sourceBytes)\n\n                .detail(\"DestBytes\", destBytes)\n\n                .detail(\"ShardBytes\", metrics.bytes)\n\n                .detail(\"SourceTeam\", sourceTeam-&gt;getDesc())\n\n                .detail(\"DestTeam\", destTeam-&gt;getDesc());\n</code></pre>\n</blockquote>\n<p>The problem can be caused by client\u2019s write pattern:<br>\nFor example, if a client writes data in increasing order of the keys, it will keeps putting pressure on one set (i.e., team) of storage servers.</p>\n<p>To avoid the above problem, the client should write data to different key spaces concurrently.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-11T12:45:44.058Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 100,
        "readers_count": 99,
        "score": 75.0,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Meng Xu",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 337,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4319,
        "name": "",
        "username": "rayjcwu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "created_at": "2019-06-11T18:53:27.878Z",
        "cooked": "<p>Hi <a class=\"mention\" href=\"/u/mengxu\">@mengxu</a>, thanks for your reply. I looked at the trace events for that lagging process, it doesn\u2019t have \u201cBgDDMountainChopper\u201d nor \u201cBgDDValleyFiller\u201d event at all. If I filter on <code>Severity=\"20\"</code>, these are all existing event types <code>FetchPast</code>, <code>N2_ReadError</code>, <code>N2_ReadProbeError</code>, <code>ShardServerFutureVersion1000x</code>, <code>SlowSSLoopx100</code>, `StorageServerUpdateLag,.</p>\n<p>To provide more context, we implemented expiry logic mainly based on this <a href=\"https://forums.foundationdb.org/t/designing-an-expiring-key-value-store/758/2\">approach</a>, but have 4 different kind of auxiliary keys. During performance testing, even though all keys generated from the client side are totally random, on API side we add 4 static prefixes. Would that be the reason the workload tends to fall on a few storage processes because all keys have only a few common prefixes? (Is there a trace event to see what (key, value) get routed to which process?)</p>\n<p>iostat output:  (we combine 4 physical ssds by RAID 0 and mount it as md0)</p>\n<pre><code class=\"lang-auto\">ubuntu@dev-ray-trb-fdb087.us-e:/dev$ iostat --human\nLinux 4.15.0-1021-aws (dev-ray-trb-fdb087) \t06/11/19 \t_x86_64_\t(32 CPU)\n\navg-cpu:  %user   %nice %system %iowait  %steal   %idle\n          24.9%    0.0%   14.6%    0.1%    0.0%   60.3%\n\nDevice             tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn\nloop0             0.02         0.0k         0.0k      10.5M       0.0k\nloop1             0.01         0.0k         0.0k       3.5M       0.0k\nloop2             0.03         0.0k         0.0k      12.3M       0.0k\nloop3             0.01         0.0k         0.0k       3.7M       0.0k\nxvda              0.57         1.2k        12.4k     457.9M       4.8G\nnvme0n1       33641.35        54.4M       161.2M      21.0T      62.3T\nnvme1n1       33486.13        54.2M       156.9M      21.0T      60.7T\nnvme2n1       33335.21        54.1M       150.0M      20.9T      58.0T\nnvme3n1       33238.43        54.0M       150.0M      20.9T      58.0T\nmd0           210527.52       216.7M       619.0M      83.8T     239.4T\n</code></pre>\n<p>If above is true, do you have other suggestion to implement expiry logic in FoundationDB?</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-11T20:20:26.374Z",
        "reply_count": 2,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 96,
        "readers_count": 95,
        "score": 74.2,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/designing-an-expiring-key-value-store/758/2",
            "internal": true,
            "reflection": false,
            "title": "Designing an expiring key/value store",
            "clicks": 4
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 337,
          "username": "mengxu",
          "name": "Meng Xu",
          "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 597,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4324,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-06-12T15:22:57.141Z",
        "cooked": "<p>From the information you\u2019ve provided so far, it may be the case that you are saturating the disks on your storage servers. Do you have any external evidence that could support or contradict that idea?</p>\n<p>Based on the numbers you\u2019ve provided (30K/s PUTs of size 7050 bytes, triple redundancy), you would be writing something like 211 MB/s logical and at least 633 MB/s physical. It sounds like you have all 32 processes on a host sharing the same striped volume, in which case there may be some inefficiencies being introduced there. For example, we recommend that the logs do not share disks with the storage servers, as they have rather different write patterns with the logs fsyncing frequently. Also, with only 20 disks, the 211 MB/s logical write rate seems higher than I would have initially thought to be sustainable.</p>\n<p>Besides trying to rearrange things a little more efficiently (e.g. by separating the logs, as described above), I think the only real recourse if you are disk bound is to either reduce your write rate or add more disks.</p>\n<p>As a side note, you mentioned that you were able to achieve a high rate for a while but eventually slowed down. We\u2019ve seen similar behavior from SSDs before where the rates may decrease after a long time running or as they get fuller. How full are your disks now?</p>\n<p>Another side note \u2013 it looks like the i3.8xlarge instances have 32 vCPUs, or 16 physical CPUs. Although it sounds like you aren\u2019t currently CPU bound, we do also recommend that each process in a cluster gets a physical core (or at least something relatively close to that). If you try to run 1 process per logical core, you may find as the cluster gets a little busier CPU-wise (say around 50% on average) that processes start getting starved, and the stability of the cluster can be greatly affected. Depending on the severity of the starvation, this is a situation that may not be handled particularly gracefully by the cluster.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T15:22:57.141Z",
        "reply_count": 0,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 89,
        "readers_count": 88,
        "score": 47.8,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 597,
          "username": "rayjcwu",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4326,
        "name": "Meng Xu",
        "username": "mengxu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "created_at": "2019-06-12T16:42:49.839Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"3\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p>If I filter on <code>Severity=\"20\"</code> , these are all existing event types <code>FetchPast</code> , <code>N2_ReadError</code> , <code>N2_ReadProbeError</code> , <code>ShardServerFutureVersion1000x</code> , <code>SlowSSLoopx100</code> , `StorageServerUpdateLag,.</p>\n</blockquote>\n</aside>\n<p><code>StorageServerUpdateLag </code> indicates that storage server is in e-brake, as shown in the comment above the trace event in source code:</p>\n<blockquote>\n<p>// If we are disk bound and durableVersion is very old, we need to block updates or we could run out of memory<br>\n// This is often referred to as the storage server e-brake (emergency brake)</p>\n</blockquote>\n<p>Since you are running on EBS, it is possible that your VM runs out of IOPS?</p>\n<p><a class=\"mention\" href=\"/u/markus.pilman\">@markus.pilman</a>  may have more insights on this topic.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T16:42:49.839Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 85,
        "readers_count": 84,
        "score": 27.0,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Meng Xu",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 337,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4327,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2019-06-12T18:10:32.010Z",
        "cooked": "<p>It does look a bit like disk saturation to me. Or in general it looks like the storage nodes are unable to write to disk quickly enough (could also be a priority issue - reads are blocking writes - which is something we see quite often and which is why we are working on the local ratekeeper).</p>\n<p>But I don\u2019t think <a class=\"mention\" href=\"/u/rayjcwu\">@rayjcwu</a> is running on EBS. I don\u2019t know what the max throughput of the ephemeral disks on these machines are (but the i3s have very very fast disks).</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T18:10:32.010Z",
        "reply_count": 0,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 84,
        "readers_count": 83,
        "score": 31.8,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 337,
          "username": "mengxu",
          "name": "Meng Xu",
          "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4329,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2019-06-12T18:51:18.331Z",
        "cooked": "<p>You definitely need more than 4 prefixes. With only 4 prefixes and triple replication, only (4 x 3 replicas) 12 storage processes (about ~10% of the processes in your case) are writing at any given time. This means one will fall behind, the shard gets split because it is too hot, the next one falls behind, etc. Also you don\u2019t get high enough queue depth to saturate the devices.</p>\n<p>I would also try out the memory engine if you are going to be rapidly deleting data after you receive it.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T18:52:34.532Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 11,
        "reads": 83,
        "readers_count": 82,
        "score": 71.6,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/reasons-for-not-collocating-tlog-and-ss-io-characteristics-of-ss/2013",
            "internal": true,
            "reflection": true,
            "title": "Reasons for not co-locating tlog and SS? IO characteristics of SS",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4330,
        "name": "bancron",
        "username": "bancron",
        "avatar_template": "/user_avatar/forums.foundationdb.org/bancron/{size}/550_2.png",
        "created_at": "2019-06-12T20:20:33.730Z",
        "cooked": "<p>I\u2019d like to make sure we\u2019re all on the same page about what a prefix is. Currently we are running tests with keys of the form <code>kXX....</code> and <code>sYY....</code> where <code>X</code> is a random ASCII letter and <code>Y</code> is a random byte. Is this only two prefixes? How many bytes does each storage process use for sharding?</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T20:20:33.730Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 79,
        "readers_count": 78,
        "score": 35.8,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "bancron",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 558,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4331,
        "name": "",
        "username": "rayjcwu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "created_at": "2019-06-12T20:37:55.205Z",
        "cooked": "<p>Thanks for the reply. We currently create a raid 0 array on all SSDs and run FoundationDB on it. In progress on changing the code to let each log/storage process run on their own disk and own physical CPU.</p>\n<blockquote>\n<p>the 211 MB/s logical write rate seems higher than I would have initially thought to be sustainable.</p>\n</blockquote>\n<p>I\u2019m actually not sure how to estimate the disks requirement to sustain our traffic.</p>\n<p>I tried something similar to <a href=\"https://forums.foundationdb.org/t/production-optimizations/601/13\">this approach</a>. In <strong>single</strong> redundancy mode, having 1 log 19 storage, log process has <code>durable_bytes.hz</code> around 75MB. Having 1 storage 19 log, storage process has <code>durable_bytes.hz</code> around 15MB. (Even though in that post it used <code>mutations</code>, but I don\u2019t know how to use that number). So in our case, the ratio of log:storage processes should be 1:5.</p>\n<p>To sustain 633MB/s physical traffic, I\u2019ll need around 10 log processes, and 50 storage processes, each with their own disk. Which means a cluster of 60 disks for <strong>triple</strong> redundancy mode.</p>\n<p>Does the above estimation look correct?</p>\n<p>However, If I use <code>dd</code> on the single disk without any other things, the write rate could be 300+MB/s (depends on the blocksize). Does that mean I am able to run more than one log/storage process per disk?</p>\n<blockquote>\n<p><code>StorageServerUpdateLag</code>  indicates that storage server is in e-brake,</p>\n</blockquote>\n<p>Thank you. By searching on GitHub repo, it\u2019s the only one e-brake event.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T20:37:55.205Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 78,
        "readers_count": 77,
        "score": 40.6,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/production-optimizations/601/13",
            "internal": true,
            "reflection": false,
            "title": "Production optimizations",
            "clicks": 3
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 597,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4332,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2019-06-12T20:37:58.301Z",
        "cooked": "<p>If the end of your key is a monotonically increasing value, and the beginning of your key only has 4 different values, your writes are all going to 4 shards. Over time those shards will be split into more shards as they grow in size and write bandwidth, but the old shards will never receive any more writes, so you\u2019re back at only 4 shards being written to.</p>\n<p>It doesn\u2019t matter if the prefix is 1 byte or 100 bytes.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T20:41:18.690Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 70,
        "readers_count": 69,
        "score": 19.0,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 558,
          "username": "bancron",
          "name": "bancron",
          "avatar_template": "/user_avatar/forums.foundationdb.org/bancron/{size}/550_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4333,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2019-06-12T20:39:53.114Z",
        "cooked": "<p>You should definitely run more than one storage process per disk. See my explanation here: <a href=\"https://forums.foundationdb.org/t/storage-queue-limiting-performance-when-initially-loading-data/1135/2\" class=\"inline-onebox\">Storage queue limiting performance when initially loading data</a></p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T20:39:53.114Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 67,
        "readers_count": 66,
        "score": 23.4,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/storage-queue-limiting-performance-when-initially-loading-data/1135/2",
            "internal": true,
            "reflection": false,
            "title": "Storage queue limiting performance when initially loading data",
            "clicks": 15
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 597,
          "username": "rayjcwu",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4334,
        "name": "bancron",
        "username": "bancron",
        "avatar_template": "/user_avatar/forums.foundationdb.org/bancron/{size}/550_2.png",
        "created_at": "2019-06-12T21:20:15.450Z",
        "cooked": "<p>The \u201cend\u201d of the key is not a monotonically increasing value; they are random apart from the 1-byte prefix. I\u2019m not sure how much of the key is the \u201cbeginning\u201d. Let me detail the exact format of the primary keys.</p>\n<ol>\n<li>\u2018k\u2019 key: <code>'k'</code> + <code>key</code> (N random bytes in [a-zA-Z])</li>\n<li>\u2018s\u2019 key: <code>'s'</code> + 2 random bytes (chosen by hash of <code>key</code>) + 4 bytes of a uint32 representing a timestamp + <code>key</code>\n</li>\n</ol>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T21:20:15.450Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 68,
        "readers_count": 67,
        "score": 28.6,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "bancron",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 558,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4335,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2019-06-12T21:34:39.942Z",
        "cooked": "<p>If you have two bytes before the timestamp and those two bytes are sufficiently distributed that does rule out the number of prefixes being the problem. I had imagined a key like this</p>\n<p><code>events/1</code><br>\n<code>events/2</code><br>\n<code>events/3</code></p>\n<p>etc.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-12T21:34:50.188Z",
        "reply_count": 0,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 70,
        "readers_count": 69,
        "score": 39.0,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 558,
          "username": "bancron",
          "name": "bancron",
          "avatar_template": "/user_avatar/forums.foundationdb.org/bancron/{size}/550_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4348,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-06-13T06:56:31.490Z",
        "cooked": "<p>Someone actually did my recommended benchmarking <img src=\"https://emoji.discourse-cdn.com/twitter/open_mouth.png?v=12\" title=\":open_mouth:\" class=\"emoji\" alt=\":open_mouth:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"9\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p>We currently create a raid 0 array on all SSDs and run FoundationDB on it</p>\n</blockquote>\n</aside>\n<p>If you are not using enterprise-grade SSDs, I think you\u2019d actually be much better off not raid 0\u2019ing your SSDs, and just running one (or more) fdbservers per disk, rather than many fdbservers for one raid0-ed disk.  When FDB calls <code>fsync</code> on a raid0 drive, it\u2019d have to fsync on all of the SSDs, so you\u2019d potentially be having every drive do O(fdbservers) fsyncs, versus O(fdbservers/disks) fsyncs if you don\u2019t raid them.  More fsyncs typically means less drive lifetime.  The enterprise-grade caveat is that the better classes of SSDs just include a large enough capacitor that they can flush out all the data if power is lost, so that they can turn <code>fsync</code>  into a no-op, and thus it doesn\u2019t matter anyway.</p>\n<p>I later re-read and saw you\u2019re running on AWS, so the disk lifetime will be of less concern to you, but I\u2019m still not sure that you\u2019ll get better behavior with raid-ing.  Either way, I\u2019ll leave the above in case anyone ever reads this with physical disks in mind.</p>\n<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"9\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p>However, If I use  <code>dd</code>  on the single disk without any other things, the write rate could be 300+MB/s (depends on the blocksize). Does that mean I am able to run more than one log/storage process per disk?</p>\n</blockquote>\n</aside>\n<p>Be careful about sharing disks between transaction logs, because they care just as much about bandwidth as they do fsync latency, and having transaction logs compete for fsyncs is much more dangerous for overall write throughput than storage servers competing for fsyncs.</p>\n<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"9\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p>To sustain 633MB/s physical traffic, I\u2019ll need around 10 log processes, and 50 storage processes, each with their own disk. Which means a cluster of 60 disks for <strong>triple</strong> redundancy mode.</p>\n<p>Does the above estimation look correct?</p>\n</blockquote>\n</aside>\n<p>Your math seems about right, except that the scaling probably isn\u2019t linear.  I\u2019ve gone and dusted off my benchmarking results database, and I had run write bandwidth tests with single replication and got:</p>\n<p>1 proxy 1 tlog = 50MB/s<br>\n3 proxy 3 tlog = 120MB/s<br>\n5 proxy 5 tlog = 170MB/s<br>\n7 proxy 7 tlog = 200MB/s</p>\n<p>For a workload that I don\u2019t remember, but was probably 100B values.</p>\n<p>Numbers irrelevant, but comes out to a quadratic regression of $-2.5 x^2 + 45. x + 7.5$ being a pretty good fit.  Your baseline is 1.5x better than mine, which\u2026 hrm.  ~10 processes hits the peak on the quadratic equation at 300MB/s.  So\u2026 it actually turns out I don\u2019t have advice for you here, because I don\u2019t have data laying around past what you can do with ~12 transaction class processes.</p>\n<p>My guess is that you\u2019ll probably fall somewhere in 10-15 logs to make it work, an equal number of proxies, and then a few more to give yourself a bit of headroom.   I am concerned though that you\u2019re pushing up against the limits of what FDB can do for write throughput right now, so if your use case is going to grow over time, you might be boxing yourself in here.  FDB scales reads <strong>much</strong> better than writes, so a 40:1 ratio favoring writes is going in the wrong way for us.</p>\n<p>FWIW, FDB6.2 will make a couple things default that resulted in a ~25% write bandwidth improvement for my tests.  You can get them now if you <code>fdbcli&gt; configure log_version:=3 log_spill:=2</code>.  But a 25% change isn\u2019t really going to make or break your use case here\u2026</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-13T06:56:31.490Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 4,
        "reads": 72,
        "readers_count": 71,
        "score": 39.4,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4377,
        "name": "",
        "username": "rayjcwu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "created_at": "2019-06-14T05:29:53.896Z",
        "cooked": "<blockquote>\n<p>My guess is that you\u2019ll probably fall somewhere in 10-15 logs to make it work</p>\n</blockquote>\n<p>I rerun the load testing with 10 * i3.16x (80 disks total) with 10 log and 70 storage processes to 15 log and 65 storage processes. On each disk there is only one log or storage process, and an extra stateless process. In total always run the same number of proxy processes as log processes and about half of the number of resolver processes.</p>\n<p>All configurations have similar results. The highest throughput I could reach is around 13K/s, there are always 2 or 3 storage queues way higher than the others. Usually one storage queue is around 900MB and one is at 1.5GB. At the same time log queues are all at 1.5GB threshold. Even if I add more disks, reaching 13 log 107 storage processes, the behavior is the same. From <a class=\"mention\" href=\"/u/mengxu\">@mengxu</a>\u2019s post I think the bottleneck is at storage processes e-brake.</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/402c969fe6a1619e9a31fad21d0a02b8fee963da.png\" alt=\"22%20PM\" data-base62-sha1=\"99I5tiqNyM4CUnTDvIwSc9PnCc2\" width=\"405\" height=\"243\"></p>\n<p><a class=\"mention\" href=\"/u/ryanworl\">@ryanworl</a>\u2019s response makes me wonder if the issue coming from our data modeling. We model our key, value with expiry by introducing 4 kinds of auxiliary keys. Majority of them are \u2018s\u2019 and \u2018k\u2019 keys since each of our logical key has these two FoundationDB keys:</p>\n<pre><code>\u2018k\u2019 key: 'k' + key (N random bytes in [a-zA-Z])\n\u2018s\u2019 key: 's' + 2 random bytes (chosen by hash of key) \n                + 4 bytes of a uint32 representing a timestamp + key\n</code></pre>\n<p>Is it because most of foundationDB keys start with \u2018k\u2019 and \u2018s\u2019 so most of the traffic fall on 2 storage processes?</p>\n<blockquote>\n<p>I am concerned though that you\u2019re pushing up against the limits of what FDB can do for write throughput right now</p>\n</blockquote>\n<p>Is this write throughput limit posted somewhere? Our traffic is around 20K/s level and expect growing over time.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T05:29:53.896Z",
        "reply_count": 2,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 65,
        "readers_count": 64,
        "score": 28.0,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 597,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4378,
        "name": "Meng Xu",
        "username": "mengxu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "created_at": "2019-06-14T07:12:23.309Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"15\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/402c969fe6a1619e9a31fad21d0a02b8fee963da.png\" alt=\"22%20PM\" width=\"405\" height=\"243\"></p>\n<p><a class=\"mention\" href=\"/u/ryanworl\">@ryanworl</a>\u2019s response makes me wonder if the issue coming from our data modeling. We model our key, value with expiry by introducing 4 kinds of auxiliary keys. Majority of them are \u2018s\u2019 and \u2018k\u2019 keys since each of our logical key has these two FoundationDB keys:</p>\n<pre><code class=\"lang-auto\">\u2018k\u2019 key: 'k' + key (N random bytes in [a-zA-Z])\n\u2018s\u2019 key: 's' + 2 random bytes (chosen by hash of key) \n                + 4 bytes of a uint32 representing a timestamp + key\n</code></pre>\n<p>Is it because most of foundationDB keys start with \u2018k\u2019 and \u2018s\u2019 so most of the traffic fall on 2 storage processes?</p>\n</blockquote>\n</aside>\n<p>Nope. The key space will be split into shards (key ranges) almost evenly based on shards\u2019 data size.<br>\nEventually, data distribution will try to make sure each storage server team has similar amount of data.<br>\nBut there is a delay.<br>\nDuring peak workload, data distribution does not have enough time and computation resource to move shards. That\u2019s why hot spot cannot be quickly mitigated.</p>\n<p>One thing I feel interesting/weird is that under triple replica, when hot spot happens on a shard, it typically causes <strong>3</strong> storage servers very busy (say high storage queue). In your figure, only 2 storage servers are busy, which makes me curious what happens to the 3rd storage server for the shard?</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T07:12:23.309Z",
        "reply_count": 1,
        "reply_to_post_number": 15,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 66,
        "readers_count": 65,
        "score": 23.2,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Meng Xu",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 337,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4381,
        "name": "",
        "username": "rayjcwu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "created_at": "2019-06-14T08:52:44.279Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"mengxu\" data-post=\"16\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/mengxu/48/893_2.png\" class=\"avatar\"> mengxu:</div>\n<blockquote>\n<p>it typically causes <strong>3</strong> storage servers very busy (say high storage queue)</p>\n</blockquote>\n</aside>\n<p>Oh yeah it\u2019s also quite common there are 3 queues very busy, but usually the third one is less than 900MB. It also reminds me when there are few huge storage queue, sometimes I could see an alert message similar to \u201csystem is behind due to IP:port is behind\u201d in \u201cfdbcli \u2014exec status\u201d, sometimes I won\u2019t see that message.</p>\n<aside class=\"quote no-group\" data-username=\"mengxu\" data-post=\"16\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/mengxu/48/893_2.png\" class=\"avatar\"> mengxu:</div>\n<blockquote>\n<p>During peak workload, data distribution does not have enough time and computation resource to move shards. That\u2019s why hot spot cannot be quickly mitigated.</p>\n</blockquote>\n</aside>\n<p>I could pause my client and cluster could catch up the huge storage queues in less than 1 minute. But when I resume my client, queue grows back to threshold within few minutes. Does that mean the traffic I set is simply too high? Is there other way to raise storage process\u2019s priority on moving data?</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T08:52:44.279Z",
        "reply_count": 2,
        "reply_to_post_number": 16,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 63,
        "readers_count": 62,
        "score": 27.6,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 597,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4384,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-06-14T15:59:01.050Z",
        "cooked": "<p>One way to see the relative load on each the storage servers is to look at the quantity of writes and reads to each. If you are generating your graphs using the status json output, this can be done by getting <code>cluster.processes.&lt;id&gt;.roles.input_bytes</code> (related to bytes written), <code>cluster.processes.&lt;id&gt;.roles.total_queries</code> (number of reads), and <code>cluster.processes.&lt;id&gt;.roles.bytes_queried</code> (bytes read). There are other metrics there too that could provide more information on other dimensions (such as number of mutations, keys read, etc.).</p>\n<p>If you are generating your graphs from the trace logs rather than status, you can also get this information from the <code>StorageMetrics</code> event. In that case, you\u2019d get the data from the <code>BytesInput</code>, <code>QueryQueue</code>, and <code>BytesQueried</code> fields, respectively.</p>\n<p>If you see that one of these metrics is notably higher on the processes where your queues get larger, it could give you an idea where to focus your efforts. If none of these metrics look any different on the processes where your queues get large, that would be interesting too.</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T15:59:01.050Z",
        "reply_count": 1,
        "reply_to_post_number": 17,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 66,
        "readers_count": 65,
        "score": 63.2,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 597,
          "username": "rayjcwu",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4385,
        "name": "Meng Xu",
        "username": "mengxu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "created_at": "2019-06-14T17:14:55.144Z",
        "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"rayjcwu\" data-post=\"17\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<blockquote>\n<p>During peak workload, data distribution does not have enough time and computation resource to move shards. That\u2019s why hot spot cannot be quickly mitigated.</p>\n</blockquote>\n<p>I could pause my client and cluster could catch up the huge storage queues in less than 1 minute. But when I resume my client, queue grows back to threshold within few minutes. Does that mean the traffic I set is simply too high? Is there other way to raise storage process\u2019s priority on moving data?</p>\n</blockquote>\n</aside>\n<p>The traffic to the 3-server team is too high. The traffic to the entire cluster may not if other storage servers are under used. To make sure all storage servers to be used, data modeling needs to spread the writes to different key spaces (or shards).</p>\n<p>As to data distribution (DD) question, the current DD moves data based on data size instead of data-access frequency. I doubt DD will help in this situation.</p>\n<p>Since <code>I could pause my client and cluster could catch up the huge storage queues in less than 1 minute.</code>, it is another evidence that the storage server simply cannot catch up with the write throughput to it.</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T17:14:55.144Z",
        "reply_count": 1,
        "reply_to_post_number": 17,
        "quote_count": 1,
        "incoming_link_count": 8,
        "reads": 66,
        "readers_count": 65,
        "score": 58.2,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Meng Xu",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 337,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 4393,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-06-14T20:08:36.654Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"rayjcwu\" data-post=\"15\" data-topic=\"1436\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/rayjcwu/48/602_2.png\" class=\"avatar\"> rayjcwu:</div>\n<blockquote>\n<p>Is it because most of foundationDB keys start with \u2018k\u2019 and \u2018s\u2019 so most of the traffic fall on 2 storage processes?</p>\n</blockquote>\n</aside>\n<p>I do also find it very suspicious that your first graph had a large number of storage servers all struggling, but your second one had only two.</p>\n<p>I don\u2019t see anyone mentioning it here, but if you\u2019re starting from an empty database, then FDB is going to have to compete with your workload to try and split your data sufficiently so that the writes are spread across the servers.</p>\n<p>Our own write bandwidth tests pre-load a large volume of data to create enough shards to distribute writes well, wait for data distribution to finish, and then run the actual write bandwidth test.</p>\n<p>KrzysFR posted an <a href=\"https://forums.foundationdb.org/t/understanding-load-balancing-between-storage-processes-under-bulk-writes/974\">example of this</a> with good stats from his tooling before.</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 36,
        "updated_at": "2019-06-14T20:09:25.236Z",
        "reply_count": 0,
        "reply_to_post_number": 15,
        "quote_count": 1,
        "incoming_link_count": 4,
        "reads": 67,
        "readers_count": 66,
        "score": 48.4,
        "yours": false,
        "topic_id": 1436,
        "topic_slug": "how-to-troubleshoot-throughput-performance-degrade",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/understanding-load-balancing-between-storage-processes-under-bulk-writes/974",
            "internal": true,
            "reflection": false,
            "title": "Understanding load balancing between storage processes under bulk writes",
            "clicks": 10
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/how-to-troubleshoot-throughput-performance-degrade/1436/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      4308,
      4318,
      4319,
      4324,
      4326,
      4327,
      4329,
      4330,
      4331,
      4332,
      4333,
      4334,
      4335,
      4348,
      4377,
      4378,
      4381,
      4384,
      4385,
      4393,
      4396,
      4398,
      4403,
      4404,
      4405,
      4451,
      4452,
      4453,
      4454,
      4458,
      4463,
      4464,
      4465,
      4470,
      4501,
      4504
    ]
  },
  "timeline_lookup": [
    [
      1,
      2326
    ],
    [
      2,
      2324
    ],
    [
      4,
      2323
    ],
    [
      15,
      2322
    ],
    [
      18,
      2321
    ],
    [
      26,
      2317
    ],
    [
      34,
      2316
    ],
    [
      35,
      2315
    ]
  ],
  "tags": [
    "performance"
  ],
  "tags_descriptions": {},
  "fancy_title": "How to troubleshoot throughput performance degrade?",
  "id": 1436,
  "title": "How to troubleshoot throughput performance degrade?",
  "posts_count": 36,
  "created_at": "2019-06-10T10:09:55.810Z",
  "views": 4377,
  "reply_count": 24,
  "like_count": 8,
  "last_posted_at": "2019-06-20T21:36:30.209Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "how-to-troubleshoot-throughput-performance-degrade",
  "category_id": 7,
  "word_count": 5728,
  "deleted_at": null,
  "user_id": 597,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": "https://global.discourse-cdn.com/foundationdb/original/1X/9c9854ce87e53265f75154876f180812ee93f8ec.png",
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1436",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 36,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 8,
  "show_read_indicator": false,
  "thumbnails": [
    {
      "max_width": null,
      "max_height": null,
      "width": 505,
      "height": 273,
      "url": "https://global.discourse-cdn.com/foundationdb/original/1X/9c9854ce87e53265f75154876f180812ee93f8ec.png"
    }
  ],
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 597,
        "username": "rayjcwu",
        "name": "",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 81,
        "username": "ryanworl",
        "name": "Ryan Worl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "post_count": 6,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 337,
        "username": "mengxu",
        "name": "Meng Xu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "post_count": 6,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 592,
        "username": "nfeinberg",
        "name": "Nicholas Feinberg",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/ba8739/{size}.png",
        "post_count": 5,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 558,
        "username": "bancron",
        "name": "bancron",
        "avatar_template": "/user_avatar/forums.foundationdb.org/bancron/{size}/550_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 15,
        "username": "markus.pilman",
        "name": "Markus Pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 597,
      "username": "rayjcwu",
      "name": "",
      "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png"
    },
    "last_poster": {
      "id": 592,
      "username": "nfeinberg",
      "name": "Nicholas Feinberg",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/ba8739/{size}.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/storage-queue-limiting-performance-when-initially-loading-data/1135/2",
        "title": "Storage queue limiting performance when initially loading data",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 15,
        "user_id": 81,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://gist.github.com/PleasingFungus/88044b7f427374f7d9c60b53cf2a6d13",
        "title": "trbbench.go \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 14,
        "user_id": 592,
        "domain": "gist.github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/understanding-load-balancing-between-storage-processes-under-bulk-writes/974",
        "title": "Understanding load balancing between storage processes under bulk writes",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 10,
        "user_id": 13,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://pastebin.com/xJkdhWkC",
        "title": "{ \"client\" : { \"cluster_file\" : { \"path\" : \"/etc/foundationdb/fdb.cluster\", \"up_ - Pastebin.com",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 597,
        "domain": "pastebin.com",
        "root_domain": "pastebin.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/designing-an-expiring-key-value-store/758/2",
        "title": "Designing an expiring key/value store",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 597,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/production-optimizations/601/13",
        "title": "Production optimizations",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 597,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}