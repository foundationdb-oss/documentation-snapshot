{
  "post_stream": {
    "posts": [
      {
        "id": 13933,
        "name": "",
        "username": "ketchup",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/k/b9e5f3/{size}.png",
        "created_at": "2024-04-11T14:09:26.163Z",
        "cooked": "<p>Hi.</p>\n<p>I\u2019m working on a project that is using FoundationDB with a workload of reasonably heavy random writes.  As such, we are using the rocksdb storage engine \u2013 the default storage engine seems to have (understandably) more difficulty with this write pattern.</p>\n<p>Other posts allude to open issues with the rocksdb storage engine.  Is there any succinct description of those issues, bugs/tickets, ideally repro steps, or anything of that sort?  We\u2019d be interested in understanding and possibly fixing those issues.  For context, some of us have prior experience developing other databases.</p>\n<p>Also, what are the differences between ssd-rocksdb-v1 and ssd-sharded-rocksdb?  I could make a guess from the code, but I\u2019m curious what specifically motivated two rocksdb storage formats.</p>\n<p>Thanks.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2024-04-11T14:09:26.163Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 247,
        "reads": 37,
        "readers_count": 36,
        "score": 1242.4,
        "yours": false,
        "topic_id": 4425,
        "topic_slug": "seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1405,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues/4425/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 13935,
        "name": "Matthew Newhook",
        "username": "newhook",
        "avatar_template": "/user_avatar/forums.foundationdb.org/newhook/{size}/1684_2.png",
        "created_at": "2024-04-11T14:15:00.572Z",
        "cooked": "<p>Did you try redwood?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2024-04-11T14:15:00.572Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 9,
        "reads": 37,
        "readers_count": 36,
        "score": 52.4,
        "yours": false,
        "topic_id": 4425,
        "topic_slug": "seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues",
        "display_username": "Matthew Newhook",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1342,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues/4425/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 13955,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2024-04-17T02:55:23.454Z",
        "cooked": "<p>I strongly suggest you try the Redwood storage engine in FDB 7.1 or later.  Snowflake uses it across its entire fleet since last year and has been using it since 2022 in production.  It has no known corruption bugs and no wrong-results or data corruptions have ever been observed.  Compared to the default engine, Redwood uses less CPU and less IO while providing lower read latency, higher read and write throughput, and faster startup.</p>\n<p>For random writes in particular, one of the issues you would hit with the default engine is that it applies version-ordered updates serially which incurs serial disk read latency when uncached records are updated.  Redwood does not have this issue because it batches commits over a version range and does a shared traversal to all update locations in parallel, minimizing tree node visits and parallelizing disk IO.</p>\n<p>Redwood is also very good at range reads and writes.  Even if your workload does not do these, FDB data movement does use them to move/copy shard replicas around within the cluster so performance is critical to fast healing times and mitigating load or space hotspots.  The disk write amplification for data movement with Redwood is ~1 and accumulates 0 compaction debt as Redwood is not an LSM.</p>\n<p>I apologize that there isn\u2019t more documentation yet on Redwood, it\u2019s been on my want-to-do list for a long time but unfortunately I\u2019ve been occupied with other projects and life things.</p>\n<p>Operationally, the most important thing to know about Redwood is that it does <em>not</em> shrink its data file, freed space is kept internally and reused when needed, so when looking at free space the metric to use in cluster status JSON or in the trace log StorageMetrics events is the \u201cavailable\u201d bytes metric, which is the sum of free space on the file system and free reusable blocks within the <code>.redwood-v1</code> data file.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 3,
        "updated_at": "2024-04-17T02:57:18.828Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 32,
        "readers_count": 31,
        "score": 51.4,
        "yours": false,
        "topic_id": 4425,
        "topic_slug": "seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues/4425/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      13933,
      13935,
      13955
    ]
  },
  "timeline_lookup": [
    [
      1,
      558
    ],
    [
      3,
      553
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Seeking to understand and fix open rocksdb storage engine issues",
  "id": 4425,
  "title": "Seeking to understand and fix open rocksdb storage engine issues",
  "posts_count": 3,
  "created_at": "2024-04-11T14:09:26.101Z",
  "views": 457,
  "reply_count": 0,
  "like_count": 1,
  "last_posted_at": "2024-04-17T02:55:23.454Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "seeking-to-understand-and-fix-open-rocksdb-storage-engine-issues",
  "category_id": 8,
  "word_count": 453,
  "deleted_at": null,
  "user_id": 1405,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_4425",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 3,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 3,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Is the rocksdb storage engine ready for production use?",
      "id": 4594,
      "title": "Is the rocksdb storage engine ready for production use?",
      "slug": "is-the-rocksdb-storage-engine-ready-for-production-use",
      "posts_count": 9,
      "reply_count": 4,
      "highest_post_number": 9,
      "image_url": null,
      "created_at": "2024-08-26T10:44:08.873Z",
      "last_posted_at": "2025-02-18T00:11:02.031Z",
      "bumped": true,
      "bumped_at": "2025-02-18T00:11:02.031Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 7,
      "views": 736,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 1460,
            "username": "ben131",
            "name": "Ben",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ben131/{size}/1847_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 1463,
            "username": "ashwini",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b5ac83/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 454,
            "username": "jzhou",
            "name": "Jingyu Zhou",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
            "admin": true,
            "moderator": true,
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Redwood Storage Engine documentation for 7.1 is missing",
      "id": 3575,
      "title": "Redwood Storage Engine documentation for 7.1 is missing",
      "slug": "redwood-storage-engine-documentation-for-7-1-is-missing",
      "posts_count": 13,
      "reply_count": 6,
      "highest_post_number": 13,
      "image_url": null,
      "created_at": "2022-10-03T17:56:11.741Z",
      "last_posted_at": "2024-02-01T00:01:10.918Z",
      "bumped": true,
      "bumped_at": "2024-02-01T00:01:10.918Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 10,
      "views": 3319,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 156,
            "username": "spullara",
            "name": "Sam Pullara",
            "avatar_template": "/user_avatar/forums.foundationdb.org/spullara/{size}/125_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 1022,
            "username": "liyyue",
            "name": "liyyue",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/54ee81/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 849,
            "username": "johscheuer",
            "name": "Johannes Scheuermann",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/f475e1/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 1342,
            "username": "newhook",
            "name": "Matthew Newhook",
            "avatar_template": "/user_avatar/forums.foundationdb.org/newhook/{size}/1684_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Redwood storage engine runs out of memory",
      "id": 3168,
      "title": "Redwood storage engine runs out of memory",
      "slug": "redwood-storage-engine-runs-out-of-memory",
      "posts_count": 12,
      "reply_count": 10,
      "highest_post_number": 12,
      "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/2X/4/48f85d738f70c67ad18b36b24437e58ff165a9df_2_1024x753.png",
      "created_at": "2022-02-14T09:36:56.126Z",
      "last_posted_at": "2022-04-05T12:28:00.744Z",
      "bumped": true,
      "bumped_at": "2022-04-05T12:28:00.744Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 1649,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 711,
            "username": "osamarin",
            "name": "Oleg Samarin",
            "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 164,
            "username": "Imperatorx",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/i/d2c977/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Discussion thread for new storage engine ideas",
      "id": 101,
      "title": "Discussion thread for new storage engine ideas",
      "slug": "discussion-thread-for-new-storage-engine-ideas",
      "posts_count": 31,
      "reply_count": 16,
      "highest_post_number": 33,
      "image_url": null,
      "created_at": "2018-04-20T06:11:56.229Z",
      "last_posted_at": "2020-02-18T21:37:22.164Z",
      "bumped": true,
      "bumped_at": "2020-02-18T21:37:22.164Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 31,
      "views": 15718,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 68,
            "username": "daverosenthal",
            "name": "Dave Rosenthal",
            "avatar_template": "/user_avatar/forums.foundationdb.org/daverosenthal/{size}/51_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 257,
            "username": "cih.y2k",
            "name": "cih.y2k",
            "avatar_template": "/user_avatar/forums.foundationdb.org/cih.y2k/{size}/423_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 419,
            "username": "doublemax",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/8e7dd6/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 1,
            "username": "davelester",
            "name": "Dave Lester",
            "avatar_template": "/user_avatar/forums.foundationdb.org/davelester/{size}/1927_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Where I can get the latest release version of FDB with redwood engine?",
      "id": 2500,
      "title": "Where I can get the latest release version of FDB with redwood engine?",
      "slug": "where-i-can-get-the-latest-release-version-of-fdb-with-redwood-engine",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2020-12-29T02:52:04.892Z",
      "last_posted_at": "2021-01-05T05:51:47.957Z",
      "bumped": true,
      "bumped_at": "2021-01-05T05:51:47.957Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 790,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 718,
            "username": "Cliicy",
            "name": "Dragon",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/c/47e85d/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 7,
        "username": "SteavedHams",
        "name": "Steve Atherton",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 1342,
        "username": "newhook",
        "name": "Matthew Newhook",
        "avatar_template": "/user_avatar/forums.foundationdb.org/newhook/{size}/1684_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 1405,
        "username": "ketchup",
        "name": "",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/k/b9e5f3/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 0
      }
    ],
    "created_by": {
      "id": 1405,
      "username": "ketchup",
      "name": "",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/k/b9e5f3/{size}.png"
    },
    "last_poster": {
      "id": 7,
      "username": "SteavedHams",
      "name": "Steve Atherton",
      "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png"
    }
  },
  "bookmarks": []
}