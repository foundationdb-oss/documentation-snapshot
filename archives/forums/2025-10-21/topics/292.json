{
  "post_stream": {
    "posts": [
      {
        "id": 656,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-04-27T16:55:36.782Z",
        "cooked": "<p>Hi,</p>\n<p>If I have to perform a really large range scan - assume few 10s of million rows from a single client, what would be the suggested mechanism without running into 5 sec transaction limit?</p>\n<p><strong>Some more details</strong></p>\n<ul>\n<li>Scan required for order of 10s of million rows - actual bytes could run into few GB.</li>\n<li>Key distribution is not precisely known in advance.</li>\n<li>Even if FDB can return so much data to the single client (concurrent) within 5 seconds, assume that the client itself cannot hold all the returned data in memory and there would apply some processing on the incoming stream. Due to amount of computation required, this processing can overflow 5 seconds.</li>\n<li>It is acceptable that client does not see any <em>new</em> data after it started the read operation.</li>\n<li>Very likely there will not be any concurrent writes to the range being read, while this range scan is going on; however, if possible, it would be preferable to not abort those concurrent write transactions if they do occur.</li>\n</ul>\n<p>Reading through the docs, it appears that I can do single reads at snapshot isolation level. Can range scans be done at snapshot isolation level as well? Would doing a range scan at snapshot isolation level meet the needs listed above? If not, then is there an alternative way to do this?</p>\n<p>\u2013<br>\nthanks,<br>\ngaurav</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-27T16:55:36.782Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1409,
        "reads": 230,
        "readers_count": 229,
        "score": 7175.0,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/range-reads-greater-and-5-sec-and-10000000-bytes/1861/2",
            "internal": true,
            "reflection": true,
            "title": "Range Reads greater and 5 sec and 10000000 bytes",
            "clicks": 13
          },
          {
            "url": "https://forums.foundationdb.org/t/transaction-is-too-old-to-perform-reads-or-be-committed-and-request-for-future-version/1857/2",
            "internal": true,
            "reflection": true,
            "title": "Transaction is too old to perform reads or be committed AND Request for future version",
            "clicks": 5
          },
          {
            "url": "https://forums.foundationdb.org/t/foundationdb-as-backend-for-janusgraph-iterate-through-all-vertices/2280/2",
            "internal": true,
            "reflection": true,
            "title": "FoundationDB as backend for JanusGraph - Iterate through all vertices",
            "clicks": 3
          },
          {
            "url": "https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183/3",
            "internal": true,
            "reflection": true,
            "title": "Scanning a large range with Locality API hangs",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 4
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 666,
        "name": "Sam Pullara",
        "username": "spullara",
        "avatar_template": "/user_avatar/forums.foundationdb.org/spullara/{size}/125_2.png",
        "created_at": "2018-04-27T19:54:38.300Z",
        "cooked": "<p>I use an iterator that chains together lots of limited size range scans in ReadTransactions. The idea is as follows:</p>\n<ul>\n<li>Create the iterator with a start and end and a max number of keys per getRange call</li>\n<li>In the constructor, async start the first range scan of up to max keys using readAsync/snapshot</li>\n<li>In the hasNext, get the already running range and start the next one using KeySelector where it starts at the key after the last key in the range you just materialized</li>\n<li>Continue until the range returned is empty</li>\n</ul>\n<p>It works well as long as you don\u2019t need consistency. If you need it to not see new writes you will have to put versionstamps or something into your key so you can skip newer versions than the one you started with.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-27T19:54:38.300Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 75,
        "reads": 224,
        "readers_count": 223,
        "score": 479.8,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Sam Pullara",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 4
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 156,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 668,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2018-04-27T20:10:53.773Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"gaurav\" data-post=\"1\" data-topic=\"292\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/g/b487fb/48.png\" class=\"avatar\"> gaurav:</div>\n<blockquote>\n<p>Key distribution is not precisely known in advance.</p>\n</blockquote>\n</aside>\n<p>I just want to add that if your processing allows parallelism then you can split the task into multiple non-overlapping ranges using the shard boundaries from <a href=\"https://apple.github.io/foundationdb/api-python.html?highlight=get_boundary_keys#fdb.locality.fdb.locality.get_boundary_keys\">get_boundary_keys</a>.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-27T20:10:53.773Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 32,
        "reads": 222,
        "readers_count": 221,
        "score": 224.4,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/api-python.html?highlight=get_boundary_keys#fdb.locality.fdb.locality.get_boundary_keys",
            "internal": false,
            "reflection": false,
            "title": "Python API \u2014 FoundationDB 5.1",
            "clicks": 88
          }
        ],
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 670,
        "name": "David Scherer",
        "username": "dave",
        "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
        "created_at": "2018-04-27T20:17:01.552Z",
        "cooked": "<p>The <a href=\"https://github.com/apple/foundationdb/blob/master/bindings/python/fdb/locality.py\" rel=\"nofollow noopener\">Python locality API implementation</a> shows another technique for doing non-isolated range scans (basically, just restart the scan when hitting the 5 second limit).</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-27T20:17:01.552Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 213,
        "readers_count": 212,
        "score": 134.6,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "David Scherer",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/master/bindings/python/fdb/locality.py",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/locality.py at master \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 114
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 7,
          "username": "SteavedHams",
          "name": "Steve Atherton",
          "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 4
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 22,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 675,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-04-28T13:59:45.769Z",
        "cooked": "<p>Thanks for all the useful suggestions! I am still just getting started with the data and consistency models here\u2026</p>\n<p>One follow up question: if I perform a range scan on a snapshot() of the database, which, if I understand correctly, disables conflict checking of any other concurrent transaction with this one, then why should 5 sec limit be enforced here?</p>\n<p>In other words, if I am using a snapshot of the database for reading ranges, I am okay letting go of the consistency guarantee. So why apply 5 sec limit which most likely is present to prevent conflicting operations?</p>\n<p>I am sure there must be something trivial that I am missing <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=5\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-28T13:59:45.769Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 14,
        "reads": 212,
        "readers_count": 211,
        "score": 117.4,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 676,
        "name": "Will Wilson",
        "username": "wwilson",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
        "created_at": "2018-04-28T14:13:32.550Z",
        "cooked": "<p>Your intuition that this doesn\u2019t seem like it should be an architectural limitation is absolutely correct.</p>\n<p>The reason read-only snapshot transactions are also bounded by the 5s limit is mostly due to the implementation of our SSD storage engine. Currently that storage engine is not in fact a multi-versioned store. It stores a single version of the database at a point more than 5 seconds in the past. MVCC of more recent versions is kept in storage server memory[1] in a data structure that <em>overlays</em> the data on disk. Periodically, the oldest versions are detached from the in-memory tree and written to disk.</p>\n<p>If someday a storage engine were written that was multi-versioned on disk, my sense is it\u2019d be relatively straightforward to support long-running read-only transactions. There\u2019s a discussion thread on new storage engine ideas here: <a href=\"https://forums.foundationdb.org/t/discussion-thread-for-new-storage-engine-ideas/101\">Discussion thread for new storage engine ideas</a></p>\n<p>[1] But note that they are fully durable due to being written to disk on the transaction logs.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-28T14:13:32.550Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 24,
        "reads": 207,
        "readers_count": 206,
        "score": 243.4,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Will Wilson",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/discussion-thread-for-new-storage-engine-ideas/101",
            "internal": true,
            "reflection": false,
            "title": "Discussion thread for new storage engine ideas",
            "clicks": 94
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 4
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 30,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 678,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-04-28T16:08:46.211Z",
        "cooked": "<p>Thanks. That explains it perfectly!</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-04-28T16:08:46.211Z",
        "reply_count": 0,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 198,
        "readers_count": 197,
        "score": 49.6,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 30,
          "username": "wwilson",
          "name": "Will Wilson",
          "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1796,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-08-04T07:46:47.106Z",
        "cooked": "<p>[UPDATE: I think that transaction_too_old is a retryable exception by default, and thus, there may not be any need for special handling]</p>\n<p>Hi, following the suggestion made by Dave, I am trying to write an async method that reads a large number of rows, and in case there is <code>too_old_transaction error</code>, a new transaction is created and the read continues.</p>\n<p>It is the responsibility of the caller to do bookkeeping of which all rows have been fetched and once the caller has all the data it can return indicating that all data has been collected.</p>\n<p>To do this I copied the method <code>runAsync</code> from <code>FDBTransaction</code> class and updated the handler (copied below).</p>\n<ol>\n<li>The <code>retryable</code> can be called multiple times (in case of retriable errors as well as in case of too old tx error.</li>\n<li>\n<code>retryable</code>  has to perform any bookkeeping and return without any error on completion.</li>\n</ol>\n<p>Could someone please review if the changes to handler are correct (and minimal)? I am closing the old transaction object in order to free up resources; is this the correct way to do so? I noticed that <code>onError</code> method does something more sophisticated (<code>transfer</code> etc.); is that needed here?</p>\n<p>Is there a better/more robust way to achieve the same?</p>\n<p>\u2013<br>\nthanks,<br>\ngaurav</p>\n<pre><code class=\"lang-auto\">    public &lt;T&gt; CompletableFuture&lt;T&gt; longMultiReadAsync(\n            final Function&lt;? super ReadTransaction, ? extends CompletableFuture&lt;T&gt;&gt; retryable, \n            Executor e) {\nfinal AtomicReference&lt;Transaction&gt; trRef = new AtomicReference&lt;&gt;(db.createTransaction(e));\nfinal AtomicReference&lt;T&gt; returnValue = new AtomicReference&lt;&gt;();\nreturn AsyncUtil.whileTrue(() -&gt; {\n    CompletableFuture&lt;T&gt; process = AsyncUtil.applySafely(retryable, trRef.get());\n\n    return AsyncUtil.composeHandleAsync(process.thenComposeAsync(returnVal -&gt;\n                    trRef.get().commit().thenApply(o -&gt; {\n                        returnValue.set(returnVal);\n                        return false;\n                    }), e),\n            (value, t) -&gt; {  // error handler\n                if (t == null) { return CompletableFuture.completedFuture(value); }\n                if (!(t instanceof RuntimeException)) { throw new CompletionException(t); }\n **                boolean handled = false;\n **                if (t instanceof FDBException) {\n **                    final int errCode = ((FDBException) t).getCode();\n **                    if (errCode == 1007) { // too old tx. just create a new tx and return\n **                        final Transaction oldTx = trRef.get();\n **                        trRef.set(db.createTransaction(e));\n **                        oldTx.close();\n **                        handled = true;\n **                    }\n **                }\n **                if (handled) {\n **                    return CompletableFuture.completedFuture(true);\n **                } else {\n                    return trRef.get().onError(t).thenApply(newTr -&gt; {\n                        trRef.set(newTr);\n                        return true;\n                    });\n                }\n            }, e);\n}, e)\n     .thenApply(o -&gt; returnValue.get())\n     .whenComplete((v, t) -&gt; trRef.get().close());\n}\n</code></pre>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2018-08-04T10:44:24.118Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 29,
        "reads": 171,
        "readers_count": 170,
        "score": 184.2,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 22,
          "username": "dave",
          "name": "David Scherer",
          "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5902,
        "name": "nischal kumar",
        "username": "nischalkumar",
        "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png",
        "created_at": "2020-01-01T10:19:43.936Z",
        "cooked": "<p>My use case is very similar to yours. Did the above code worked?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-01T10:19:43.936Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 107,
        "readers_count": 106,
        "score": 41.4,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "nischal kumar",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 695,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5905,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-01-01T11:51:53.426Z",
        "cooked": "<p>Here is the almost complete code snippet that I currently use for this purpose. It should be straight forward to extend/update it:</p>\n<pre><code class=\"lang-auto\">// input byte[] start, byte[] end, boolean reverse\nfinal AtomicReference&lt;byte[]&gt; seen = new AtomicReference&lt;&gt;(null);\n\nfdb.readAsync(tx -&gt; {\n    // DO: Set timeout, num retries on the transaction object (tx)\n    byte[] en = end;\n    byte[] st = start;\n\n    if (reverse) {\n        en = seen.get() != null ? seen.get() : end;\n    } else {\n        // Note: nextKey is merged in master branch and not present on 6.2; copy it from github\n        st = seen.get() != null ? ByteArrayUtil.nextKey(seen.get()) : start; \n    }\n\n    return AsyncUtil.forEach(\n            tx.getRange(st, en, ROW_LIMIT_UNLIMITED, reverse),\n            kv -&gt; {\n                seen.set(kv.getKey());\n                // DO: Consume the KV here...\n            });\n}, executor).join();</code></pre>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T09:35:23.013Z",
        "reply_count": 3,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 17,
        "reads": 110,
        "readers_count": 109,
        "score": 137.0,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/foundationdb-as-backend-for-janusgraph-iterate-through-all-vertices/2280/3",
            "internal": true,
            "reflection": true,
            "title": "FoundationDB as backend for JanusGraph - Iterate through all vertices",
            "clicks": 4
          },
          {
            "url": "https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183/2",
            "internal": true,
            "reflection": true,
            "title": "Scanning a large range with Locality API hangs",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 695,
          "username": "nischalkumar",
          "name": "nischal kumar",
          "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5907,
        "name": "nischal kumar",
        "username": "nischalkumar",
        "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png",
        "created_at": "2020-01-02T07:17:00.650Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/gaurav\">@gaurav</a><br>\nHow do I scale the above async iterator to fetch data under multiple transactions. As in  one transaction only 10^7 bytes can be read in 5 secs. Is there a way to read in multiple transactions. I want to read  around 100Mb of data.</p>\n<p>Is snapshot reads a possible strategy? Does foundationdb support other kinds of read-only transactions?</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T07:17:00.650Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 106,
        "readers_count": 105,
        "score": 31.2,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "nischal kumar",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 695,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5908,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-01-02T08:01:52.620Z",
        "cooked": "<p>Above code snippet along with <code>readAsync()</code> method will handle what you are asking for:</p>\n<ul>\n<li>\n<code>readAsync()</code> will retry the transaction function (in a new transaction every time) when it exceeds 5s limit.</li>\n<li>the snippet above will fetch a new range read by providing a start key that is after the last fetched.</li>\n</ul>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T09:33:44.455Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 103,
        "readers_count": 102,
        "score": 25.6,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 695,
          "username": "nischalkumar",
          "name": "nischal kumar",
          "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5909,
        "name": "nischal kumar",
        "username": "nischalkumar",
        "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png",
        "created_at": "2020-01-02T11:48:25.053Z",
        "cooked": "<p>readAsync will not split the reads across multiple transactions.</p>\n<blockquote>\n<p>Runs a function in this context that takes a read-only transaction. Depending on the type of context, this may execute the supplied function multiple times if an error is encountered. This call is non-blocking \u2013 control flow will return immediately with a  <code>CompletableFuture</code>  that will be set when the process is complete.</p>\n</blockquote>\n<p>the above strategy will fail if my data is beyond 10 MB limit. It will also fail if the range read request will genuinely take &gt; 5 sec even if you retry it multiple times.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T11:48:25.053Z",
        "reply_count": 1,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 103,
        "readers_count": 102,
        "score": 40.6,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "nischal kumar",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 695,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5910,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-01-02T12:50:44.305Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"nischalkumar\" data-post=\"13\" data-topic=\"292\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/nischalkumar/48/933_2.png\" class=\"avatar\"> nischalkumar:</div>\n<blockquote>\n<p>execute the supplied function multiple times if an error is encountered</p>\n</blockquote>\n</aside>\n<p>The quoted sentence is the key: the function will execute multiple times on errors (retryable errors).<br>\ntransaction_too_old is a retryable error.</p>\n<p>That <code>readAsync </code> method is not explicitly splitting the work in multiple transactions - it is simply retrying the logic; the snippet above (with <code>seen</code> variable) is using this fact to split the work in multiple transactions.</p>\n<p>Could you give the above snippet a try in your test/local setup and then let me know if it does not work.</p>\n<aside class=\"quote no-group\" data-username=\"nischalkumar\" data-post=\"13\" data-topic=\"292\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/nischalkumar/48/933_2.png\" class=\"avatar\"> nischalkumar:</div>\n<blockquote>\n<p>will fail if my data is beyond 10 MB limit</p>\n</blockquote>\n</aside>\n<p>Independently, 10MB limit only applies at <code>commit()</code> time; it is not applicable for reading data; one can read as much data as possible within 5s limit of a transaction.</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T12:57:37.534Z",
        "reply_count": 0,
        "reply_to_post_number": 13,
        "quote_count": 1,
        "incoming_link_count": 15,
        "reads": 104,
        "readers_count": 103,
        "score": 95.8,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5911,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-01-02T16:24:59.602Z",
        "cooked": "<p>One thing to watch out for when using the <code>transaction_too_old</code> error like this to scan a large range is that the transaction will insert a backoff delay before it retries, and I think by default this will reach up to 1 second.</p>\n<p>There are various ways to avoid this behavior. You could start a new transaction after some amount of time before 5 seconds to avoid the error, and you could even simultaneously start a new transaction to get a read version before switching (so as to hide the GRV latency).</p>\n<p>You can also manually write a retry loop and specifically check for the <code>transaction_too_old</code> error. If you get that error, then instead of calling <code>onError</code>, you can create a new transaction (or reset it, if available in your language). A quick python example to demonstrate this:</p>\n<pre><code class=\"lang-auto\">tr = db.create_transaction()\nwhile True:\n    try:\n        # do reading, break when done\n    except fdb.FDBError as e:\n        if e.code == 1007: # transaction_too_old. May also want to check whether progress was made and use the backoff if not\n            tr = db.create_transaction()\n        else:\n            tr.on_error(e).wait()</code></pre>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-02T16:24:59.602Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 100,
        "readers_count": 99,
        "score": 45.0,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5914,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-01-03T03:26:14.068Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"ajbeamon\" data-post=\"15\" data-topic=\"292\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/ajbeamon/48/13_2.png\" class=\"avatar\"> ajbeamon:</div>\n<blockquote>\n<p>One thing to watch out for when using the <code>transaction_too_old</code> error like this to scan a large range is that the transaction will insert a backoff delay before it retries,</p>\n</blockquote>\n</aside>\n<p>This is a very common issue, I suppose. Would it make sense to support transaction options to exclude certain type of error codes from back-off delay?</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-01-03T03:26:14.068Z",
        "reply_count": 0,
        "reply_to_post_number": 15,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 100,
        "readers_count": 99,
        "score": 25.0,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7355,
        "name": "Oleg Samarin",
        "username": "osamarin",
        "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
        "created_at": "2020-06-15T15:28:54.622Z",
        "cooked": "<p>I\u2019ve tried to implement large scans in parallel with LocalityUtil.getBoundaryKeys in java, but have some troubles. See more at <a href=\"https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183\" class=\"inline-onebox\">Scanning a large range with Locality API hangs</a></p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-06-15T15:28:54.622Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 89,
        "readers_count": 88,
        "score": 42.8,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Oleg Samarin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183",
            "internal": true,
            "reflection": false,
            "title": "Scanning a large range with Locality API hangs",
            "clicks": 23
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 711,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7388,
        "name": "Oleg Samarin",
        "username": "osamarin",
        "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
        "created_at": "2020-06-18T10:36:10.939Z",
        "cooked": "<p>Hi.</p>\n<p>Seems ByteArrayUtil does not have nextKey method</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-06-18T10:36:10.939Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 86,
        "readers_count": 85,
        "score": 32.2,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Oleg Samarin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 711,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7389,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-06-18T10:50:24.302Z",
        "cooked": "<p>This is probably what you are after: <a href=\"https://github.com/apple/foundationdb/blob/61fcce08cc9a894130c913ba8ca89963e93e6acc/bindings/java/src/main/com/apple/foundationdb/tuple/ByteArrayUtil.java#L364\">https://github.com/apple/foundationdb/blob/61fcce08cc9a894130c913ba8ca89963e93e6acc/bindings/java/src/main/com/apple/foundationdb/tuple/ByteArrayUtil.java#L364</a></p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-06-18T10:50:24.302Z",
        "reply_count": 1,
        "reply_to_post_number": 18,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 85,
        "readers_count": 84,
        "score": 32.0,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/61fcce08cc9a894130c913ba8ca89963e93e6acc/bindings/java/src/main/com/apple/foundationdb/tuple/ByteArrayUtil.java#L364",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/ByteArrayUtil.java at 61fcce08cc9a894130c913ba8ca89963e93e6acc \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 19
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 711,
          "username": "osamarin",
          "name": "Oleg Samarin",
          "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7390,
        "name": "Oleg Samarin",
        "username": "osamarin",
        "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
        "created_at": "2020-06-18T11:43:26.197Z",
        "cooked": "<p>Thanks, gaurav.</p>\n<p>ByteArrayUtil.keyAfter is added in fdb 7.0, but I\u2019m still using 6.2, where it does not exist.</p>\n<p>So I\u2019ve copied it from 7.0 to my code. Seems it works.</p>\n<p>Another question: I use forEachAsync instead of forEach. Does anybody ensure the strong order of calling this seen.set. Another words, is always there the biggest key in the seen?</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 35,
        "updated_at": "2020-06-18T11:43:26.197Z",
        "reply_count": 1,
        "reply_to_post_number": 19,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 87,
        "readers_count": 86,
        "score": 27.4,
        "yours": false,
        "topic_id": 292,
        "topic_slug": "large-range-scans-avoid-5s-limit",
        "display_username": "Oleg Samarin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 711,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/large-range-scans-avoid-5s-limit/292/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      656,
      666,
      668,
      670,
      675,
      676,
      678,
      1796,
      5902,
      5905,
      5907,
      5908,
      5909,
      5910,
      5911,
      5914,
      7355,
      7388,
      7389,
      7390,
      7391,
      7393,
      7396,
      7404,
      9192,
      9193,
      9194,
      9195,
      9196,
      9636,
      9637,
      9638,
      11719,
      11721,
      11722
    ]
  },
  "timeline_lookup": [
    [
      1,
      2734
    ],
    [
      5,
      2733
    ],
    [
      8,
      2636
    ],
    [
      9,
      2121
    ],
    [
      10,
      2120
    ],
    [
      13,
      2119
    ],
    [
      17,
      1954
    ],
    [
      18,
      1951
    ],
    [
      25,
      1678
    ],
    [
      30,
      1574
    ],
    [
      31,
      1573
    ],
    [
      33,
      1135
    ]
  ],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Large Range Scans - avoid 5s limit",
  "id": 292,
  "title": "Large Range Scans - avoid 5s limit",
  "posts_count": 35,
  "created_at": "2018-04-27T16:55:36.641Z",
  "views": 7854,
  "reply_count": 26,
  "like_count": 23,
  "last_posted_at": "2022-09-12T17:09:06.929Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "large-range-scans-avoid-5s-limit",
  "category_id": 7,
  "word_count": 2671,
  "deleted_at": null,
  "user_id": 166,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_292",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 36,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 3,
  "participant_count": 13,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 166,
        "username": "gaurav",
        "name": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "post_count": 13,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 711,
        "username": "osamarin",
        "name": "Oleg Samarin",
        "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 695,
        "username": "nischalkumar",
        "name": "nischal kumar",
        "avatar_template": "/user_avatar/forums.foundationdb.org/nischalkumar/{size}/933_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 15,
        "username": "markus.pilman",
        "name": "Markus Pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 534,
        "username": "PierreZ",
        "name": "Pierre Zemb",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 448,
        "username": "dongxinEric",
        "name": "Xin Dong",
        "avatar_template": "/user_avatar/forums.foundationdb.org/dongxineric/{size}/434_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 905,
        "username": "pyr",
        "name": "Pierre-Yves Ritschard",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pyr/{size}/1040_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 997,
        "username": "mping",
        "name": "Miguel Ping",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mping/{size}/1180_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 22,
        "username": "dave",
        "name": "David Scherer",
        "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 156,
        "username": "spullara",
        "name": "Sam Pullara",
        "avatar_template": "/user_avatar/forums.foundationdb.org/spullara/{size}/125_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 7,
        "username": "SteavedHams",
        "name": "Steve Atherton",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 30,
        "username": "wwilson",
        "name": "Will Wilson",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      }
    ],
    "created_by": {
      "id": 166,
      "username": "gaurav",
      "name": "gaurav",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
    },
    "last_poster": {
      "id": 997,
      "username": "mping",
      "name": "Miguel Ping",
      "avatar_template": "/user_avatar/forums.foundationdb.org/mping/{size}/1180_2.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/blob/master/bindings/python/fdb/locality.py",
        "title": "foundationdb/locality.py at master \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 114,
        "user_id": 22,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/discussion-thread-for-new-storage-engine-ideas/101",
        "title": "Discussion thread for new storage engine ideas",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 94,
        "user_id": 30,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://apple.github.io/foundationdb/api-python.html?highlight=get_boundary_keys#fdb.locality.fdb.locality.get_boundary_keys",
        "title": "Python API \u2014 FoundationDB 5.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 88,
        "user_id": 7,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://github.com/apple/foundationdb/issues/3391",
        "title": "Add an API to support splitting a given range into chunks \u00b7 Issue #3391 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 67,
        "user_id": 448,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183",
        "title": "Scanning a large range with Locality API hangs",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 23,
        "user_id": 711,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/61fcce08cc9a894130c913ba8ca89963e93e6acc/bindings/java/src/main/com/apple/foundationdb/tuple/ByteArrayUtil.java#L364",
        "title": "foundationdb/ByteArrayUtil.java at 61fcce08cc9a894130c913ba8ca89963e93e6acc \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 19,
        "user_id": 166,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/range-reads-greater-and-5-sec-and-10000000-bytes/1861/2",
        "title": "Range Reads greater and 5 sec and 10000000 bytes",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 13,
        "user_id": 695,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/transaction-is-too-old-to-perform-reads-or-be-committed-and-request-for-future-version/1857/2",
        "title": "Transaction is too old to perform reads or be committed AND Request for future version",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 5,
        "user_id": 13,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/java-concurrency-questions/1571/7",
        "title": "Java: concurrency questions",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 711,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/foundationdb-as-backend-for-janusgraph-iterate-through-all-vertices/2280/3",
        "title": "FoundationDB as backend for JanusGraph - Iterate through all vertices",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 4,
        "user_id": 799,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/foundationdb-as-backend-for-janusgraph-iterate-through-all-vertices/2280/2",
        "title": "FoundationDB as backend for JanusGraph - Iterate through all vertices",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 3,
        "user_id": 166,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/4f6054a3e6ff9321de3ff26b39b6151ada83e725/bindings/java/src/main/com/apple/foundationdb/async/AsyncUtil.java#L95",
        "title": "foundationdb/AsyncUtil.java at 4f6054a3e6ff9321de3ff26b39b6151ada83e725 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 166,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://forums.foundationdb.org/t/scanning-a-large-range-with-locality-api-hangs/2183/3",
        "title": "Scanning a large range with Locality API hangs",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 1,
        "user_id": 711,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}