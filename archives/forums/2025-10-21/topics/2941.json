{
  "post_stream": {
    "posts": [
      {
        "id": 10112,
        "name": "Petr Tich\u00fd",
        "username": "petr-tichy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/petr-tichy/{size}/1427_2.png",
        "created_at": "2021-10-12T21:17:01.195Z",
        "cooked": "<p>We are running version 6.2.30 in triple replication mode with some 2000 clients and noticed there are three (always the same process ID) storage servers allocating up to 16 GB of memory (set in config), while all the other 33 allocate 3 GB max.</p>\n<p>The memory usage increases steadily since SS start. The workload is roughly 200kHz reads, 2kHz writes. When the SS hits the 16 GB limit (about 10 minutes of work), it logs:</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"40\" Time=\"1634070280.211636\" DateTime=\"2021-10-12T20:24:40Z\" Type=\"OutOfMemory\" ID=\"0000000000000000\" Message=\"Out of memory\" Backtrace=\"addr2line -e fdbserver.debug -p -C -f -i 0x19ed48c 0x19ecc40 0x19ecd21 0x19ce95e 0x19ce98c 0x19cea09 0x19afcb3 0x19b0041 0x19a144d 0x19a18f0 0x6c2006 0x19ebda7 0x19ed576 0x19ecc40 0x19ecd21 0x19ce95e 0x19ce98c 0x19cea09 0x19afcb3 0x19b0041 0x6e3d8c 0x1938053 0x1938360 0x19387da 0x193a8e8 0x193963b 0x193af8e 0x8018f0 0x1a2b270 0x6784f9 0x7feaff0c309b\" Machine=\"10.64.3.103:4516\" LogGroup=\"default\" Roles=\"SS\" /&gt;\n</code></pre>\n<p>Is this a bug or client usage pattern issue?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2021-10-12T21:17:01.195Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 18,
        "reads": 27,
        "readers_count": 26,
        "score": 95.4,
        "yours": false,
        "topic_id": 2941,
        "topic_slug": "storage-server-out-of-memory-error",
        "display_username": "Petr Tich\u00fd",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 837,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/storage-server-out-of-memory-error/2941/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 10114,
        "name": "Petr Tich\u00fd",
        "username": "petr-tichy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/petr-tichy/{size}/1427_2.png",
        "created_at": "2021-10-13T07:37:01.456Z",
        "cooked": "<p>I tried replacing one of the failing SS and what we see is that other SS is failing with similar issue, reporting</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"40\" Time=\"1634082350.520501\" DateTime=\"2021-10-12T23:45:50Z\" Type=\"OutOfMemory\" ID=\"0000000000000000\" Message=\"Out of memory\" Backtrace=\"addr2line -e fdbserver.debug -p -C -f -i 0x19ed48c 0x19ecc40 0x19ecd21 0x19ce95e 0x19ce98c 0x19cea09 0x19afcb3 0x19b0041 0x6e3b6e 0x6e4116 0x1938053 0x1938360 0x19387da 0x193a8e8 0x193963b 0x193ab5f 0x8018f0 0x1a2b270 0x6784f9 0x7f00b758809b\" Machine=\"10.64.3.104:4516\" LogGroup=\"default\" Roles=\"SS\" /&gt;\n</code></pre>\n<p>What is strange now is that the memory used if far from the limit:</p>\n<pre><code class=\"lang-auto\">&lt;Event Severity=\"10\" Time=\"1634082348.104493\" DateTime=\"2021-10-12T23:45:48Z\" Type=\"MemoryMetrics\" ID=\"0000000000000000\" TotalMemory16=\"393216\" ApproximateUnusedMemory16=\"0\" ActiveThreads16=\"1\" TotalMemory32=\"50855936\" ApproximateUnusedMemory32=\"5898240\" ActiveThreads32=\"1\" TotalMemory64=\"137756672\" ApproximateUnusedMemory64=\"25296896\" ActiveThreads64=\"4\" TotalMemory96=\"101687040\" ApproximateUnusedMemory96=\"6027840\" ActiveThreads96=\"1\" TotalMemory128=\"524288\" ApproximateUnusedMemory128=\"131072\" ActiveThreads128=\"1\" TotalMemory256=\"79429632\" ApproximateUnusedMemory256=\"0\" ActiveThreads256=\"1\" TotalMemory512=\"393216\" ApproximateUnusedMemory512=\"0\" ActiveThreads512=\"1\" TotalMemory1024=\"131072\" ApproximateUnusedMemory1024=\"0\" ActiveThreads1024=\"1\" TotalMemory2048=\"131072\" ApproximateUnusedMemory2048=\"0\" ActiveThreads2048=\"1\" TotalMemory4096=\"2148532224\" ApproximateUnusedMemory4096=\"0\" ActiveThreads4096=\"1\" TotalMemory8192=\"4194304\" ApproximateUnusedMemory8192=\"393216\" ActiveThreads8192=\"1\" HugeArenaMemory=\"58147\" DCID=\"[not set]\" ZoneID=\"2\" MachineID=\"04\" Machine=\"10.64.3.104:4516\" LogGroup=\"default\" Roles=\"SS\" /&gt;\n&lt;Event Severity=\"10\" Time=\"1634082348.104493\" DateTime=\"2021-10-12T23:45:48Z\" Type=\"MachineMetrics\" ID=\"0000000000000000\" Elapsed=\"5.00003\" MbpsSent=\"96.9022\" MbpsReceived=\"112.815\" OutSegs=\"140224\" RetransSegs=\"38\" CPUSeconds=\"2.45425\" TotalMemory=\"67557892096\" CommittedMemory=\"34244521984\" AvailableMemory=\"33313370112\" DCID=\"[not set]\" ZoneID=\"2\" MachineID=\"04\" Machine=\"10.64.3.104:4516\" LogGroup=\"default\" Roles=\"SS\" TrackLatestType=\"Original\" /&gt;\n</code></pre>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2021-10-13T07:37:01.456Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 26,
        "readers_count": 25,
        "score": 10.2,
        "yours": false,
        "topic_id": 2941,
        "topic_slug": "storage-server-out-of-memory-error",
        "display_username": "Petr Tich\u00fd",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 837,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/storage-server-out-of-memory-error/2941/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      10112,
      10114
    ]
  },
  "timeline_lookup": [
    [
      1,
      1470
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Storage server Out of memory error",
  "id": 2941,
  "title": "Storage server Out of memory error",
  "posts_count": 2,
  "created_at": "2021-10-12T21:17:01.134Z",
  "views": 449,
  "reply_count": 0,
  "like_count": 0,
  "last_posted_at": "2021-10-13T07:37:01.456Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "storage-server-out-of-memory-error",
  "category_id": 7,
  "word_count": 409,
  "deleted_at": null,
  "user_id": 837,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2941",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 2,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 1,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "&lsquo;ERROR: Out of memory&rsquo; crashed from fdbserver",
      "id": 3556,
      "title": "'ERROR: Out of memory' crashed from fdbserver",
      "slug": "error-out-of-memory-crashed-from-fdbserver",
      "posts_count": 4,
      "reply_count": 1,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2022-09-21T17:45:03.267Z",
      "last_posted_at": "2022-09-28T06:50:59.544Z",
      "bumped": true,
      "bumped_at": "2022-09-28T06:50:59.544Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "bindings",
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 3,
      "views": 519,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 1134,
            "username": "ZhangHuiGui",
            "name": "Zhang Hui Gui",
            "avatar_template": "/user_avatar/forums.foundationdb.org/zhanghuigui/{size}/1377_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 1133,
            "username": "redcuckoo",
            "name": "Yurii Momotenko",
            "avatar_template": "/user_avatar/forums.foundationdb.org/redcuckoo/{size}/1660_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 711,
            "username": "osamarin",
            "name": "Oleg Samarin",
            "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Large spikes in memory usage on storage processes, 6.0.18",
      "id": 2115,
      "title": "Large spikes in memory usage on storage processes, 6.0.18",
      "slug": "large-spikes-in-memory-usage-on-storage-processes-6-0-18",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/4c7f8a022ee38e69df8abe772878aff823a76550_2_1024x320.png",
      "created_at": "2020-05-12T19:17:47.329Z",
      "last_posted_at": "2020-05-12T21:58:14.570Z",
      "bumped": true,
      "bumped_at": "2020-05-12T21:58:14.570Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 582,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 490,
            "username": "rjenkins",
            "name": "Ray Jenkins",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rjenkins/{size}/487_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Foundationdb 6.2 - fdbserver going out of memory",
      "id": 2080,
      "title": "Foundationdb 6.2 - fdbserver going out of memory",
      "slug": "foundationdb-6-2-fdbserver-going-out-of-memory",
      "posts_count": 10,
      "reply_count": 5,
      "highest_post_number": 10,
      "image_url": null,
      "created_at": "2020-04-20T14:55:39.274Z",
      "last_posted_at": "2020-04-23T04:34:49.858Z",
      "bumped": true,
      "bumped_at": "2020-04-23T04:34:49.858Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1037,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 714,
            "username": "tuk",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/b5ac83/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "FDB server or coordinator is down due to out of memory",
      "id": 2851,
      "title": "FDB server or coordinator is down due to out of memory",
      "slug": "fdb-server-or-coordinator-is-down-due-to-out-of-memory",
      "posts_count": 8,
      "reply_count": 0,
      "highest_post_number": 8,
      "image_url": null,
      "created_at": "2021-08-16T04:25:19.418Z",
      "last_posted_at": "2021-08-23T22:09:02.813Z",
      "bumped": true,
      "bumped_at": "2021-08-23T22:09:02.813Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 659,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 551,
            "username": "falsandtru",
            "name": null,
            "avatar_template": "/user_avatar/forums.foundationdb.org/falsandtru/{size}/546_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Mac version of FoundationDB seems unhealthy",
      "id": 624,
      "title": "Mac version of FoundationDB seems unhealthy",
      "slug": "mac-version-of-foundationdb-seems-unhealthy",
      "posts_count": 5,
      "reply_count": 2,
      "highest_post_number": 5,
      "image_url": null,
      "created_at": "2018-08-09T01:54:43.781Z",
      "last_posted_at": "2018-08-09T14:27:32.729Z",
      "bumped": true,
      "bumped_at": "2018-08-09T14:27:32.729Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1806,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 349,
            "username": "knaversr",
            "name": "rob rodgers",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/k/82dd89/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 837,
        "username": "petr-tichy",
        "name": "Petr Tich\u00fd",
        "avatar_template": "/user_avatar/forums.foundationdb.org/petr-tichy/{size}/1427_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 837,
      "username": "petr-tichy",
      "name": "Petr Tich\u00fd",
      "avatar_template": "/user_avatar/forums.foundationdb.org/petr-tichy/{size}/1427_2.png"
    },
    "last_poster": {
      "id": 837,
      "username": "petr-tichy",
      "name": "Petr Tich\u00fd",
      "avatar_template": "/user_avatar/forums.foundationdb.org/petr-tichy/{size}/1427_2.png"
    }
  },
  "bookmarks": []
}