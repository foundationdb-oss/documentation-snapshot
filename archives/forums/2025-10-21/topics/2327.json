{
  "post_stream": {
    "posts": [
      {
        "id": 7877,
        "name": "DeepikaaSubramaniam",
        "username": "dsubramaniam",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/f17d59/{size}.png",
        "created_at": "2020-09-03T04:48:25.948Z",
        "cooked": "<p>Hi,</p>\n<p>We are seeing some concerns when we scale FDB but not able to scale on throughput. We are running a 14 node cluster. 3 i3xl and 11 i34xl. the i3xl are just used to run transaction processes. Currently our workload is write heavy. When we hit 100K RPS in the cluster, the storage lag increases and cluster goes to a unhealthy state.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-03T04:48:25.948Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 456,
        "reads": 86,
        "readers_count": 85,
        "score": 2287.2,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "DeepikaaSubramaniam",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 757,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 7898,
        "name": "Alwin",
        "username": "ajames",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png",
        "created_at": "2020-09-07T18:36:20.222Z",
        "cooked": "<p>Adding some more info.</p>\n<p>Added 2 more storage nodes, now we have a 16 node FDB cluster.<br>\n3 i3.xl (Tx nodes) + 13 i3.4xl (SP nodes)</p>\n<p>FoundationDB 6.2 (v6.2.15)</p>\n<p>Configuration:<br>\nRedundancy mode        - double<br>\nStorage engine         - ssd-2<br>\nCoordinators           - 6<br>\nDesired Resolvers      - 6<br>\nDesired Logs           - 6</p>\n<p>Cluster:<br>\nFoundationDB processes - 220<br>\nZones                  - 16<br>\nMachines               - 16<br>\nMemory availability    - 7.3 GB per process on machine with least available<br>\nRetransmissions rate   - 3 Hz<br>\nFault Tolerance        - 1 machine<br>\nServer time            - 09/03/20 04:43:55</p>\n<p>Data:<br>\nReplication health     - Healthy (Repartitioning.)<br>\nMoving data            - 0.549 GB<br>\nSum of key-value sizes - 574.755 GB<br>\nDisk space used        - 7.380 TB</p>\n<p>Operating space:<br>\nStorage server         - 1182.3 GB free on most full server<br>\nLog server             - 824.9 GB free on most full server</p>\n<p>Workload:<br>\nRead rate              - 43579 Hz<br>\nWrite rate             - 95600 Hz<br>\nTransactions started   - 277 Hz<br>\nTransactions committed - 260 Hz<br>\nConflict rate          - 3 Hz<br>\nPerformance limited by process: Storage server performance (storage queue).</p>\n<p>Each i3.4xl has 12 storage processes running (6/disk), rest 4 are stateless process (3 nodes have 1 coordinators).<br>\nAll 3 i3.xl nodes run 2 Tx process each (They also have 1 coordinator + 1 stateless process running).</p>\n<p>Even with 40-50K RPS + 50-80K WPS, we see cluster going into unhealthy state. As per the FDB performance bottleneck reason, it shows - \u2018storage_server_write_queue_size\u2019<br>\nDisk busy is under 60% (fdb_cluster_processes_disk_busy). Disk reads: 3K-6K, Disk writes : 10K-30K.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44.jpeg\" data-download-href=\"/uploads/short-url/UymWm2ppmT62Gfs1XFLJ8T4S5C.jpeg?dl=1\" title=\"Screen Shot 2020-09-07 at 11.22.55 AM\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44_2_690x208.jpeg\" alt=\"Screen Shot 2020-09-07 at 11.22.55 AM\" data-base62-sha1=\"UymWm2ppmT62Gfs1XFLJ8T4S5C\" width=\"690\" height=\"208\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44_2_690x208.jpeg, https://global.discourse-cdn.com/foundationdb/optimized/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44_2_1035x312.jpeg 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44_2_1380x416.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44_2_10x10.png\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">Screen Shot 2020-09-07 at 11.22.55 AM</span><span class=\"informations\">3284\u00d7994 889 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>We do see storage process queue going up to 1GB randomly on different SPs. Does not look it is always hitting same SP or same host.<br>\n(fdb_cluster_processes_roles_storage_input_bytes_counter - fdb_cluster_processes_roles_storage_durable_bytes_counter)</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5.jpeg\" data-download-href=\"/uploads/short-url/hsp9ms2ns7xf4EvcTjMKLaDimRT.jpeg?dl=1\" title=\"Screen Shot 2020-09-07 at 11.25.27 AM\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5_2_690x217.jpeg\" alt=\"Screen Shot 2020-09-07 at 11.25.27 AM\" data-base62-sha1=\"hsp9ms2ns7xf4EvcTjMKLaDimRT\" width=\"690\" height=\"217\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5_2_690x217.jpeg, https://global.discourse-cdn.com/foundationdb/optimized/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5_2_1035x325.jpeg 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5_2_1380x434.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5_2_10x10.png\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">Screen Shot 2020-09-07 at 11.25.27 AM</span><span class=\"informations\">3284\u00d71034 615 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/0855b677977bc64a2fbccb916d324cfb2333722f.jpeg\" data-download-href=\"/uploads/short-url/1bJsqvKWIrPyNAtxvZu6uTlx6Kb.jpeg?dl=1\" title=\"Screen Shot 2020-09-07 at 11.32.56 AM\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0855b677977bc64a2fbccb916d324cfb2333722f_2_690x219.jpeg\" alt=\"Screen Shot 2020-09-07 at 11.32.56 AM\" data-base62-sha1=\"1bJsqvKWIrPyNAtxvZu6uTlx6Kb\" width=\"690\" height=\"219\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0855b677977bc64a2fbccb916d324cfb2333722f_2_690x219.jpeg, https://global.discourse-cdn.com/foundationdb/optimized/1X/0855b677977bc64a2fbccb916d324cfb2333722f_2_1035x328.jpeg 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/0855b677977bc64a2fbccb916d324cfb2333722f_2_1380x438.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/0855b677977bc64a2fbccb916d324cfb2333722f_2_10x10.png\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">Screen Shot 2020-09-07 at 11.32.56 AM</span><span class=\"informations\">3298\u00d71048 589 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>See SP CPU hitting 100%.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/c212335824da71a9fde16bfc0cc1578f96be71e2.jpeg\" data-download-href=\"/uploads/short-url/rGPCFRPbLIm6rgqeYsdwAQBZm2C.jpeg?dl=1\" title=\"Screen Shot 2020-09-07 at 11.28.54 AM\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/c212335824da71a9fde16bfc0cc1578f96be71e2_2_690x385.jpeg\" alt=\"Screen Shot 2020-09-07 at 11.28.54 AM\" data-base62-sha1=\"rGPCFRPbLIm6rgqeYsdwAQBZm2C\" width=\"690\" height=\"385\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/c212335824da71a9fde16bfc0cc1578f96be71e2_2_690x385.jpeg, https://global.discourse-cdn.com/foundationdb/optimized/1X/c212335824da71a9fde16bfc0cc1578f96be71e2_2_1035x577.jpeg 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/c212335824da71a9fde16bfc0cc1578f96be71e2_2_1380x770.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/c212335824da71a9fde16bfc0cc1578f96be71e2_2_10x10.png\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">Screen Shot 2020-09-07 at 11.28.54 AM</span><span class=\"informations\">2628\u00d71468 1.55 MB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Each write transaction has ~200 records, total Tx size is limited below 1MB.</p>\n<p>We also see fair bit of Tx conflicts.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/822617cd2a7ba2434da56b6aa95726204a18f475.jpeg\" data-download-href=\"/uploads/short-url/izlGt3N4B8kAGV77bDMPEC54xsV.jpeg?dl=1\" title=\"Screen Shot 2020-09-07 at 11.15.22 AM\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/822617cd2a7ba2434da56b6aa95726204a18f475_2_690x306.jpeg\" alt=\"Screen Shot 2020-09-07 at 11.15.22 AM\" data-base62-sha1=\"izlGt3N4B8kAGV77bDMPEC54xsV\" width=\"690\" height=\"306\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/822617cd2a7ba2434da56b6aa95726204a18f475_2_690x306.jpeg, https://global.discourse-cdn.com/foundationdb/optimized/1X/822617cd2a7ba2434da56b6aa95726204a18f475_2_1035x459.jpeg 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/822617cd2a7ba2434da56b6aa95726204a18f475_2_1380x612.jpeg 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/822617cd2a7ba2434da56b6aa95726204a18f475_2_10x10.png\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">Screen Shot 2020-09-07 at 11.15.22 AM</span><span class=\"informations\">3260\u00d71450 714 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Initially cluster size was 6 node (3Tx+3SP), we don\u2019t see linear performance as we added 13 more SP nodes. Trying to see where the current bottleneck is. Any help is much appreciated.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-07T18:36:20.222Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 28,
        "reads": 82,
        "readers_count": 81,
        "score": 156.4,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "Alwin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/0664961913242bc5c2e0ab0958e6d9a91dddfd44.jpeg",
            "internal": false,
            "reflection": false,
            "title": "0664961913242bc5c2e0ab0958e6d9a91dddfd44.jpeg",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5.jpeg",
            "internal": false,
            "reflection": false,
            "title": "7a5af7fec1ad815da8f4fa1dab5ea59dd250d8c5.jpeg",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/0855b677977bc64a2fbccb916d324cfb2333722f.jpeg",
            "internal": false,
            "reflection": false,
            "title": "0855b677977bc64a2fbccb916d324cfb2333722f.jpeg",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/822617cd2a7ba2434da56b6aa95726204a18f475.jpeg",
            "internal": false,
            "reflection": false,
            "title": "822617cd2a7ba2434da56b6aa95726204a18f475.jpeg",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/c212335824da71a9fde16bfc0cc1578f96be71e2.jpeg",
            "internal": false,
            "reflection": false,
            "title": "c212335824da71a9fde16bfc0cc1578f96be71e2.jpeg",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 769,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7899,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2020-09-07T19:33:40.199Z",
        "cooked": "<p>Can you describe the workload a bit more?</p>\n<p>The information given here says each record is around 5KB, which would put your total write bandwidth at 80000*5000b, or 400MB/s (800MB/s with double replication).</p>\n<p>It looks like you\u2019ve got 156 storage processes in this cluster.</p>\n<p>If the workload was perfectly evenly distributed, you\u2019re writing over 5MB/s per storage process, which is  outside the range I would consider sustainable on the existing SSD storage engine.</p>\n<p>If your workload is not evenly distributed, which the most non-overlapping spikes in storage queue size suggest (in my opinion), you may be hot-spotting some storage servers far above that 5MB/s.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-07T19:33:40.199Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 68,
        "readers_count": 67,
        "score": 33.6,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7903,
        "name": "Alwin",
        "username": "ajames",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png",
        "created_at": "2020-09-08T23:01:36.071Z",
        "cooked": "<p>Thank You <a class=\"mention\" href=\"/u/ryanworl\">@ryanworl</a> !</p>\n<p>Yes, we have 156 storage processes running.<br>\nLooking at the actual payload (tcpdump), each record varies between 100-400 bytes.<br>\nThe key comprises of many fields and starts with ip of machine sending event.<br>\nWe also have secondary index which is based on current system timestamp. Currently we are trying to see if this is causing hotrange issues.</p>\n<p>Also, could you please explain more about</p>\n<blockquote>\n<p>you\u2019re writing over 5MB/s per storage process, which is outside the range I would consider sustainable on the existing SSD storage engine\"?</p>\n</blockquote>\n<p>What is recommended?</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-08T23:02:08.863Z",
        "reply_count": 2,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 69,
        "readers_count": 68,
        "score": 58.8,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "Alwin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 81,
          "username": "ryanworl",
          "name": "Ryan Worl",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 769,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7904,
        "name": "Ryan Worl",
        "username": "ryanworl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "created_at": "2020-09-08T23:20:24.721Z",
        "cooked": "<p>Thanks for the update.</p>\n<blockquote>\n<p>(100-400B * 80,000WPS * 2x replication) / 156 processes = 100KB/s-400KB/s / process</p>\n</blockquote>\n<p>I would say that is sustainable all other things being equal. I would target 1MB/s, so if you\u2019re doing a delete to expire that data after a period of time, your sustainable write rate is approximately 500KB/s because deleting data requires re-writing those pages.</p>\n<p>Thanks for giving more details about the workload.</p>\n<blockquote>\n<p>We also have secondary index which is based on current system timestamp. Currently we are trying to see if this is causing hotrange issues.</p>\n</blockquote>\n<p>I would guess this is the problem. If your index key something like this looks like this:</p>\n<pre><code class=\"lang-auto\">[TIMESTAMP, IP:PORT, ..., EventID] =&gt; ''\n</code></pre>\n<p>You\u2019ll be targeting approximately one shard at any given time, and your cluster will spend tons of IO on splitting the shard and copying over and over again.</p>\n<p>RocksDB is coming as a storage engine option in the future, which may make this pattern sustainable at a higher write rate, but it will never be ideal because shard splits will still take place. I wouldn\u2019t base your decision to use FDB or not for this workload based on the potential that RocksDB is available in the future though.</p>\n<p>Instead, you can add a prefix to that key, perhaps by hashing the IP address modding it by some constant to make a prefix you can scan if you know the IP address you need to query. The constant would be large enough to create enough shards to sustain your write rate. You\u2019ll still have splits occurring, just at a slower rate.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-08T23:20:24.721Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 70,
        "readers_count": 69,
        "score": 49.0,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "Ryan Worl",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 769,
          "username": "ajames",
          "name": "Alwin",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 81,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7911,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2020-09-14T12:59:06.978Z",
        "cooked": "<p>Please see <a href=\"https://forums.foundationdb.org/t/storage-server-cpu-bottleneck-growing-data-lag/2234/2\">this</a> thread for some discussion on possible disk saturation and how to reason about it.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-14T13:40:58.561Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 65,
        "readers_count": 64,
        "score": 23.0,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/storage-server-cpu-bottleneck-growing-data-lag/2234/2",
            "internal": true,
            "reflection": false,
            "title": "Storage Server CPU bottleneck - Growing data lag",
            "clicks": 98
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 769,
          "username": "ajames",
          "name": "Alwin",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7919,
        "name": "Alwin",
        "username": "ajames",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png",
        "created_at": "2020-09-14T23:02:57.196Z",
        "cooked": "<p>Thank You <a class=\"mention\" href=\"/u/gaurav\">@gaurav</a> for the useful info.<br>\nHowever in our case, we found that the secondary index was causing hot ranges. Thank you <a class=\"mention\" href=\"/u/ryanworl\">@ryanworl</a> for pinpointing the issue.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 7,
        "updated_at": "2020-09-14T23:02:57.196Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 64,
        "readers_count": 63,
        "score": 37.8,
        "yours": false,
        "topic_id": 2327,
        "topic_slug": "scaling-issues-with-fdb-for-write-throughput",
        "display_username": "Alwin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 769,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/scaling-issues-with-fdb-for-write-throughput/2327/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      7877,
      7898,
      7899,
      7903,
      7904,
      7911,
      7919
    ]
  },
  "timeline_lookup": [
    [
      1,
      1875
    ],
    [
      2,
      1870
    ],
    [
      4,
      1869
    ],
    [
      6,
      1863
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Scaling issues with FDB for write throughput",
  "id": 2327,
  "title": "Scaling issues with FDB for write throughput",
  "posts_count": 7,
  "created_at": "2020-09-03T04:48:25.889Z",
  "views": 1866,
  "reply_count": 3,
  "like_count": 0,
  "last_posted_at": "2020-09-14T23:02:57.196Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "scaling-issues-with-fdb-for-write-throughput",
  "category_id": 17,
  "word_count": 1000,
  "deleted_at": null,
  "user_id": 757,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2327",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 7,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Storage queue limiting performance when initially loading data",
      "id": 1135,
      "title": "Storage queue limiting performance when initially loading data",
      "slug": "storage-queue-limiting-performance-when-initially-loading-data",
      "posts_count": 11,
      "reply_count": 6,
      "highest_post_number": 11,
      "image_url": null,
      "created_at": "2019-02-13T10:07:40.715Z",
      "last_posted_at": "2019-10-14T16:11:25.098Z",
      "bumped": true,
      "bumped_at": "2019-10-14T16:11:25.098Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 7,
      "views": 2780,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 509,
            "username": "qlees",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/q/ba8739/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 476,
            "username": "dch",
            "name": "Dave Cottlehuber",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dch/{size}/473_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 663,
            "username": "atul",
            "name": "Atul Gupta",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/f14d63/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "How to troubleshoot throughput performance degrade?",
      "id": 1436,
      "title": "How to troubleshoot throughput performance degrade?",
      "slug": "how-to-troubleshoot-throughput-performance-degrade",
      "posts_count": 36,
      "reply_count": 24,
      "highest_post_number": 36,
      "image_url": "https://global.discourse-cdn.com/foundationdb/original/1X/9c9854ce87e53265f75154876f180812ee93f8ec.png",
      "created_at": "2019-06-10T10:09:55.810Z",
      "last_posted_at": "2019-06-20T21:36:30.209Z",
      "bumped": true,
      "bumped_at": "2019-06-20T21:36:30.209Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 8,
      "views": 4377,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 597,
            "username": "rayjcwu",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 337,
            "username": "mengxu",
            "name": "Meng Xu",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 592,
            "username": "nfeinberg",
            "name": "Nicholas Feinberg",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/ba8739/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "FoundationdDB Cluster Performance Issues",
      "id": 2105,
      "title": "FoundationdDB Cluster Performance Issues",
      "slug": "foundationddb-cluster-performance-issues",
      "posts_count": 12,
      "reply_count": 6,
      "highest_post_number": 12,
      "image_url": null,
      "created_at": "2020-05-06T16:01:40.124Z",
      "last_posted_at": "2020-10-21T15:20:11.071Z",
      "bumped": true,
      "bumped_at": "2020-10-21T15:20:11.071Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance",
        "operator"
      ],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1317,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 744,
            "username": "v-pap",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 765,
            "username": "rbtcollins",
            "name": "Robert Collins",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rbtcollins/{size}/941_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Storage Server CPU bottleneck - Growing data lag",
      "id": 2234,
      "title": "Storage Server CPU bottleneck - Growing data lag",
      "slug": "storage-server-cpu-bottleneck-growing-data-lag",
      "posts_count": 23,
      "reply_count": 18,
      "highest_post_number": 23,
      "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/e472648513de0e881bd62213804d5e43f9510ace_2_1023x568.png",
      "created_at": "2020-07-08T13:46:58.378Z",
      "last_posted_at": "2021-12-13T09:55:15.976Z",
      "bumped": true,
      "bumped_at": "2021-12-13T10:47:15.543Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 3083,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 744,
            "username": "v-pap",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 166,
            "username": "gaurav",
            "name": "gaurav",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 711,
            "username": "osamarin",
            "name": "Oleg Samarin",
            "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Transaction/operation throughput",
      "id": 1880,
      "title": "Transaction/operation throughput",
      "slug": "transaction-operation-throughput",
      "posts_count": 11,
      "reply_count": 5,
      "highest_post_number": 11,
      "image_url": null,
      "created_at": "2020-01-14T22:48:44.649Z",
      "last_posted_at": "2020-01-23T15:09:25.796Z",
      "bumped": true,
      "bumped_at": "2020-01-23T15:09:25.796Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 2027,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 679,
            "username": "Daniel-B-Smith",
            "name": "Daniel Smith",
            "avatar_template": "/user_avatar/forums.foundationdb.org/daniel-b-smith/{size}/743_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 321,
            "username": "poma",
            "name": "Roman Semenov",
            "avatar_template": "/user_avatar/forums.foundationdb.org/poma/{size}/325_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 769,
        "username": "ajames",
        "name": "Alwin",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 81,
        "username": "ryanworl",
        "name": "Ryan Worl",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 166,
        "username": "gaurav",
        "name": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 757,
        "username": "dsubramaniam",
        "name": "DeepikaaSubramaniam",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/f17d59/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 757,
      "username": "dsubramaniam",
      "name": "DeepikaaSubramaniam",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/f17d59/{size}.png"
    },
    "last_poster": {
      "id": 769,
      "username": "ajames",
      "name": "Alwin",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/9de0a6/{size}.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/storage-server-cpu-bottleneck-growing-data-lag/2234/2",
        "title": "Storage Server CPU bottleneck - Growing data lag",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 98,
        "user_id": 166,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}