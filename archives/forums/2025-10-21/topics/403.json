{
  "post_stream": {
    "posts": [
      {
        "id": 1060,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-05-12T10:22:00.490Z",
        "cooked": "<p>It seems like void rollback( StorageServer* data, Version rollbackVersion, Version nextVersion ) in storageserver.actor.cpp would call please_reboot() which is pretty disruptive to memory storage servers (depending on storage_memory size of the node, it could take minutes to come back). The question is what triggers it?</p>\n<p>It seems like it is called in applyPrivateData() in storageserver.actor.cpp.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T10:22:00.490Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 99,
        "reads": 58,
        "readers_count": 57,
        "score": 508.6,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 1061,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-05-12T10:33:38.326Z",
        "cooked": "<p>Seems like <a href=\"https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89\" rel=\"nofollow noopener\">https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89</a> is trying to address this issue.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T10:33:38.326Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 58,
        "readers_count": 57,
        "score": 16.6,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89",
            "internal": false,
            "reflection": false,
            "title": "fix: a storage server does not ever need to rollback before a version\u2026 \u00b7 apple/foundationdb@7f72aa7 \u00b7 GitHub",
            "clicks": 16
          }
        ],
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1062,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-05-12T10:55:14.765Z",
        "cooked": "<p>Actually does it even work? Looks like the check should be on line 2307 as well no? It only prevents a trace message right now it seems.</p>\n<p>Seems fishy to me.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T10:55:14.765Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 60,
        "readers_count": 59,
        "score": 17.0,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1064,
        "name": "Evan Tschannen",
        "username": "Evan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
        "created_at": "2018-05-12T17:13:20.275Z",
        "cooked": "<p>Our storage servers pull data from the log system before we are sure all the transactions logs have gotten (and fsync\u2019ed) that data. We do this to help prevent future versions, by giving the storage servers as much time as possible to process new versions before clients can read those versions.</p>\n<p>If a storage server pulls data from the logs, and then a failure causes us to choose a recovery version less than a version the storage server has processed, we need to discard the commits. We know of on disk data is around 5 seconds old, so we rollback to that version and re-fetch everything up to the recovery version.</p>\n<p>In general the situations which cause rollbacks are very rare. All of the scenarios require different logs to end a generation at different versions. Then you need one of the logs that has a lower version than other logs to be alive during recovery. In practice this does not happen often.</p>\n<p>While a rollback is not a big problem for the ssd storage engine, it is definitely expensive for the memory storage engine. It would be difficult to completely eliminate the need for rollbacks, however one simple thing would be to choose as big of a version as possible during recovery. Currently the recovery logic chooses the smallest version possible as the recovery version because that will minimize the chance the we have to restart recovery.</p>\n<p>To change it so that it picks the biggest version just change:</p>\n<aside class=\"onebox githubblob\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/blob/release-5.2/fdbserver/TagPartitionedLogSystem.actor.cpp#L708\" target=\"_blank\" rel=\"nofollow noopener\">github.com</a>\n  </header>\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/release-5.2/fdbserver/TagPartitionedLogSystem.actor.cpp#L708\" target=\"_blank\" rel=\"nofollow noopener\">apple/foundationdb/blob/release-5.2/fdbserver/TagPartitionedLogSystem.actor.cpp#L708</a></h4>\n<pre class=\"onebox\"><code class=\"lang-cpp\"><ol class=\"start lines\" start=\"698\" style=\"counter-reset: li-counter 697 ;\">\n<li>\t\t\t//Void _ = wait( smartQuorum( tLogReply, requiredCount, SERVER_KNOBS-&gt;RECOVERY_TLOG_SMART_QUORUM_DELAY ) || rejoins );</li>\n<li>\n</li>\n<li>\t\t\tASSERT(logServers.size() == tLogReply.size());</li>\n<li>\t\t\tif (!bTooManyFailures) {</li>\n<li>\t\t\t\tstd::sort( results.begin(), results.end(), sort_by_end() );</li>\n<li>\t\t\t\tint absent = logServers.size() - results.size();</li>\n<li>\t\t\t\tint safe_range_begin = prevState.tLogWriteAntiQuorum;</li>\n<li>\t\t\t\tint new_safe_range_begin = std::min(prevState.tLogWriteAntiQuorum, (int)(results.size()-1));</li>\n<li>\t\t\t\tint safe_range_end = prevState.tLogReplicationFactor - absent;</li>\n<li>\n</li>\n<li class=\"selected\">\t\t\t\tVersion end = results[ new_safe_range_begin ].end;</li>\n<li>\t\t\t\tVersion knownCommittedVersion = end - (g_network-&gt;isSimulated() ? 10*SERVER_KNOBS-&gt;VERSIONS_PER_SECOND : SERVER_KNOBS-&gt;MAX_READ_TRANSACTION_LIFE_VERSIONS); //In simulation this must be the maximum MAX_READ_TRANSACTION_LIFE_VERSIONS</li>\n<li>\t\t\t\tfor(int i = 0; i &lt; results.size(); i++) {</li>\n<li>\t\t\t\t\tknownCommittedVersion = std::max(knownCommittedVersion, results[i].knownCommittedVersion);</li>\n<li>\t\t\t\t}</li>\n<li>\n</li>\n<li>\t\t\t\tif( ( prevState.logSystemType == 2 &amp;&amp; (!last_end.present() || ((safe_range_end &gt; 0) &amp;&amp; (safe_range_end-1 &lt; results.size()) &amp;&amp; results[ safe_range_end-1 ].end &lt; last_end.get())) ) ) {</li>\n<li>\t\t\t\t\tTEST( last_end.present() );  // Restarting recovery at an earlier point</li>\n<li>\n</li>\n<li>\t\t\t\t\tReference&lt;TagPartitionedLogSystem&gt; logSystem( new TagPartitionedLogSystem(dbgid, locality) );</li>\n<li>\n</li>\n</ol></code></pre>\n\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>to:</p>\n<p>Version end = results[ std::min(safe_range_end, (int)(results.size())) -1 ];</p>\n<p>This is completely untested, so obviously more thought and testing would be needed, but having a knob which change the behavior here seems reasonable.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T17:13:20.275Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 57,
        "readers_count": 56,
        "score": 41.4,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Evan Tschannen",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/release-5.2/fdbserver/TagPartitionedLogSystem.actor.cpp#L708",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/TagPartitionedLogSystem.actor.cpp at release-5.2 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 3
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 54,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1067,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-05-12T20:29:06.501Z",
        "cooked": "<p>Thanks <a class=\"mention\" href=\"/u/evan\">@Evan</a>, we are currently still on the 3.x code so I am mainly looking at a particular failure scenario whereby adding servers (or when role changes happen), a cluster-wide rollback is issued and all KeyValueMemoryStorage is discarded and has to be re-read from disk. I found your commit in the 5.x branch:</p>\n<p><a href=\"https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89#diff-f1e6a0ba8101b1d532e20b65c6e72f35R2257\" class=\"onebox\" target=\"_blank\" rel=\"nofollow noopener\">https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89#diff-f1e6a0ba8101b1d532e20b65c6e72f35R2257</a></p>\n<p>but the line: <code>if ( rollbackVersion &lt; fromVersion &amp;&amp; rollbackVersion &gt; restoredVersion) {</code> seems to only be applied to whether print a trace event instead of whether to actually do the rollback:</p>\n<pre><code>if ( rollbackVersion &lt; fromVersion )\n\trollback( data, rollbackVersion, currentVersion );\n</code></pre>\n<p>Now, this might not really help our situation but we do find that rollbacks are not that rare (just adding a node to the cluster can cause it to rollback and we would experience 20 minutes+ of recovery time (based on our storage_memory configuration of course). I am currently in the process of patching the 3.x codebase to see if the change would help but I realized that the change in 5.x wouldn\u2019t help either (again, it\u2019s just not doing the TraceEvent).</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T20:29:06.501Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 48,
        "readers_count": 47,
        "score": 14.6,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89#diff-f1e6a0ba8101b1d532e20b65c6e72f35R2257",
            "internal": false,
            "reflection": false,
            "title": "fix: a storage server does not ever need to rollback before a version\u2026 \u00b7 apple/foundationdb@7f72aa7 \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 54,
          "username": "Evan",
          "name": "Evan Tschannen",
          "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1068,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-05-12T20:39:18.873Z",
        "cooked": "<p>It seems to me that the commit only really prevents a rollback if the original restored version is larger than the rollback version (which seems to be a rare case to me). In any case, I did a PR <a href=\"https://github.com/apple/foundationdb/pull/385/commits\" rel=\"nofollow noopener\">https://github.com/apple/foundationdb/pull/385/commits</a> to address the fact that the original commit just addressed the trace event and not the actual rollback.</p>\n<p>I will be looking into the change you suggested.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T20:39:18.873Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 46,
        "readers_count": 45,
        "score": 9.2,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/pull/385/commits",
            "internal": false,
            "reflection": false,
            "title": "Add detail to trace event and not attempt the rollback if the ToVersion is larger than the restored version. by panghy \u00b7 Pull Request #385 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 4
          }
        ],
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1070,
        "name": "Evan Tschannen",
        "username": "Evan",
        "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
        "created_at": "2018-05-12T21:27:15.327Z",
        "cooked": "<p>I vaguely remember attempting to make the change you suggested and running into some issue. I will need to run a bunch in simulation tests on the change to see if it finds anything.</p>\n<p>My advice should still work on the 3.X codebase to reduce the number of rollbacks. You should be able to find a very similar line of code somewhere in the tag partitioned log system. You should give it a try if you have a reliable test that reproduces the scenario.</p>\n<p>A two-phase log stopping process could also be employed to add a little latency to recovery but make it much more likely all the tlogs end a generation at the same version.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-12T21:27:15.327Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 45,
        "readers_count": 44,
        "score": 24.0,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Evan Tschannen",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": true,
        "admin": false,
        "staff": true,
        "user_id": 54,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1088,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2018-05-14T15:38:40.736Z",
        "cooked": "<p>I agree the original change seems fishy. The result seems to be that in some cases we do a rollback without logging it to the trace file, which doesn\u2019t sound like what you\u2019d want. I\u2019m not actually sure why in the original version those two <code>if</code> blocks weren\u2019t unified, with the one line in between them placed before. That doesn\u2019t appear to me to change the behavior, and it prevents edits like the one that decouple the trace event from the actual rollback.</p>\n<p>I\u2019m not familiar with what issue Evan had run into applying the new condition to the second <code>if</code> block, but maybe the reason for placing it around the first block was to guard the <code>ASSERT</code>? If that\u2019s the case, though, we should probably just move the condition into the <code>ASSERT</code> argument. Evan\u2019s out for a couple weeks now, though, so we may want to wait until he returns so we can better understand what the intent was.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-05-14T15:38:40.736Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 41,
        "readers_count": 40,
        "score": 43.2,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 1971,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-08-25T00:05:00.385Z",
        "cooked": "<p>Sorry to resurrect an old flag, is there someway that we can work around rollbacks especially with the memory engine? The code implies that it\u2019s possible to do the rollback without rebooting the storage server but that the logic is cumbersome. Is there an old version of the code that has that missing piece that we could test with?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 9,
        "updated_at": "2018-08-25T00:05:00.385Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 31,
        "readers_count": 30,
        "score": 6.2,
        "yours": false,
        "topic_id": 403,
        "topic_slug": "what-triggers-a-rollback",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-triggers-a-rollback/403/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      1060,
      1061,
      1062,
      1064,
      1067,
      1068,
      1070,
      1088,
      1971
    ]
  },
  "timeline_lookup": [
    [
      1,
      2720
    ],
    [
      3,
      2719
    ],
    [
      8,
      2717
    ],
    [
      9,
      2615
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "What triggers a rollback()?",
  "id": 403,
  "title": "What triggers a rollback()?",
  "posts_count": 9,
  "created_at": "2018-05-12T10:22:00.353Z",
  "views": 1196,
  "reply_count": 1,
  "like_count": 2,
  "last_posted_at": "2018-08-25T00:05:00.385Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "what-triggers-a-rollback",
  "category_id": 5,
  "word_count": 1010,
  "deleted_at": null,
  "user_id": 38,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_403",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 9,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 3,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Is fdb&rsquo;s recovery may drop committed transaction?",
      "id": 2750,
      "title": "Is fdb's recovery may drop committed transaction?",
      "slug": "is-fdbs-recovery-may-drop-committed-transaction",
      "posts_count": 4,
      "reply_count": 2,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2021-06-13T15:14:11.611Z",
      "last_posted_at": "2021-06-30T04:33:52.036Z",
      "bumped": true,
      "bumped_at": "2021-06-30T04:33:52.036Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 679,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 948,
            "username": "ChinaXing",
            "name": "chinaxing",
            "avatar_template": "/user_avatar/forums.foundationdb.org/chinaxing/{size}/1102_2.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 337,
            "username": "mengxu",
            "name": "Meng Xu",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 454,
            "username": "jzhou",
            "name": "Jingyu Zhou",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
            "admin": true,
            "moderator": true,
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "How to prevent tlogs from overcommitting",
      "id": 695,
      "title": "How to prevent tlogs from overcommitting",
      "slug": "how-to-prevent-tlogs-from-overcommitting",
      "posts_count": 21,
      "reply_count": 4,
      "highest_post_number": 21,
      "image_url": null,
      "created_at": "2018-09-12T08:05:48.702Z",
      "last_posted_at": "2018-10-23T00:50:58.852Z",
      "bumped": true,
      "bumped_at": "2018-10-23T00:50:58.852Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 1648,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 38,
            "username": "panghy",
            "name": "Clement Pang",
            "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "About storage server&rsquo;s recovery",
      "id": 495,
      "title": "About storage server's recovery",
      "slug": "about-storage-servers-recovery",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": "https://global.discourse-cdn.com/foundationdb/original/1X/6253b6c7154b1a487afacf3fa14ab31ad5ba66ae.png",
      "created_at": "2018-06-07T10:59:00.241Z",
      "last_posted_at": "2018-06-08T06:44:22.055Z",
      "bumped": true,
      "bumped_at": "2018-06-08T06:44:22.055Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 787,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 124,
            "username": "coder0718",
            "name": "Coder0718",
            "avatar_template": "/user_avatar/forums.foundationdb.org/coder0718/{size}/87_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 54,
            "username": "Evan",
            "name": "Evan Tschannen",
            "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
            "moderator": true,
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "When and how to use please_reboot_delete",
      "id": 1262,
      "title": "When and how to use please_reboot_delete",
      "slug": "when-and-how-to-use-please-reboot-delete",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2019-03-26T20:47:18.519Z",
      "last_posted_at": "2019-03-27T23:10:01.370Z",
      "bumped": true,
      "bumped_at": "2019-03-28T05:20:27.329Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 601,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 412,
            "username": "mengranewo",
            "name": "Mengran Wang",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/8e8cbc/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Is it possible that the aborted transaction is persistent in SS?",
      "id": 3193,
      "title": "Is it possible that the aborted transaction is persistent in SS?",
      "slug": "is-it-possible-that-the-aborted-transaction-is-persistent-in-ss",
      "posts_count": 4,
      "reply_count": 2,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2022-02-28T10:17:23.531Z",
      "last_posted_at": "2022-03-04T00:52:46.885Z",
      "bumped": true,
      "bumped_at": "2022-03-04T00:52:46.885Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 447,
      "category_id": 8,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 1075,
            "username": "kof02guy",
            "name": "Kof02guy",
            "avatar_template": "/user_avatar/forums.foundationdb.org/kof02guy/{size}/1291_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 454,
            "username": "jzhou",
            "name": "Jingyu Zhou",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jzhou/{size}/445_2.png",
            "admin": true,
            "moderator": true,
            "trust_level": 2
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 38,
        "username": "panghy",
        "name": "Clement Pang",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "post_count": 6,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 54,
        "username": "Evan",
        "name": "Evan Tschannen",
        "avatar_template": "/user_avatar/forums.foundationdb.org/evan/{size}/104_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "moderator": true,
        "trust_level": 1
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 38,
      "username": "panghy",
      "name": "Clement Pang",
      "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png"
    },
    "last_poster": {
      "id": 38,
      "username": "panghy",
      "name": "Clement Pang",
      "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/commit/7f72aa7de5bdd55866e9ac391e943ccbdbd4ba89",
        "title": "fix: a storage server does not ever need to rollback before a version\u2026 \u00b7 apple/foundationdb@7f72aa7 \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 16,
        "user_id": 38,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/pull/385/commits",
        "title": "Add detail to trace event and not attempt the rollback if the ToVersion is larger than the restored version. by panghy \u00b7 Pull Request #385 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 38,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/release-5.2/fdbserver/TagPartitionedLogSystem.actor.cpp#L708",
        "title": "foundationdb/TagPartitionedLogSystem.actor.cpp at release-5.2 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 54,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}