{
  "post_stream": {
    "posts": [
      {
        "id": 3405,
        "name": "",
        "username": "developer_resource",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/eb8c5e/{size}.png",
        "created_at": "2019-02-18T20:31:36.511Z",
        "cooked": "<p>In testing document layer we are seeing very poor performance when sorting by <code>_id</code>, we have run createIndex/ensureIndex and while that eats all document layer cpu for a long time, we don\u2019t see an improvement in performance after completion.  The FoundationDB cluster itself is practically idle when either using sort on _id or creating the index however document layer cpu is maxed.  Other, keyed queries are very fast during both these actions showing that foundation db is not the bottle neck. Is there anything we are doing wrong or something we can do to improve performance on sort requests? We ask because these are very common uses of mongo according to our DBA team.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2019-02-18T20:31:36.511Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 28,
        "reads": 27,
        "readers_count": 26,
        "score": 145.4,
        "yours": false,
        "topic_id": 1148,
        "topic_slug": "slow-sorting-on-indexed-id-field",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 494,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/slow-sorting-on-indexed-id-field/1148/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 3407,
        "name": "Bhaskar Muppana",
        "username": "mbhaskar",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mbhaskar/{size}/277_2.png",
        "created_at": "2019-02-18T22:32:09.652Z",
        "cooked": "<p>Yeah, this is one of the major issues we want to fix very soon. At the moment, document layer doesn\u2019t use indexes for any <code>sort()</code>. This includes even the primary index, <code>_id</code>. Sorting happens on the documents in memeory. That is the reason why you see document layer being too busy while FoundationDB servers being idle</p>\n<p>Targeting to fix this in next couple of releases. Here is the issue for it</p>\n<aside class=\"onebox githubissue\">\n  <header class=\"source\">\n      <a href=\"https://github.com/FoundationDB/fdb-document-layer/issues/50\" target=\"_blank\" rel=\"nofollow noopener\">github.com/FoundationDB/fdb-document-layer</a>\n  </header>\n  <article class=\"onebox-body\">\n    <a href=\"https://github.com/apkar\" rel=\"nofollow noopener\">\n<img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/dcfc4592f720f8bce0ceace45097e29a2125c0de.jpeg\" class=\"thumbnail onebox-avatar\" width=\"96\" height=\"96\">\n</a>\n\n<h4><a href=\"https://github.com/FoundationDB/fdb-document-layer/issues/50\" target=\"_blank\" rel=\"nofollow noopener\">Issue: sort() should use indexes</a></h4>\n\n<div class=\"date\" style=\"margin-top:10px;\">\n\t<div class=\"user\" style=\"margin-top:10px;\">\n\topened by <a href=\"https://github.com/apkar\" target=\"_blank\" rel=\"nofollow noopener\">apkar</a>\n\ton <a href=\"https://github.com/FoundationDB/fdb-document-layer/issues/50\" target=\"_blank\" rel=\"nofollow noopener\">2019-01-25</a>\n\t</div>\n\t<div class=\"user\">\n\t</div>\n</div>\n\n<pre class=\"content\" style=\"white-space: pre-wrap;\">Query planner uses indexes only to satisfy predicates. Sorting is done in memory. If we have a query like db.coll.find().sort('section').limit(5), without...</pre>\n\n<div class=\"labels\">\n \t<span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">enhancement</span>\n</div>\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2019-02-18T22:35:10.191Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 22,
        "readers_count": 21,
        "score": 34.4,
        "yours": false,
        "topic_id": 1148,
        "topic_slug": "slow-sorting-on-indexed-id-field",
        "display_username": "Bhaskar Muppana",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/FoundationDB/fdb-document-layer/issues/50",
            "internal": false,
            "reflection": false,
            "title": "sort() should use indexes \u00b7 Issue #50 \u00b7 FoundationDB/fdb-document-layer \u00b7 GitHub",
            "clicks": 10
          },
          {
            "url": "https://github.com/apkar",
            "internal": false,
            "reflection": false,
            "title": "apkar (Bhaskar Muppana) \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 9,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/slow-sorting-on-indexed-id-field/1148/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      3405,
      3407
    ]
  },
  "timeline_lookup": [
    [
      1,
      2437
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Slow sorting on indexed _id field",
  "id": 1148,
  "title": "Slow sorting on indexed _id field",
  "posts_count": 2,
  "created_at": "2019-02-18T20:31:36.423Z",
  "views": 949,
  "reply_count": 0,
  "like_count": 0,
  "last_posted_at": "2019-02-18T22:32:09.652Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "slow-sorting-on-indexed-id-field",
  "category_id": 11,
  "word_count": 197,
  "deleted_at": null,
  "user_id": 494,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1148",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 2,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 2,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Document layer plans?",
      "id": 180,
      "title": "Document layer plans?",
      "slug": "document-layer-plans",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2018-04-21T14:43:09.747Z",
      "last_posted_at": "2018-04-22T14:19:56.095Z",
      "bumped": true,
      "bumped_at": "2018-04-22T16:39:24.212Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 1916,
      "category_id": 9,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 30,
            "username": "wwilson",
            "name": "Will Wilson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 140,
            "username": "Andrej",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/andrej/{size}/261_2.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Implementing sorting by one field and filtering by another",
      "id": 1276,
      "title": "Implementing sorting by one field and filtering by another",
      "slug": "implementing-sorting-by-one-field-and-filtering-by-another",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2019-04-02T12:42:34.217Z",
      "last_posted_at": "2019-04-03T08:23:30.090Z",
      "bumped": true,
      "bumped_at": "2019-04-03T08:23:30.090Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1015,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 554,
            "username": "chanon",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/c/a587f6/{size}.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        }
      ]
    },
    {
      "fancy_title": "Document Layer Performance",
      "id": 1255,
      "title": "Document Layer Performance",
      "slug": "document-layer-performance",
      "posts_count": 2,
      "reply_count": 0,
      "highest_post_number": 2,
      "image_url": null,
      "created_at": "2019-03-25T02:01:43.056Z",
      "last_posted_at": "2019-04-08T20:36:48.678Z",
      "bumped": true,
      "bumped_at": "2019-04-08T20:36:48.678Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1531,
      "category_id": 11,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 542,
            "username": "jonahwest",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/90db22/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 9,
            "username": "mbhaskar",
            "name": "Bhaskar Muppana",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mbhaskar/{size}/277_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Commands comparision between Document layer foundationDB versus Mongodb",
      "id": 1172,
      "title": "Commands comparision between Document layer foundationDB versus Mongodb",
      "slug": "commands-comparision-between-document-layer-foundationdb-versus-mongodb",
      "posts_count": 3,
      "reply_count": 0,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2019-02-21T00:57:26.066Z",
      "last_posted_at": "2019-02-21T01:37:21.254Z",
      "bumped": true,
      "bumped_at": "2019-02-21T01:37:21.254Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 808,
      "category_id": 11,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 521,
            "username": "vaggarwal",
            "name": "VISHAL AGGARWAL",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/v/b3f665/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 9,
            "username": "mbhaskar",
            "name": "Bhaskar Muppana",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mbhaskar/{size}/277_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Missing/Confusing references in docs and source code",
      "id": 597,
      "title": "Missing/Confusing references in docs and source code",
      "slug": "missing-confusing-references-in-docs-and-source-code",
      "posts_count": 5,
      "reply_count": 0,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2018-07-27T17:43:36.645Z",
      "last_posted_at": "2019-10-24T06:08:54.143Z",
      "bumped": true,
      "bumped_at": "2019-10-24T06:08:54.143Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 5,
      "views": 1633,
      "category_id": 9,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 323,
            "username": "WolfDan",
            "name": "Wolf Dan",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wolfdan/{size}/806_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 9,
        "username": "mbhaskar",
        "name": "Bhaskar Muppana",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mbhaskar/{size}/277_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 494,
        "username": "developer_resource",
        "name": "",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/eb8c5e/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 494,
      "username": "developer_resource",
      "name": "",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/d/eb8c5e/{size}.png"
    },
    "last_poster": {
      "id": 9,
      "username": "mbhaskar",
      "name": "Bhaskar Muppana",
      "avatar_template": "/user_avatar/forums.foundationdb.org/mbhaskar/{size}/277_2.png"
    },
    "links": [
      {
        "url": "https://github.com/FoundationDB/fdb-document-layer/issues/50",
        "title": "sort() should use indexes \u00b7 Issue #50 \u00b7 FoundationDB/fdb-document-layer \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 10,
        "user_id": 9,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}