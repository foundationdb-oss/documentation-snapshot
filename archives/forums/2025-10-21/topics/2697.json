{
  "post_stream": {
    "posts": [
      {
        "id": 9400,
        "name": "Wilson Wang",
        "username": "wilsonwang371",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png",
        "created_at": "2021-05-11T17:23:35.346Z",
        "cooked": "<p>Hi guys,</p>\n<p>I have a question regarding the possibilities to replace k8s cluster etcd with foundationdb by adding an extra layer.</p>\n<p>To support etcd, this layer needs to provide Txn(), Put(), Range(), Watch() at least.</p>\n<p>I know foundationdb supports watch but the watch provided is different from the ones available in etcd. We need range watch support.</p>\n<p>To implement a mvcc support that fits apiserver\u2019s need, we need to add a KV table which has a ever increasing number which might cause hotspot read in multi-raft database. Will this happen on foundationdb too?</p>\n<p>Wilson</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-11T17:23:35.346Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1506,
        "reads": 51,
        "readers_count": 50,
        "score": 7470.2,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Wilson Wang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 935,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 9401,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2021-05-12T15:30:59.286Z",
        "cooked": "<p>You might be interested in this thread that <a class=\"mention\" href=\"/u/pierrez\">@PierreZ</a> started a while ago about the etcd API: <a href=\"https://forums.foundationdb.org/t/multiple-questions-about-indexes-functions-and-watches-to-implement-etcd-layer/2047/\" class=\"inline-onebox\">Multiple questions about Indexes, functions and watches to implement etcd-layer</a></p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"1\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>I know foundationdb supports watch but the watch provided is different from the ones available in etcd. We need range watch support.</p>\n</blockquote>\n</aside>\n<p>Yeah, that\u2019s right. What FDB calls \u201cwatch\u201d is a feature that lets you know if a specific key has changed, but it doesn\u2019t tell you what it was changed to. The etcd \u201cwatch\u201d API gives you a list of all changes to the specified key range (until the watch is ended). I think, with the right indexes, you could probably use FDB watches to implement etcd watches, but I\u2019m eliding over a <strong>lot</strong> of implementation details there.</p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"1\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>To implement a mvcc support that fits apiserver\u2019s need, we need to add a KV table which has a ever increasing number which might cause hotspot read in multi-raft database. Will this happen on foundationdb too?</p>\n</blockquote>\n</aside>\n<p>Hmm, I\u2019m not sure I completely understand the question. It\u2019s certainly possible to create read hot spots in FDB, and if the idea is to implement the \u201cversion\u201d in MVCC by including a single key which is incremented every time a change is made, then yes, that key would quickly become a hotspot. I think most proposals for putting something like etcd on top of FDB would be to leverage FDB\u2019s existing \u201cversion\u201d in some way. Each FDB cluster already maintains a monotonically increasing 64-bit version that it uses for MVCC (though note that the MVCC history window is not persisted, and so it can only be queried historically for 5 seconds, i.e., the duration the MVCC history window is available in memory), and it also exposes operations to include the version in keys and values (which is equivalent to, say, including the \u201ccommit timestamp\u201d in a column in an alternative system). Then I think you could build persistent MVCC into the layer\u2019s data model with those tools. But it would require some data modeling work to get right.</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-12T15:30:59.286Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 46,
        "reads": 51,
        "readers_count": 50,
        "score": 275.2,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/multiple-questions-about-indexes-functions-and-watches-to-implement-etcd-layer/2047",
            "internal": true,
            "reflection": false,
            "title": "Multiple questions about Indexes, functions and watches to implement etcd-layer",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 2
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9402,
        "name": "Pierre Zemb",
        "username": "PierreZ",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "created_at": "2021-05-12T17:01:43.341Z",
        "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"alloc\" data-post=\"2\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alloc/48/9_2.png\" class=\"avatar\"> alloc:</div>\n<blockquote>\n<p>You might be interested in this thread that <a class=\"mention\" href=\"/u/pierrez\">@PierreZ</a> started a while ago about the etcd API: <a href=\"https://forums.foundationdb.org/t/multiple-questions-about-indexes-functions-and-watches-to-implement-etcd-layer/2047/\">Multiple questions about Indexes, functions and watches to implement etcd-layer</a></p>\n</blockquote>\n</aside>\n<p>Thanks for sharing my little side-project <a class=\"mention\" href=\"/u/alloc\">@alloc</a> <img src=\"https://emoji.discourse-cdn.com/twitter/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> You can find the etcd-layer <a href=\"https://github.com/PierreZ/fdb-etcd\" rel=\"noopener nofollow ugc\">here</a>, and I will add some additional informations beside everything <a class=\"mention\" href=\"/u/alloc\">@alloc</a> already commented <img src=\"https://emoji.discourse-cdn.com/twitter/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"1\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>To support etcd, this layer needs to provide Txn(), Put(), Range(), Watch() at least.</p>\n<p>I know foundationdb supports watch but the watch provided is different from the ones available in etcd. We need range watch support.</p>\n</blockquote>\n</aside>\n<p>Under the hood, ETCD is storing things in bbolt (a kv), <a href=\"https://github.com/etcd-io/etcd/blob/v3.4.14/mvcc/kvstore_txn.go#L214\" rel=\"noopener nofollow ugc\">and the key is the revision, not the key as we would expect.</a> There is also another etcdshim called <a href=\"https://github.com/k3s-io/kine/blob/master/pkg/drivers/pgsql/pgsql.go#L28\" rel=\"noopener nofollow ugc\">Kine which is doing the same thing.</a> Regarding what ETCD and other ETCDshims are doing, I\u00b4m rather happy with my current implementation, which is keeping every operations (until compactions), and transform Watch in a scheduled query that will every 100ms use an index on the <code>read_version</code> to fetch missed events. <a href=\"https://github.com/PierreZ/fdb-etcd/pull/23/files#diff-dacc87e785bcecd84292991d7309039d2a122c5d80904dd50e84ecf4eec09144R392\" rel=\"noopener nofollow ugc\">You can find the code here (not merged yet).</a></p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"1\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>To implement a mvcc support that fits apiserver\u2019s need, we need to add a KV table which has a ever increasing number which might cause hotspot read in multi-raft database. Will this happen on foundationdb too?</p>\n</blockquote>\n</aside>\n<p>It depends on the design of the layer. My initial goal was to use versionstamp as the revision to achieve better concurrency on Put/Txn. Turns out the library I\u00b4m using to build the etcd-layer does not support versionstamp as primary key <strong>yet</strong> <img src=\"https://emoji.discourse-cdn.com/twitter/tongue.png?v=12\" title=\":tongue:\" class=\"emoji\" alt=\":tongue:\" loading=\"lazy\" width=\"20\" height=\"20\"> As a workaround, I\u00b4m extracting the read-version during Transaction and use it as to set fields like <a href=\"https://github.com/PierreZ/fdb-etcd/blob/master/src/main/proto/record.proto#L11-L17\" rel=\"noopener nofollow ugc\"><code>create_revision</code> or <code>mod_revision</code></a> (again, far from optimal)</p>\n<p>This layer was my first application using FDB, so there\u00b4s a ton of improvements to be done here, which is not tracked by Github issues, I will take the time to do so soon. I\u00b4m rather focused on implementing the directory in Rust\u00b4s binding for now, but I will soon come back to the layer to improve it <img src=\"https://emoji.discourse-cdn.com/twitter/+1.png?v=12\" title=\":+1:\" class=\"emoji\" alt=\":+1:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>A few more Kubernetes\u00b4s related informations about my layer:</p>\n<ul>\n<li>I would love to have some automated tests that are spawning a fake <code>apiServer</code> to test the layer <img src=\"https://emoji.discourse-cdn.com/twitter/heart.png?v=12\" title=\":heart:\" class=\"emoji\" alt=\":heart:\" loading=\"lazy\" width=\"20\" height=\"20\"> Do you have an idea on how I could achieve this?</li>\n<li>The layer is multi-tenant by design relying on the user/password, but this is not finished yet, and I\u00b4m not sure if the <code>apiServer</code> is implementing password-based auth. I remember only seeing cert-auth.</li>\n</ul>\n<p>Also, feel free to ask any questions you may have <img src=\"https://emoji.discourse-cdn.com/twitter/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-12T17:01:43.341Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 2,
        "incoming_link_count": 53,
        "reads": 47,
        "readers_count": 46,
        "score": 289.4,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Pierre Zemb",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/PierreZ/fdb-etcd",
            "internal": false,
            "reflection": false,
            "title": "GitHub - PierreZ/fdb-etcd: ETCD layer on top of FoundationDB",
            "clicks": 75
          },
          {
            "url": "https://github.com/k3s-io/kine/blob/master/pkg/drivers/pgsql/pgsql.go#L28",
            "internal": false,
            "reflection": false,
            "title": "kine/pgsql.go at master \u00b7 k3s-io/kine \u00b7 GitHub",
            "clicks": 31
          },
          {
            "url": "https://github.com/etcd-io/etcd/blob/v3.4.14/mvcc/kvstore_txn.go#L214",
            "internal": false,
            "reflection": false,
            "title": "etcd/kvstore_txn.go at v3.4.14 \u00b7 etcd-io/etcd \u00b7 GitHub",
            "clicks": 12
          },
          {
            "url": "https://github.com/PierreZ/fdb-etcd/pull/23/files#diff-dacc87e785bcecd84292991d7309039d2a122c5d80904dd50e84ecf4eec09144R392",
            "internal": false,
            "reflection": false,
            "title": "Watch v2 by PierreZ \u00b7 Pull Request #23 \u00b7 PierreZ/fdb-etcd \u00b7 GitHub",
            "clicks": 10
          },
          {
            "url": "https://github.com/PierreZ/fdb-etcd/blob/master/src/main/proto/record.proto#L11-L17",
            "internal": false,
            "reflection": false,
            "title": "fdb-etcd/record.proto at master \u00b7 PierreZ/fdb-etcd \u00b7 GitHub",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 534,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9406,
        "name": "Wilson Wang",
        "username": "wilsonwang371",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png",
        "created_at": "2021-05-13T21:10:07.320Z",
        "cooked": "<p>Thank you guys for the informative replies. <a class=\"mention\" href=\"/u/alloc\">@alloc</a> <a class=\"mention\" href=\"/u/pierrez\">@PierreZ</a></p>\n<aside class=\"quote no-group\" data-username=\"alloc\" data-post=\"2\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alloc/48/9_2.png\" class=\"avatar\"> alloc:</div>\n<blockquote>\n<p>I think, with the right indexes, you could probably use FDB watches to implement etcd watches,</p>\n</blockquote>\n</aside>\n<aside class=\"quote no-group\" data-username=\"PierreZ\" data-post=\"3\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/pierrez/48/866_2.png\" class=\"avatar\"> PierreZ:</div>\n<blockquote>\n<p>There is also another etcdshim called <a href=\"https://github.com/k3s-io/kine/blob/master/pkg/drivers/pgsql/pgsql.go#L28\" rel=\"noopener nofollow ugc\">Kine which is doing the same thing.</a></p>\n</blockquote>\n</aside>\n<p>Yeah, I have read Kine\u2019s code. Kine is building another mvcc layer on top of the backend db. That\u2019s why I am asking about the monotonically increasing id. Using such an ID, we can use two table to achieve something similar  to what etcd did. One table is key \u2192 ID mapping, another table holds ID \u2192 value mapping. Of course, to better support Watch and also to improve the performance, this final design may be different from this.</p>\n<p>To make FDB a usable etcd replacement in k8s cluster, it is not a easy task. There many issues we need to resolve.</p>\n<ol>\n<li>Performance needs to be better than etcd.</li>\n<li>Horizontally Scalable. But Watch event should not be lost or reordered.</li>\n<li>Avoid single-point failures.</li>\n</ol>\n<p>Performance requires Scalable. Scalable requires distributed processing. However, distributed processing can hardly make sure the ordering and no event lost. That\u2019s why I feel it is really hard to achieve these goals.</p>\n<p>Kine could not resolve all the above issues. This makes it not a feasible alternative in our enterprise environment. Good thing is that FDB supports Watch. But the Watch support from FDB is also not very limited.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-13T21:40:41.539Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 2,
        "incoming_link_count": 21,
        "reads": 41,
        "readers_count": 40,
        "score": 118.2,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Wilson Wang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 935,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9407,
        "name": "Pierre Zemb",
        "username": "PierreZ",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "created_at": "2021-05-14T07:38:07.942Z",
        "cooked": "<p>Disclaimer: I worked a lot around ETCD in my previous work at OVHcloud(I left two weeks ago <img src=\"https://emoji.discourse-cdn.com/twitter/tongue.png?v=12\" title=\":tongue:\" class=\"emoji\" alt=\":tongue:\" loading=\"lazy\" width=\"20\" height=\"20\">), especially <a href=\"https://github.com/etcd-io/etcd/issues/11884\" rel=\"noopener nofollow ugc\">around this issue</a>. OVHcloud is using one ETCD for hundred of ApiServers and it was a pain for SRE team (<a href=\"https://pierrezemb.fr/talks/lessons-learned-from-operating-etcd/\" rel=\"noopener nofollow ugc\">more details here</a>). I wrote the layer during the first french lockdown just before joining the K8S team to learn both FDB and ETCD at the same time. After joining the team, a few months later, we decided to test some ETCDshims. Our goal was to avoid stacking ETCD\u00b4s cluster like they are doing now and have something designed to scale nicely as we are adding new customers. I talked with <a href=\"https://twitter.com/ibuildthecloud\" rel=\"noopener nofollow ugc\">Darren Shepherd</a> a lot about Kine and I was hyped about it. They replaced their ETCDs in Rancher by Kine and they are really happy about it. But the tradeoff here is that they are using Amazon managed SQL products.</p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"4\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>Yeah, I have read Kine\u2019s code. Kine is building another mvcc layer on top of the backend db. That\u2019s why I am asking about the monotonically increasing id. Using such an ID, we can use two table to achieve something similar to what etcd did. One table is key \u2192 ID mapping, another table holds ID \u2192 value mapping. Of course, to better support Watch and also to improve the performance, this final design may be different from this.</p>\n</blockquote>\n</aside>\n<p>You are right! The monotonic ID is interesting, but only works when running an non-distributed datastore. We tried something like CockroachDB below Kine to distribute the tables, but we were experiencing too much constraints on both the SQL layer and the SEQUENCE to have a nice performances.</p>\n<p>Well, to be fair, we had better performances than ETCD, but it did not scale enough as we were having a lot transactions restarts with the <a href=\"https://www.cockroachlabs.com/docs/v20.2/transaction-retry-error-reference.html#readwithinuncertaintyinterval\" rel=\"noopener nofollow ugc\">ReadWithinUncertaintyInterval error</a>.</p>\n<p>I also tried to forked Kine to handle revision internally in the ETCDshim instead of relying on the database to generate them but I left OVHcloud before putting some tests in it.</p>\n<p>After {writing, playing with} several ETCDshims, I feel like my first approach was the right one, FoundationDB\u00b4s interface is insanely good to help you carefully design a data service thanks to features like the byte-ordered key-Value, transactions, Versionstamp, Tuples/Subspaces/Directories and so on <img src=\"https://emoji.discourse-cdn.com/twitter/sun_with_face.png?v=12\" title=\":sun_with_face:\" class=\"emoji\" alt=\":sun_with_face:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"4\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>To make FDB a usable etcd replacement in k8s cluster, it is not a easy task. There many issues we need to resolve.</p>\n<ol>\n<li>Performance needs to be better than etcd.</li>\n<li>Horizontally Scalable. But Watch event should not be lost or reordered.</li>\n<li>Avoid single-point failures.</li>\n</ol>\n</blockquote>\n</aside>\n<p>I\u00b4m not scared with <code>1</code> and <code>3</code> because of how bad ETCD behave under \u201chigh\u201d QPS <img src=\"https://emoji.discourse-cdn.com/twitter/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\n<code>2</code> is completely tied to the design of the layer.</p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"4\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>Performance requires Scalable. Scalable requires distributed processing. However, distributed processing can hardly make sure the ordering and no event lost. That\u2019s why I feel it is really hard to achieve these goals.</p>\n</blockquote>\n</aside>\n<p>I feel like it is quite easy to design the layer with that in my mind. I prefer to pay a bit additional cost during GetRange to gain a perfectly handled Watch.</p>\n<aside class=\"quote no-group\" data-username=\"wilsonwang371\" data-post=\"4\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/wilsonwang371/48/1072_2.png\" class=\"avatar\"> wilsonwang371:</div>\n<blockquote>\n<p>Good thing is that FDB supports Watch. But the Watch support from FDB is also not very limited.</p>\n</blockquote>\n</aside>\n<p>FDB\u00b4s watches are only the top of the iceberg to implement ETCD\u00b4s watches. I was like you at the beginning of the layer \u201cI should use the Watches directly!!\u201d Then I realized than they are two differents beasts:</p>\n<ul>\n<li>ETCD\u00b4s watch is a stream of mutations,</li>\n<li>FDB\u00b4s watch is a notification of a key change.</li>\n</ul>\n<p>The first item means that ETCD need to keep <strong>an exact history</strong> of its keyspace, like this:</p>\n<pre data-code-wrap=\"git\"><code class=\"lang-git\">// ...\nrevision 432: added key foo\nrevision 433: deleted bar key\n// ...\n</code></pre>\n<p>so that a Watch is simply a scheduled query, retrieving any new revisions. ETCD, <code>Kine</code> and my layer are designed like this, with the revision as a key. This is the only way to be sure that your Watches sees every mutations.</p>\n<p>Well not the only way, you could use something like <a href=\"https://yokota.blog/2020/11/09/keta-a-metadata-store-backed-by-apache-kafka/\" rel=\"noopener nofollow ugc\">Kafka or Pulsar as the storage layer of an ETCDshim</a>, but this will shift the design completely as the Watches will be simple <strong>but</strong> the kv interface will give you extra work.</p>\n<p>I also feels like FDB\u00b4s watches have an impact on production clusters, but that is just a feeling, no production experience here <img src=\"https://emoji.discourse-cdn.com/twitter/laughing.png?v=12\" title=\":laughing:\" class=\"emoji\" alt=\":laughing:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-14T08:42:12.398Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 56,
        "reads": 39,
        "readers_count": 38,
        "score": 302.8,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Pierre Zemb",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/etcd-io/etcd/issues/11884",
            "internal": false,
            "reflection": false,
            "title": "Random performance issue on etcd 3.4 \u00b7 Issue #11884 \u00b7 etcd-io/etcd \u00b7 GitHub",
            "clicks": 37
          },
          {
            "url": "https://pierrezemb.fr/talks/lessons-learned-from-operating-etcd/",
            "internal": false,
            "reflection": false,
            "title": "Lessons Learned from Operating ETCD :: Pierre Zemb",
            "clicks": 31
          },
          {
            "url": "https://yokota.blog/2020/11/09/keta-a-metadata-store-backed-by-apache-kafka/",
            "internal": false,
            "reflection": false,
            "title": "Keta: A Metadata Store Backed By Apache Kafka \u2013 Robert Yokota",
            "clicks": 14
          },
          {
            "url": "https://www.cockroachlabs.com/docs/v20.2/transaction-retry-error-reference.html#readwithinuncertaintyinterval",
            "internal": false,
            "reflection": false,
            "title": "Transaction Retry Error Reference | CockroachDB Docs",
            "clicks": 8
          },
          {
            "url": "https://twitter.com/ibuildthecloud",
            "internal": false,
            "reflection": false,
            "clicks": 6
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 534,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9408,
        "name": "Wilson Wang",
        "username": "wilsonwang371",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png",
        "created_at": "2021-05-14T17:18:55.933Z",
        "cooked": "<p>Nice comment! Let me think about this and post more details later. I finally found the right place and the right person to discuss these headaches now. <img src=\"https://emoji.discourse-cdn.com/twitter/joy.png?v=9\" title=\":joy:\" class=\"emoji\" alt=\":joy:\"></p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-14T17:18:55.933Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 33,
        "readers_count": 32,
        "score": 31.6,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Wilson Wang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 534,
          "username": "PierreZ",
          "name": "Pierre Zemb",
          "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 935,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9416,
        "name": "Pierre Zemb",
        "username": "PierreZ",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "created_at": "2021-05-17T16:16:06.724Z",
        "cooked": "<p>Take your time, and feel free to ask any questions <img src=\"https://emoji.discourse-cdn.com/twitter/smiley.png?v=9\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\"></p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-17T16:16:06.724Z",
        "reply_count": 1,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 31,
        "readers_count": 30,
        "score": 21.2,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Pierre Zemb",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 935,
          "username": "wilsonwang371",
          "name": "Wilson Wang",
          "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 534,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9665,
        "name": "Wilson Wang",
        "username": "wilsonwang371",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png",
        "created_at": "2021-07-08T17:44:52.758Z",
        "cooked": "<p>Hi Pierre,</p>\n<p>Due to the incoming work from other more urgent tasks, we are going to put this task aside for a few weeks. I think this will be a long term task for us and a lot of evaluations are needed before making a decision.</p>\n<p>Thank you for the very helpful comments and lets discuss this later after I collecting more information on this.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-07-08T17:44:52.758Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 30,
        "readers_count": 29,
        "score": 6.0,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Wilson Wang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 534,
          "username": "PierreZ",
          "name": "Pierre Zemb",
          "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 935,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 10104,
        "name": "Julien Laurenceau",
        "username": "julienlau",
        "avatar_template": "/user_avatar/forums.foundationdb.org/julienlau/{size}/1199_2.png",
        "created_at": "2021-10-11T15:49:38.967Z",
        "cooked": "<p>It may be worth a try to see how kubernetes behaves when skipping all intermediates version at watch triggers. In my limited understanding of Kubernetes, these stale state are only necessary to update all the layers of watch cache by increment (Delta FIFO) ?<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/2X/3/35e8bbc088b79eccc416f2022371037f69d1ef2a.jpeg\" data-download-href=\"/uploads/short-url/7GTVXYBZwhutdwxaKVIE3WpIrW2.jpeg?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\"><img src=\"https://global.discourse-cdn.com/foundationdb/original/2X/3/35e8bbc088b79eccc416f2022371037f69d1ef2a.jpeg\" alt=\"image\" data-base62-sha1=\"7GTVXYBZwhutdwxaKVIE3WpIrW2\" width=\"468\" height=\"500\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/2X/3/35e8bbc088b79eccc416f2022371037f69d1ef2a_2_10x10.png\"><div class=\"meta\">\n<svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">730\u00d7779 71.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg>\n</div></a></div></p>\n<p>The bad thing is I think on large clusters some k/v pairs can get huge and exceed etcd maxvalue so there may be some tricks to decrease amount of streamed data by using etcd intermediary values but I cannot tell.</p>\n<p>Anyhow, it may be a better idea to fork kubernetes <em>store</em> and <em>client-go</em> to support tweaked watch semantics rather than try to reproduce exactly etcd watch behavior on top of FDB ?</p>\n<p>In my view, the interest of overcoming etcd scalability issues is to be able to get rid of all the etcd cache layers on kubernetes side ?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-10-11T15:49:38.967Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 29,
        "readers_count": 28,
        "score": 25.8,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Julien Laurenceau",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/2X/3/35e8bbc088b79eccc416f2022371037f69d1ef2a.jpeg",
            "internal": false,
            "reflection": false,
            "title": "35e8bbc088b79eccc416f2022371037f69d1ef2a.jpeg",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 1012,
        "hidden": false,
        "trust_level": 0,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 10127,
        "name": "Pierre Zemb",
        "username": "PierreZ",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "created_at": "2021-10-15T09:24:06.276Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"julienlau\" data-post=\"9\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/julienlau/48/1199_2.png\" class=\"avatar\"> julienlau:</div>\n<blockquote>\n<p>It may be worth a try to see how kubernetes behaves when skipping all intermediates version at watch triggers. In my limited understanding of Kubernetes, these stale state are only necessary to update all the layers of watch cache by increment (Delta FIFO) ?</p>\n</blockquote>\n</aside>\n<p>I don\u2019t remember exactly how the watch cache works, but I remember that it was causing a lot of issues:</p>\n<ul>\n<li><a href=\"https://github.com/etcd-io/etcd/issues/9988\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">watch through grpc proxy result in delay or miss event \u00b7 Issue #9988 \u00b7 etcd-io/etcd \u00b7 GitHub</a></li>\n<li><a href=\"https://github.com/kubernetes/kubernetes/issues/59848\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Kubernetes is vulnerable to stale reads, violating critical pod safety guarantees \u00b7 Issue #59848 \u00b7 kubernetes/kubernetes \u00b7 GitHub</a></li>\n<li><a href=\"https://github.com/kubernetes/enhancements/pull/1404\" rel=\"noopener nofollow ugc\">https://github.com/kubernetes/enhancements/pull/1404</a></li>\n<li><a href=\"https://github.com/instaclustr/cassandra-operator/issues/402\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">[BUG] PVC can be accidentally deleted when controller reads stale data from apiserver \u00b7 Issue #402 \u00b7 instaclustr/cassandra-operator \u00b7 GitHub</a></li>\n<li><a href=\"https://twitter.com/embano1/status/1349484575756607490?s=20\" rel=\"noopener nofollow ugc\">https://twitter.com/embano1/status/1349484575756607490?s=20</a></li>\n</ul>\n<p>I left OVHcloud before digging into it.</p>\n<aside class=\"quote no-group\" data-username=\"julienlau\" data-post=\"9\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/julienlau/48/1199_2.png\" class=\"avatar\"> julienlau:</div>\n<blockquote>\n<p>The bad thing is I think on large clusters some k/v pairs can get huge and exceed etcd maxvalue so there may be some tricks to decrease amount of streamed data by using etcd intermediary values but I cannot tell.</p>\n</blockquote>\n</aside>\n<p>On another layer using the Record-Layer, I used the <a href=\"https://github.com/PierreZ/record-store/blob/master/record-store/src/main/java/fr/pierrezemb/recordstore/fdb/RecordLayer.java#L193\" rel=\"noopener nofollow ugc\"><code>setSplitLongRecords</code></a> options to handle large values. With this option, the record-layer will spread the value over multiple k/v. It is not yet used on this layer.</p>\n<aside class=\"quote no-group\" data-username=\"julienlau\" data-post=\"9\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/julienlau/48/1199_2.png\" class=\"avatar\"> julienlau:</div>\n<blockquote>\n<p>Anyhow, it may be a better idea to fork kubernetes <em>store</em> and <em>client-go</em> to support tweaked watch semantics rather than try to reproduce exactly etcd watch behavior on top of FDB ?</p>\n</blockquote>\n</aside>\n<p>I found easier to implement this using the record-layer than forking Kubernetes <img src=\"https://emoji.discourse-cdn.com/twitter/grinning_face_with_smiling_eyes.png?v=12\" title=\":grinning_face_with_smiling_eyes:\" class=\"emoji\" alt=\":grinning_face_with_smiling_eyes:\" loading=\"lazy\" width=\"20\" height=\"20\"><br>\nAlso, it is a side project I used to discover FDB. But this is definitely another road that can be taken, but merging it upstream will be difficult IMO (see <a href=\"https://github.com/kubernetes/kubernetes/issues/53162\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">DynamoDb Support for API Server \u00b7 Issue #53162 \u00b7 kubernetes/kubernetes \u00b7 GitHub</a>)</p>\n<aside class=\"quote no-group\" data-username=\"julienlau\" data-post=\"9\" data-topic=\"2697\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/julienlau/48/1199_2.png\" class=\"avatar\"> julienlau:</div>\n<blockquote>\n<p>In my view, the interest of overcoming etcd scalability issues is to be able to get rid of all the etcd cache layers on kubernetes side ?</p>\n</blockquote>\n</aside>\n<p>You are right, if we have an ETCD that can scale well under \u201chigh\u201d query per second, we could remove the cache I guess. From what I saw in my previous company, high qps for ETCD is around:</p>\n<ul>\n<li>~2k ranges/s</li>\n<li>~800 txn/s</li>\n<li>~1.6k msg/s sent through Watch</li>\n</ul>\n<p>Pushing further was(is?) triggering a lot of pain for the SRE team.</p>\n<p>These numbers can be seen as really high, or really low depending on your background/experience with distributed systems. For me it is <strong>both</strong>: it is low for a distributed systems, but it is not that bad for a single shard/region.</p>\n<p>You can view ETCD as a single-group Raft, where the whole keyspace must be holded by all ETCD members(this is why <a href=\"https://etcd.io/docs/v3.5/dev-guide/limit/#storage-size-limit\" rel=\"noopener nofollow ugc\">ETCD storage limits is pretty low</a>). The keyspace cannot be splitted into several regions/shards to spread the load. If you are overloading the Raft group, you are forced to boot another ETCD cluster, split your keys and operate two clusters. Or 3, or 4, or many, many, many clusters to handle customers growth <img src=\"https://emoji.discourse-cdn.com/twitter/laughing.png?v=12\" title=\":laughing:\" class=\"emoji\" alt=\":laughing:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>I admit this is not an mainstream issue , but everyone who has either a very large K8S cluster or is trying to reuse ETCD over multiple apiservers is hitting this.</p>\n<p>I trully think that the lifecycle of shards/regions should be left to the database itself: <strong>operators should not have to manually split/move/merge key ranges</strong>. You are forced to do this if you are spawning multiple ETCD clusters, for example to spread/balance the keys and the load across your clusters.</p>\n<p>This opinion is also backed by years of on-call duty around HBase 1.X, where region\u2019s lifecycle is a mess: we always have to run some <code>hbck</code> to fix things <img src=\"https://emoji.discourse-cdn.com/twitter/laughing.png?v=12\" title=\":laughing:\" class=\"emoji\" alt=\":laughing:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>I have not yet operate an FDB cluster, but I have great hopes for it, in term of correctness and scalability <img src=\"https://emoji.discourse-cdn.com/twitter/rocket.png?v=12\" title=\":rocket:\" class=\"emoji\" alt=\":rocket:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-10-19T21:04:32.781Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 1,
        "incoming_link_count": 50,
        "reads": 27,
        "readers_count": 26,
        "score": 270.4,
        "yours": false,
        "topic_id": 2697,
        "topic_slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
        "display_username": "Pierre Zemb",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/kubernetes/kubernetes/issues/53162",
            "internal": false,
            "reflection": false,
            "title": "DynamoDb Support for API Server \u00b7 Issue #53162 \u00b7 kubernetes/kubernetes \u00b7 GitHub",
            "clicks": 21
          },
          {
            "url": "https://twitter.com/embano1/status/1349484575756607490?s=20",
            "internal": false,
            "reflection": false,
            "clicks": 5
          },
          {
            "url": "https://github.com/etcd-io/etcd/issues/9988",
            "internal": false,
            "reflection": false,
            "title": "watch through grpc proxy result in delay or miss event \u00b7 Issue #9988 \u00b7 etcd-io/etcd \u00b7 GitHub",
            "clicks": 5
          },
          {
            "url": "https://github.com/instaclustr/cassandra-operator/issues/402",
            "internal": false,
            "reflection": false,
            "title": "[BUG] PVC can be accidentally deleted when controller reads stale data from apiserver \u00b7 Issue #402 \u00b7 instaclustr/cassandra-operator \u00b7 GitHub",
            "clicks": 4
          },
          {
            "url": "https://github.com/kubernetes/kubernetes/issues/59848",
            "internal": false,
            "reflection": false,
            "title": "Kubernetes is vulnerable to stale reads, violating critical pod safety guarantees \u00b7 Issue #59848 \u00b7 kubernetes/kubernetes \u00b7 GitHub",
            "clicks": 3
          },
          {
            "url": "https://etcd.io/docs/v3.5/dev-guide/limit/#storage-size-limit",
            "internal": false,
            "reflection": false,
            "title": "System limits | etcd",
            "clicks": 3
          },
          {
            "url": "https://github.com/PierreZ/record-store/blob/master/record-store/src/main/java/fr/pierrezemb/recordstore/fdb/RecordLayer.java#L193",
            "internal": false,
            "reflection": false,
            "title": "record-store/RecordLayer.java at master \u00b7 PierreZ/record-store \u00b7 GitHub",
            "clicks": 3
          },
          {
            "url": "https://github.com/kubernetes/enhancements/pull/1404",
            "internal": false,
            "reflection": false,
            "title": "KEP: Consistent Reads from Cache by jpbetz \u00b7 Pull Request #1404 \u00b7 kubernetes/enhancements \u00b7 GitHub",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 534,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd/2697/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      9400,
      9401,
      9402,
      9406,
      9407,
      9408,
      9416,
      9665,
      10104,
      10127
    ]
  },
  "timeline_lookup": [
    [
      1,
      1624
    ],
    [
      2,
      1623
    ],
    [
      4,
      1622
    ],
    [
      6,
      1621
    ],
    [
      7,
      1618
    ],
    [
      8,
      1566
    ],
    [
      9,
      1471
    ],
    [
      10,
      1468
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "A FoundationDB layer for apiserver as an alternative to etcd",
  "id": 2697,
  "title": "A FoundationDB layer for apiserver as an alternative to etcd",
  "posts_count": 10,
  "created_at": "2021-05-11T17:23:35.277Z",
  "views": 3572,
  "reply_count": 5,
  "like_count": 7,
  "last_posted_at": "2021-10-15T09:24:06.276Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "a-foundationdb-layer-for-apiserver-as-an-alternative-to-etcd",
  "category_id": 14,
  "word_count": 3019,
  "deleted_at": null,
  "user_id": 935,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2697",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 10,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Fdb-zk: rough cut of Zookeeper API layer",
      "id": 1278,
      "title": "Fdb-zk: rough cut of Zookeeper API layer",
      "slug": "fdb-zk-rough-cut-of-zookeeper-api-layer",
      "posts_count": 7,
      "reply_count": 3,
      "highest_post_number": 7,
      "image_url": null,
      "created_at": "2019-04-03T02:54:03.579Z",
      "last_posted_at": "2019-04-09T04:13:12.883Z",
      "bumped": true,
      "bumped_at": "2019-04-09T04:13:12.883Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 5102,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 113,
            "username": "pH14",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ph14/{size}/92_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Changefeeds (watching and getting updates on ranges of keys)",
      "id": 511,
      "title": "Changefeeds (watching and getting updates on ranges of keys)",
      "slug": "changefeeds-watching-and-getting-updates-on-ranges-of-keys",
      "posts_count": 9,
      "reply_count": 7,
      "highest_post_number": 9,
      "image_url": null,
      "created_at": "2018-06-16T12:26:34.710Z",
      "last_posted_at": "2018-07-06T14:46:54.646Z",
      "bumped": true,
      "bumped_at": "2018-07-06T14:46:54.646Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 4221,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 307,
            "username": "jwr",
            "name": "Jan Rychter",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jwr/{size}/302_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "A few design-pattern + check-my-understanding questions",
      "id": 1153,
      "title": "A few design-pattern + check-my-understanding questions",
      "slug": "a-few-design-pattern-check-my-understanding-questions",
      "posts_count": 10,
      "reply_count": 6,
      "highest_post_number": 10,
      "image_url": null,
      "created_at": "2019-02-19T15:18:58.329Z",
      "last_posted_at": "2019-02-21T19:51:53.686Z",
      "bumped": true,
      "bumped_at": "2019-02-21T19:51:53.686Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 2273,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 519,
            "username": "JamesThompson",
            "name": "James Thompson",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/j/c67d28/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 173,
            "username": "jkominek",
            "name": "Jay Kominek",
            "avatar_template": "/user_avatar/forums.foundationdb.org/jkominek/{size}/140_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Performance characteristics of using Watches for Distributed Task Scheduling",
      "id": 471,
      "title": "Performance characteristics of using Watches for Distributed Task Scheduling",
      "slug": "performance-characteristics-of-using-watches-for-distributed-task-scheduling",
      "posts_count": 28,
      "reply_count": 13,
      "highest_post_number": 28,
      "image_url": "https://global.discourse-cdn.com/foundationdb/original/1X/0819f4ad7c04fe7d847b2f33824849dc70ee6a0c.png",
      "created_at": "2018-05-24T13:42:28.764Z",
      "last_posted_at": "2018-08-16T03:57:50.737Z",
      "bumped": true,
      "bumped_at": "2018-08-16T03:57:50.737Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 15,
      "views": 5180,
      "category_id": 9,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 118,
            "username": "abdullin",
            "name": "Rinat Abdullin",
            "avatar_template": "/user_avatar/forums.foundationdb.org/abdullin/{size}/83_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 68,
            "username": "daverosenthal",
            "name": "Dave Rosenthal",
            "avatar_template": "/user_avatar/forums.foundationdb.org/daverosenthal/{size}/51_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Watchers and not missing changes",
      "id": 474,
      "title": "Watchers and not missing changes",
      "slug": "watchers-and-not-missing-changes",
      "posts_count": 14,
      "reply_count": 6,
      "highest_post_number": 14,
      "image_url": null,
      "created_at": "2018-05-25T13:29:22.034Z",
      "last_posted_at": "2018-06-05T23:23:48.371Z",
      "bumped": true,
      "bumped_at": "2018-06-05T23:23:48.371Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 3,
      "views": 1999,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 289,
            "username": "rowanG",
            "name": "Rowan Goemans",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/r/8baadc/{size}.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 298,
            "username": "gwillis12",
            "name": "Geo",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/ed655f/{size}.png",
            "trust_level": 0
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 534,
        "username": "PierreZ",
        "name": "Pierre Zemb",
        "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 935,
        "username": "wilsonwang371",
        "name": "Wilson Wang",
        "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png",
        "post_count": 4,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 8,
        "username": "alloc",
        "name": "Alec Grieser",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 1012,
        "username": "julienlau",
        "name": "Julien Laurenceau",
        "avatar_template": "/user_avatar/forums.foundationdb.org/julienlau/{size}/1199_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 0
      }
    ],
    "created_by": {
      "id": 935,
      "username": "wilsonwang371",
      "name": "Wilson Wang",
      "avatar_template": "/user_avatar/forums.foundationdb.org/wilsonwang371/{size}/1072_2.png"
    },
    "last_poster": {
      "id": 534,
      "username": "PierreZ",
      "name": "Pierre Zemb",
      "avatar_template": "/user_avatar/forums.foundationdb.org/pierrez/{size}/866_2.png"
    },
    "links": [
      {
        "url": "https://github.com/PierreZ/fdb-etcd",
        "title": "GitHub - PierreZ/fdb-etcd: ETCD layer on top of FoundationDB",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 75,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/etcd-io/etcd/issues/11884",
        "title": "Random performance issue on etcd 3.4 \u00b7 Issue #11884 \u00b7 etcd-io/etcd \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 37,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/k3s-io/kine/blob/master/pkg/drivers/pgsql/pgsql.go#L28",
        "title": "kine/pgsql.go at master \u00b7 k3s-io/kine \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 31,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://pierrezemb.fr/talks/lessons-learned-from-operating-etcd/",
        "title": "Lessons Learned from Operating ETCD :: Pierre Zemb",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 31,
        "user_id": 534,
        "domain": "pierrezemb.fr",
        "root_domain": "pierrezemb.fr"
      },
      {
        "url": "https://github.com/kubernetes/kubernetes/issues/53162",
        "title": "DynamoDb Support for API Server \u00b7 Issue #53162 \u00b7 kubernetes/kubernetes \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 21,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://yokota.blog/2020/11/09/keta-a-metadata-store-backed-by-apache-kafka/",
        "title": "Keta: A Metadata Store Backed By Apache Kafka \u2013 Robert Yokota",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 14,
        "user_id": 534,
        "domain": "yokota.blog",
        "root_domain": "yokota.blog"
      },
      {
        "url": "https://github.com/etcd-io/etcd/blob/v3.4.14/mvcc/kvstore_txn.go#L214",
        "title": "etcd/kvstore_txn.go at v3.4.14 \u00b7 etcd-io/etcd \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 12,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/PierreZ/fdb-etcd/pull/23/files#diff-dacc87e785bcecd84292991d7309039d2a122c5d80904dd50e84ecf4eec09144R392",
        "title": "Watch v2 by PierreZ \u00b7 Pull Request #23 \u00b7 PierreZ/fdb-etcd \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 10,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://www.cockroachlabs.com/docs/v20.2/transaction-retry-error-reference.html#readwithinuncertaintyinterval",
        "title": "Transaction Retry Error Reference | CockroachDB Docs",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 8,
        "user_id": 534,
        "domain": "www.cockroachlabs.com",
        "root_domain": "cockroachlabs.com"
      },
      {
        "url": "https://twitter.com/ibuildthecloud",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 6,
        "user_id": 534,
        "domain": "twitter.com",
        "root_domain": "twitter.com"
      },
      {
        "url": "https://github.com/etcd-io/etcd/issues/9988",
        "title": "watch through grpc proxy result in delay or miss event \u00b7 Issue #9988 \u00b7 etcd-io/etcd \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 5,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://twitter.com/embano1/status/1349484575756607490?s=20",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 5,
        "user_id": 534,
        "domain": "twitter.com",
        "root_domain": "twitter.com"
      },
      {
        "url": "https://github.com/instaclustr/cassandra-operator/issues/402",
        "title": "[BUG] PVC can be accidentally deleted when controller reads stale data from apiserver \u00b7 Issue #402 \u00b7 instaclustr/cassandra-operator \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://etcd.io/docs/v3.5/dev-guide/limit/#storage-size-limit",
        "title": "System limits | etcd",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 534,
        "domain": "etcd.io",
        "root_domain": "etcd.io"
      },
      {
        "url": "https://github.com/kubernetes/kubernetes/issues/59848",
        "title": "Kubernetes is vulnerable to stale reads, violating critical pod safety guarantees \u00b7 Issue #59848 \u00b7 kubernetes/kubernetes \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/PierreZ/record-store/blob/master/record-store/src/main/java/fr/pierrezemb/recordstore/fdb/RecordLayer.java#L193",
        "title": "record-store/RecordLayer.java at master \u00b7 PierreZ/record-store \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/PierreZ/fdb-etcd/blob/master/src/main/proto/record.proto#L11-L17",
        "title": "fdb-etcd/record.proto at master \u00b7 PierreZ/fdb-etcd \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/kubernetes/enhancements/pull/1404",
        "title": "KEP: Consistent Reads from Cache by jpbetz \u00b7 Pull Request #1404 \u00b7 kubernetes/enhancements \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 534,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}