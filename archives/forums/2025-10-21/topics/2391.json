{
  "post_stream": {
    "posts": [
      {
        "id": 8093,
        "name": "Vibhuti Dembi",
        "username": "VibhutiD",
        "avatar_template": "/user_avatar/forums.foundationdb.org/vibhutid/{size}/668_2.png",
        "created_at": "2020-10-15T06:03:44.711Z",
        "cooked": "<p>Hi,<br>\nBackground: I have a cluster running on a triple redundancy mode, ssd, 16TB (Sum of K-V sizes), 65TB Disk space. It has &gt;~1.4B records.<br>\nPost migration of the records and corresponding indexes, I want to build another index on this record store. What would be the most performant way of building an index on such a store?</p>\n<p>Example for reference of the metadata:</p>\n<pre><code>    message foo { \n        int32 foo1;        // Primary Key\n        int32 foo2;        // Already existing index\n        int32 foo3;        // index to be built\n    }</code></pre>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2020-10-15T06:06:51.018Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 138,
        "reads": 42,
        "readers_count": 41,
        "score": 698.4,
        "yours": false,
        "topic_id": 2391,
        "topic_slug": "online-indexing-on-large-databases",
        "display_username": "Vibhuti Dembi",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 653,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/online-indexing-on-large-databases/2391/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 8101,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2020-10-16T17:32:52.713Z",
        "cooked": "<p>Good question. This is somewhat of a hole in our documentation, so I\u2019ve submitted an issue about making the docs in this area better: <a href=\"https://github.com/FoundationDB/fdb-record-layer/issues/1045\">https://github.com/FoundationDB/fdb-record-layer/issues/1045</a></p>\n<p>There are a few things you might want to do to more performantly build this index.</p>\n<ol>\n<li>The <code>OnlineIndexer</code> is deliberately rate limited to avoid overwhelming \u201cforeground\u201d traffic. You can make a single indexer faster by playing with some of the parameters into it, such as the \u201climit\u201d, which controls the number of records it will index in a single transaction and the \u201crecords per second\u201d, which controls its target rate of indexing. (Note that in newer versions of the Record Layer, there are also controls over how many bytes to allow in a single transaction. This is set very high, by default, and is mainly included as a protection against large transactions (which degrade FDB performance), so it probably shouldn\u2019t be adjusted, but having it in place does make it safer to set a higher limit.) Note that if you are too aggressive with the values there, you can hurt the cluster\u2019s performance, so it might be something you need to tune. Note that if you want to do something like start an indexer, see if helps, and then increase the limit, it is perfectly safe to terminate an indexer and restart it, and you won\u2019t lose any progress if you do so.</li>\n<li>You can try building different parts of the index in parallel. In particular, the <code>OnlineIndexer</code> has a method called <code>splitIndexBuildRange</code>, which looks at the distribution of keys in FDB to produce (roughly) equal ranges of records to index. The steps here are a bit manual, as the feature is still experimental, but if you create an index builder and call <code>splitIndexBuildRange</code> and then create additional indexers for each range, you can run those index builds in parallel.</li>\n</ol>\n<p>Another tip: you probably want to call <code>setProgressLogIntervalMillis</code> on the indexer when you create it, which will cause it to write a log message at the specified interval with its progress. That way, you can monitor how the index build is going. If you call <code>setTrackProgress</code>, then the number of records indexed also gets written to the database so you can then see how many records have been indexed in total by looking at the index state.</p>\n<p>Docs on the <code>OnlineIndexer.Builder</code> here for the complete list of options: <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.Builder.html\">https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.Builder.html</a><br>\nAnd on <code>splitBuildIndexBuildRange</code>: <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.html#splitIndexBuildRange(int,int)\">https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.html#splitIndexBuildRange(int,int)</a></p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 2,
        "updated_at": "2020-10-16T17:32:52.713Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 38,
        "reads": 40,
        "readers_count": 39,
        "score": 228.0,
        "yours": false,
        "topic_id": 2391,
        "topic_slug": "online-indexing-on-large-databases",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.Builder.html",
            "internal": false,
            "reflection": false,
            "title": "OnlineIndexer.Builder (fdb-record-layer-core-pb3 2.10.141.0 API)",
            "clicks": 19
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/issues/1045",
            "internal": false,
            "reflection": false,
            "title": "Document index building and options more thoroughly \u00b7 Issue #1045 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 18
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.html#splitIndexBuildRange(int,int)",
            "internal": false,
            "reflection": false,
            "title": "OnlineIndexer (fdb-record-layer-core-pb3 2.10.141.0 API)",
            "clicks": 9
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 2
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/online-indexing-on-large-databases/2391/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      8093,
      8101
    ]
  },
  "timeline_lookup": [
    [
      1,
      1833
    ],
    [
      2,
      1831
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Online Indexing on large databases",
  "id": 2391,
  "title": "Online Indexing on large databases",
  "posts_count": 2,
  "created_at": "2020-10-15T06:03:44.650Z",
  "views": 1226,
  "reply_count": 0,
  "like_count": 2,
  "last_posted_at": "2020-10-16T17:32:52.713Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "online-indexing-on-large-databases",
  "category_id": 12,
  "word_count": 544,
  "deleted_at": null,
  "user_id": 653,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2391",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 2,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 2,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Best way to add an index on already-existing data?",
      "id": 97,
      "title": "Best way to add an index on already-existing data?",
      "slug": "best-way-to-add-an-index-on-already-existing-data",
      "posts_count": 3,
      "reply_count": 0,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2018-04-20T04:59:04.978Z",
      "last_posted_at": "2018-04-21T14:52:02.378Z",
      "bumped": true,
      "bumped_at": "2018-04-21T14:52:02.378Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 3525,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 67,
            "username": "bpartridge",
            "name": "Brenton Partridge",
            "avatar_template": "/user_avatar/forums.foundationdb.org/bpartridge/{size}/50_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 30,
            "username": "wwilson",
            "name": "Will Wilson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Scaling Record Layer for Bulk Writes",
      "id": 2249,
      "title": "Scaling Record Layer for Bulk Writes",
      "slug": "scaling-record-layer-for-bulk-writes",
      "posts_count": 7,
      "reply_count": 2,
      "highest_post_number": 7,
      "image_url": null,
      "created_at": "2020-07-16T16:18:26.188Z",
      "last_posted_at": "2020-07-24T20:28:03.020Z",
      "bumped": true,
      "bumped_at": "2020-07-24T20:28:03.020Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 936,
      "category_id": 14,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 712,
            "username": "rahul-nitkkr",
            "name": "Rahul Roy",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rahul-nitkkr/{size}/754_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 337,
            "username": "mengxu",
            "name": "Meng Xu",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 741,
            "username": "sears",
            "name": "Russell Sears",
            "avatar_template": "/user_avatar/forums.foundationdb.org/sears/{size}/887_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 219,
            "username": "MMcM",
            "name": "Mike McMahon",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Lucene-Layer on FoundationDB",
      "id": 1229,
      "title": "Lucene-Layer on FoundationDB",
      "slug": "lucene-layer-on-foundationdb",
      "posts_count": 7,
      "reply_count": 3,
      "highest_post_number": 7,
      "image_url": null,
      "created_at": "2019-03-14T18:34:47.169Z",
      "last_posted_at": "2020-12-11T15:27:33.024Z",
      "bumped": true,
      "bumped_at": "2020-12-11T15:27:33.024Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 9,
      "views": 3502,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 540,
            "username": "tonysun83",
            "name": "Tony Sun",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/db5fbb/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 102,
            "username": "nathanlws",
            "name": "Nathan Williams",
            "avatar_template": "/user_avatar/forums.foundationdb.org/nathanlws/{size}/74_2.png",
            "admin": true,
            "moderator": true,
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 451,
            "username": "rnewson",
            "name": "Robert Newson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rnewson/{size}/502_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Record Layer query performance benchmarking against traditional RDBMS",
      "id": 2082,
      "title": "Record Layer query performance benchmarking against traditional RDBMS",
      "slug": "record-layer-query-performance-benchmarking-against-traditional-rdbms",
      "posts_count": 4,
      "reply_count": 0,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2020-04-20T18:46:55.680Z",
      "last_posted_at": "2020-04-22T15:51:53.223Z",
      "bumped": true,
      "bumped_at": "2020-04-22T15:51:53.223Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 1528,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 712,
            "username": "rahul-nitkkr",
            "name": "Rahul Roy",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rahul-nitkkr/{size}/754_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 34,
            "username": "scgray",
            "name": "Scott Gray",
            "avatar_template": "/user_avatar/forums.foundationdb.org/scgray/{size}/30_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Bulk load in Record Layer is slow",
      "id": 1794,
      "title": "Bulk load in Record Layer is slow",
      "slug": "bulk-load-in-record-layer-is-slow",
      "posts_count": 4,
      "reply_count": 2,
      "highest_post_number": 4,
      "image_url": null,
      "created_at": "2019-12-03T12:07:54.035Z",
      "last_posted_at": "2019-12-04T15:33:58.759Z",
      "bumped": true,
      "bumped_at": "2019-12-04T15:33:58.759Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1284,
      "category_id": 12,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 545,
            "username": "rishabh",
            "name": "Rishabh",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rishabh/{size}/540_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 219,
            "username": "MMcM",
            "name": "Mike McMahon",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 34,
            "username": "scgray",
            "name": "Scott Gray",
            "avatar_template": "/user_avatar/forums.foundationdb.org/scgray/{size}/30_2.png",
            "trust_level": 1
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 8,
        "username": "alloc",
        "name": "Alec Grieser",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 653,
        "username": "VibhutiD",
        "name": "Vibhuti Dembi",
        "avatar_template": "/user_avatar/forums.foundationdb.org/vibhutid/{size}/668_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 653,
      "username": "VibhutiD",
      "name": "Vibhuti Dembi",
      "avatar_template": "/user_avatar/forums.foundationdb.org/vibhutid/{size}/668_2.png"
    },
    "last_poster": {
      "id": 8,
      "username": "alloc",
      "name": "Alec Grieser",
      "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png"
    },
    "links": [
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.Builder.html",
        "title": "OnlineIndexer.Builder (fdb-record-layer-core-pb3 2.10.141.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 19,
        "user_id": 8,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://github.com/FoundationDB/fdb-record-layer/issues/1045",
        "title": "Document index building and options more thoroughly \u00b7 Issue #1045 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 18,
        "user_id": 8,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.141.0/com/apple/foundationdb/record/provider/foundationdb/OnlineIndexer.html#splitIndexBuildRange(int,int)",
        "title": "OnlineIndexer (fdb-record-layer-core-pb3 2.10.141.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 9,
        "user_id": 8,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      }
    ]
  },
  "bookmarks": []
}