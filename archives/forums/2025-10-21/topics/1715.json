{
  "post_stream": {
    "posts": [
      {
        "id": 5454,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-05T12:13:50.977Z",
        "cooked": "<p>We have a number of workers, each operating on an individual set of keys. Each worker periodically runs a transaction where it reads and updates its own keys.</p>\n<p>We\u2019ve encountered high latencies on these transactions reaching 2 seconds when running 1000 workers, with period 200ms (5 writes per second per worker). The strange thing is that when we remove the delay between transactions (i.e. write as fast as we can), the latencies get back to 30-130ms.</p>\n<p>Below are the metrics when running with delays:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f.png\" data-download-href=\"/uploads/short-url/wVtwtZIVSJncH5zjHWftsWzJh5d.png?dl=1\" title=\"image.png\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_690x122.png\" alt=\"image\" data-base62-sha1=\"wVtwtZIVSJncH5zjHWftsWzJh5d\" width=\"690\" height=\"122\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_690x122.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_1035x183.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_1380x244.png 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_10x10.png\"><div class=\"meta\">\n<svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">image.png</span><span class=\"informations\">1780\u00d7316 98.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg>\n</div></a></div></p>\n<p>The first panel shows the latency of executing a single transaction including retries.<br>\nThe second panel shows the overall rate of transactions among all workers per second.<br>\nThe third panel shows the overall rate of transaction retries per second.</p>\n<p>Here\u2019s the rate of conflicts that we got from <code>status json</code>:</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/da769fe363191fa69f345a9200bb9e3f337429eb.png\" alt=\"image\" data-base62-sha1=\"vaCeUwWCsJ1Yao4yH74Zc5zkT2z\" width=\"368\" height=\"317\"></p>\n<p>When running without delays, we observed stable low latencies, despite increased overall write rate. Also, we had ~8 times fewer transaction retries.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c.png\" data-download-href=\"/uploads/short-url/w5HOmKaQomruPKf6mBSb8nuMs44.png?dl=1\" title=\"image.png\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c_2_690x123.png\" alt=\"image\" data-base62-sha1=\"w5HOmKaQomruPKf6mBSb8nuMs44\" width=\"690\" height=\"123\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c_2_690x123.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c_2_1035x184.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c_2_1380x246.png 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c_2_10x10.png\"><div class=\"meta\">\n<svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">image.png</span><span class=\"informations\">1781\u00d7318 76.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg>\n</div></a></div></p>\n<p>At the same time, <code>status json</code> showed ~8 times <strong>more</strong> transaction conflicts:</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/59225441a6868502d533b1e3a9b5cedc0c825cbe.png\" alt=\"image\" data-base62-sha1=\"cIw2LLDOhFmnHmBWExt9UpIH3wG\" width=\"368\" height=\"314\"></p>\n<p>We monitored the reasons for the retries, and in all cases, it was error code 1009 (Request for future version).</p>\n<p>What may have caused this? It\u2019s surprising that increased load leads to lower latencies. It\u2019s also strange that there are fewer retries despite more transaction conflicts.</p>\n<p>We\u2019re using FoundationDB v6.2.7.<br>\nOur app is built on <a href=\"https://github.com/josephg/node-foundationdb\" rel=\"nofollow noopener\">node-foundationdb</a> with FDB client v6.2.7.</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-05T12:13:50.977Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 364,
        "reads": 93,
        "readers_count": 92,
        "score": 1838.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/josephg/node-foundationdb",
            "internal": false,
            "reflection": false,
            "title": "GitHub - josephg/node-foundationdb: Modern Node.js FoundationDB bindings",
            "clicks": 1
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/e0eab52da8b624049f7b6f0b7e825073bf519f6c.png",
            "internal": false,
            "reflection": false,
            "title": "e0eab52da8b624049f7b6f0b7e825073bf519f6c.png",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f.png",
            "internal": false,
            "reflection": false,
            "title": "e6c4d4687de20f3c4dc13128e9c17631f370788f.png",
            "clicks": 0
          },
          {
            "url": "https://forums.foundationdb.org/t/transaction-is-too-old-to-perform-reads-or-be-committed-and-request-for-future-version/1857/2",
            "internal": true,
            "reflection": true,
            "title": "Transaction is too old to perform reads or be committed AND Request for future version",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 5459,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-11-05T20:44:40.192Z",
        "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"aikoven\" data-post=\"1\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/aikoven/48/535_2.png\" class=\"avatar\"> aikoven:</div>\n<blockquote>\n<p>High rate of transaction retries with error code 1009 (Request for future version)</p>\n</blockquote>\n</aside>\n<p><code>future_version</code>  is an error that you receive when a transaction receives a read version from the proxy, and then uses it to do a read at a storage server that hasn\u2019t caught up to that version within 1 second. Typically, receiving this error means that your storage servers are lagging behind. You\u2019d want to check <code>max(cluster.processes.&lt;process_id&gt;.roles[n].data_lag.seconds )</code> from <code>status json</code> for storage roles. In most cases, this would mean that your write throughput is higher (or more focused on one key) than what your current storage servers can handle. If this is a sustained, regular workload for you, then you should add additional storage servers to the cluster. But it\u2019d be good if you\u2019re able to check storage server CPU and disk utilization as well.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"aikoven\" data-post=\"1\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/aikoven/48/535_2.png\" class=\"avatar\"> aikoven:</div>\n<blockquote>\n<p>We have a number of workers, each operating on an individual set of keys. Each worker periodically runs a transaction where it reads and updates its own keys. \u2026 Here\u2019s the rate of conflicts that we got from status json:</p>\n</blockquote>\n</aside>\n<p>I\u2019m confused about where your conflicts are coming from. The workload that you describe makes it sound like you\u2019ve already partitioned all of your workers apart in the keyspace, and therefore they shouldn\u2019t be conflicting at all?</p>\n<p>The graph of transaction conflicts is somewhat less meaningful without knowing how many transaction successes there were. Our graphs track this as a \u201cpercentage of transactions that conflict\u201d, which then lets you know if 100 conflicts is a lot or a little.</p>\n<aside class=\"quote no-group\" data-username=\"aikoven\" data-post=\"1\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/aikoven/48/535_2.png\" class=\"avatar\"> aikoven:</div>\n<blockquote>\n<p>We\u2019ve encountered high latencies on these transactions reaching 2 seconds when running 1000 workers, with period 200ms (5 writes per second per worker). The strange thing is that when we remove the delay between transactions (i.e. write as fast as we can), the latencies get back to 30-130ms.</p>\n</blockquote>\n</aside>\n<p>Combined with your other graphs, sounds like the most likely explanation would be that somehow you\u2019ve acquired a read version (ie. did a read), and  <em>then</em>  did the wait? Otherwise, is your wait happening in such a way that it\u2019s stacking up multiple conflicting workers to start at about the same time? I could see an argument that a continuous stream of transactions would cause clients to settle into a mutually avoidant pattern, but random waits could cause unpredictable p99 latency.</p>\n<p>It\u2019s strange to me that your graphs show some stretches of minutes as being fine and low latency, and then some minutes where you\u2019ve completely fallen off of a latency cliff. I have less good suggestions coming off the top of my head for this, but I shall ponder a bit longer\u2026</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-05T21:18:40.530Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 6,
        "reads": 79,
        "readers_count": 78,
        "score": 50.8,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5464,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-06T08:49:12.785Z",
        "cooked": "<p>Thanks for a quick response.</p>\n<p>Here\u2019s the data lag from the same time period when running 1000 workers with 200ms delays:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/1df6fda3cec215c204c92c050817bf5323f1b777.png\" data-download-href=\"/uploads/short-url/4h51mnmslktztFBbI0pbWTWUlcX.png?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/1df6fda3cec215c204c92c050817bf5323f1b777_2_517x316.png\" alt=\"image\" data-base62-sha1=\"4h51mnmslktztFBbI0pbWTWUlcX\" width=\"517\" height=\"316\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/1df6fda3cec215c204c92c050817bf5323f1b777_2_517x316.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/1df6fda3cec215c204c92c050817bf5323f1b777_2_775x474.png 1.5x, https://global.discourse-cdn.com/foundationdb/original/1X/1df6fda3cec215c204c92c050817bf5323f1b777.png 2x\" data-dominant-color=\"242527\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1032\u00d7632 33.4 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div><br>\n<em>(Don\u2019t mind different time, just moved to a different timezone)</em></p>\n<p>Here\u2019s the data lag without delays:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9.png\" data-download-href=\"/uploads/short-url/klGpDoL1hFzyQosyBe5X3jB7EFz.png?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9_2_517x315.png\" alt=\"image\" data-base62-sha1=\"klGpDoL1hFzyQosyBe5X3jB7EFz\" width=\"517\" height=\"315\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9_2_517x315.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9_2_775x472.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9_2_1034x630.png 2x\" data-dominant-color=\"232325\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1048\u00d7640 18.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>We currently have 12 storage processes, none of which use more than 20% of one CPU core. Disk utilization (<code>cluster.processes.&lt;pid&gt;.disk.busy</code>) is less than 10%.</p>\n<p>Anyway, if the reason was resource saturation, how would it be less saturated with a heavier workload?</p>\n<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"2\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>The graph of transaction conflicts is somewhat less meaningful without knowing how many transaction successes there were. Our graphs track this as a \u201cpercentage of transactions that conflict\u201d, which then lets you know if 100 conflicts is a lot or a little.</p>\n</blockquote>\n</aside>\n<p>The number of transactions is about the same as in the <code>Write Rate</code> graph. So the percentage of conflicts is very small in both cases. However, there are much more retries than conflicts. The <code>Transaction Confilcts</code> graph is taken from <code>status json</code>, and the <code>Transaction Retries</code> comes from our app and is measured using counter that is incremented when transaction commit is rejected.</p>\n<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"2\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>Combined with your other graphs, sounds like the most likely explanation would be that somehow you\u2019ve acquired a read version (ie. did a read), and <em>then</em> did the wait? Otherwise, is your wait happening in such a way that it\u2019s stacking up multiple conflicting workers to start at about the same time? I could see an argument that a continuous stream of transactions would cause clients to settle into a mutually avoidant pattern, but random waits could cause unpredictable p99 latency.</p>\n</blockquote>\n</aside>\n<p>No, we only wait <em>after</em> a transaction successfully completes. I\u2019ll try to experiment with randomizing delays, though I think that transactions should already be enough distributed in time due to variance in latencies.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-06T10:13:49.701Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 73,
        "readers_count": 72,
        "score": 19.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/1df6fda3cec215c204c92c050817bf5323f1b777.png",
            "internal": false,
            "reflection": false,
            "title": "1df6fda3cec215c204c92c050817bf5323f1b777.png",
            "clicks": 0
          },
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9.png",
            "internal": false,
            "reflection": false,
            "title": "8e9efad4d0a459b12e4a30f2149ed42c93fb7ba9.png",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5466,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-06T11:28:33.939Z",
        "cooked": "<p>I tried to add \u00b150% randomization for delays, and it fixed the issue! Latencies are consistently low and there are no retries at all.</p>\n<p>But I still don\u2019t understand how to interpret this. Could it be an issue with <code>node-foundationdb</code>? Or is it expected for any client?</p>\n<p>In our test, we run 100 workers per instance, with 10 instances. Could it be that there\u2019s some sort of contention inside one client resulting in <code>1009</code> errors?</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-06T11:28:33.939Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 67,
        "readers_count": 66,
        "score": 38.4,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 539,
          "username": "aikoven",
          "name": "Daniel Lytkin",
          "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5487,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2019-11-07T07:14:32.506Z",
        "cooked": "<p>I don\u2019t think any slowdown or stall on the client side would generate future_version errors. if anything it would manifest as past_version errors and retries, because the read version of the transaction would be obsolete once the client comes back to life and resumes reading.</p>\n<p>Maybe if the client would stall just as a lot of transactions are about to commit, then all the sudden send all the commits all at once in a burst, saturating the cluster for that brief moment, causing future_version errors, and for some reason, starting a new batch of transactions and stalling again before they commit? This could create very brief spikes of activity followed by idle periods, manifesting as low average CPU usage?</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-07T07:14:32.506Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 68,
        "readers_count": 67,
        "score": 28.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 539,
          "username": "aikoven",
          "name": "Daniel Lytkin",
          "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5489,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-07T10:18:55.152Z",
        "cooked": "<p>I can\u2019t see considerable difference in CPU or disk usage. None exceeds 40%. However, it may be that spikes are between metric scrapes so they aren\u2019t seen. Scrape interval is currently 10 seconds.</p>\n<p>Is there something else I can monitor in <code>status json</code> that indicates saturation?</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-07T10:59:07.991Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 66,
        "readers_count": 65,
        "score": 13.2,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5500,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-08T18:33:20.798Z",
        "cooked": "<p>I\u2019ve tracked it down to growing <code>durability_lag</code>.</p>\n<p>As far as I understand, it stands for a queue of data already received by storage process, but not yet written to disk. However, I can\u2019t see disk nor CPU saturation:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a.png\" data-download-href=\"/uploads/short-url/bsKnfmDvHQVr0cSoOk7JkzglDu2.png?dl=1\" title=\"image.png\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a_2_690x114.png\" alt=\"image\" data-base62-sha1=\"bsKnfmDvHQVr0cSoOk7JkzglDu2\" width=\"690\" height=\"114\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a_2_690x114.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a_2_1035x171.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a_2_1380x228.png 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a_2_10x10.png\"><div class=\"meta\">\n<svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">image.png</span><span class=\"informations\">2456\u00d7406 52.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg>\n</div></a></div></p>\n<p>The disk is used individually by this storage process. What else could be a bottleneck here?</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-08T18:33:20.798Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 63,
        "readers_count": 62,
        "score": 17.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/5057d4c4f600ee29ae5317943133c039c5b10d5a.png",
            "internal": false,
            "reflection": false,
            "title": "5057d4c4f600ee29ae5317943133c039c5b10d5a.png",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5606,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-11-19T08:21:55.112Z",
        "cooked": "<p>Hmm, I\u2019m seeing exactly the same symptoms (some 1009 errors, and a strangely high p100 response rate on a very unloaded cluster). Checking my data and durability lags I have:</p>\n<pre><code class=\"lang-auto\">            \"worst_data_lag_storage_server\" : {\n                \"seconds\" : 0,\n                \"versions\" : 0\n            },\n            \"worst_durability_lag_storage_server\" : {\n                \"seconds\" : 14.2851,\n                \"versions\" : 14285095\n            },\n</code></pre>\n<p>What would be the best way to debug this? I also have 14 processes: 2 logs, 12 storage.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T08:21:55.112Z",
        "reply_count": 2,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 66,
        "readers_count": 65,
        "score": 28.2,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5607,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2019-11-19T09:20:11.907Z",
        "cooked": "<p>Can you capture  a few status json samples while this problem is occurring and post it back here?</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T11:17:55.442Z",
        "reply_count": 0,
        "reply_to_post_number": 8,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 65,
        "readers_count": 64,
        "score": 18.0,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 260,
          "username": "jared2501",
          "name": "Jared2501",
          "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5613,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-11-19T21:37:16.342Z",
        "cooked": "<p>Hey gaurav,</p>\n<p>Attached are some status jsons. It\u2019s hard to say exactly when this issue is occurring since it\u2019s somewhat sporadic, and we (unfortunately) don\u2019t have super good telemetry on it, but I did notice some of these errors bubble up to our API around this time. If these aren\u2019t super helpful, happy to instrument things a bit more.</p>\n<p>stats jsons git link: <a href=\"https://gist.github.com/jared2501/67ab5209911acd4aab5c0ef23067d5c0\" rel=\"nofollow noopener\">https://gist.github.com/jared2501/67ab5209911acd4aab5c0ef23067d5c0</a></p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T21:41:28.308Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 61,
        "readers_count": 60,
        "score": 12.2,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://gist.github.com/jared2501/67ab5209911acd4aab5c0ef23067d5c0",
            "internal": false,
            "reflection": false,
            "title": "status_json1.txt \u00b7 GitHub",
            "clicks": 3
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5615,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-11-19T21:42:35.215Z",
        "cooked": "<p>One weird thing I noticed with the status jsons above is that the <code>limiting_durability_lag_storage_server</code> is <code>14.334199999999999</code>, but if you examine the <code>durability_lag</code> on all the storage servers they\u2019re all around 5.5s</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T21:42:35.215Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 60,
        "readers_count": 59,
        "score": 17.0,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5617,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2019-11-19T21:44:36.492Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"jared2501\" data-post=\"8\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/jared2501/48/266_2.png\" class=\"avatar\"> jared2501:</div>\n<blockquote>\n<p>14 processes: 2 logs, 12 storage</p>\n</blockquote>\n</aside>\n<p>You probably have a proxy or resolver on the same process as a storage server, so it\u2019s draining all the CPU from that storage server.  Your status jsons confirm this, see e.g. process <code>10.67.246.24:4504</code>.  Your cluster will become much happier if you add 4 stateless processes to it.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T21:53:42.396Z",
        "reply_count": 0,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 60,
        "readers_count": 59,
        "score": 27.0,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5618,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-11-19T21:48:36.742Z",
        "cooked": "<p>Ahh thanks heaps for the quick reply <a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a>! Got ya, sorry about the silly configuration, I tried to follow along in <a href=\"https://forums.foundationdb.org/t/cluster-tuning-cookbook/520\" class=\"inline-onebox\">Cluster tuning cookbook</a> but think I got a bit lost on the correct setup.</p>\n<p>So I have this:</p>\n<pre><code class=\"lang-auto\">fdb&gt; setclass\nThere are currently 14 processes in the database:\n  10.67.246.22:4500:tls: storage (set_class)\n  10.67.246.22:4501:tls: log (set_class)\n  10.67.246.22:4502:tls: storage (set_class)\n  10.67.246.22:4503:tls: storage (set_class)\n  10.67.246.22:4504:tls: storage (set_class)\n  10.67.246.24:4500:tls: storage (set_class)\n  10.67.246.24:4501:tls: log (set_class)\n  10.67.246.24:4502:tls: storage (set_class)\n  10.67.246.24:4503:tls: storage (set_class)\n  10.67.246.24:4504:tls: storage (set_class)\n  10.67.246.32:4500:tls: storage (set_class)\n  10.67.246.32:4501:tls: storage (set_class)\n  10.67.246.32:4502:tls: storage (set_class)\n  10.67.246.32:4503:tls: storage (set_class)\n</code></pre>\n<p>I\u2019m just gonna add 4 new processes to the cluster with a <code>stateless</code> class on each and will report back how that goes.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T21:48:36.742Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 104,
        "reads": 60,
        "readers_count": 59,
        "score": 532.0,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520",
            "internal": true,
            "reflection": false,
            "title": "Cluster tuning cookbook",
            "clicks": 8
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5620,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-11-19T22:09:03.226Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"jared2501\" data-post=\"11\" data-topic=\"1715\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/jared2501/48/266_2.png\" class=\"avatar\"> jared2501:</div>\n<blockquote>\n<p>One weird thing I noticed with the status jsons above is that the <code>limiting_durability_lag_storage_server</code> is <code>14.334199999999999</code> , but if you examine the <code>durability_lag</code> on all the storage servers they\u2019re all around 5.5s</p>\n</blockquote>\n</aside>\n<p>I just discovered this recently as well. I think what\u2019s happening is that the \u201climiting\u201d statistic you get comes from ratekeeper, which is using smoothers on the source data. It uses a 1s smoother on the latest version and a 10s smoother on the durable version, and this makes the apparent difference between the two larger.</p>\n<p>I\u2019ll go create an issue for this now.</p>\n<p>Updating to add a link to the issue: <a href=\"https://github.com/apple/foundationdb/issues/2367\" class=\"inline-onebox\">Status reports inaccurate limiting durability lag due to smoothing in ratekeeper \u00b7 Issue #2367 \u00b7 apple/foundationdb \u00b7 GitHub</a></p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-19T22:14:47.413Z",
        "reply_count": 0,
        "reply_to_post_number": 11,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 56,
        "readers_count": 55,
        "score": 71.2,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/issues/2367",
            "internal": false,
            "reflection": false,
            "title": "Status reports inaccurate limiting durability lag due to smoothing in ratekeeper \u00b7 Issue #2367 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 7
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5624,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-11-20T01:27:26.246Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> ah yup I see, thanks!</p>\n<p>I added 4 stateless processes to my cluster and have let it settle over the last 4 hours. Unfortunately, I\u2019m still seeing some sporadic 1009 errors.</p>\n<pre><code class=\"lang-auto\">fdb&gt; setclass\nThere are currently 18 processes in the database:\n  10.67.246.22:4500:tls: storage (set_class)\n  10.67.246.22:4501:tls: log (set_class)\n  10.67.246.22:4502:tls: storage (set_class)\n  10.67.246.22:4503:tls: storage (set_class)\n  10.67.246.22:4504:tls: storage (set_class)\n  10.67.246.22:4505:tls: stateless (set_class)\n  10.67.246.24:4500:tls: storage (set_class)\n  10.67.246.24:4501:tls: log (set_class)\n  10.67.246.24:4502:tls: storage (set_class)\n  10.67.246.24:4503:tls: storage (set_class)\n  10.67.246.24:4504:tls: storage (set_class)\n  10.67.246.24:4505:tls: stateless (set_class)\n  10.67.246.32:4500:tls: storage (set_class)\n  10.67.246.32:4501:tls: storage (set_class)\n  10.67.246.32:4502:tls: storage (set_class)\n  10.67.246.32:4503:tls: storage (set_class)\n  10.67.246.32:4504:tls: stateless (set_class)\n  10.67.246.32:4505:tls: stateless (set_class)\n</code></pre>\n<p>status json: <a href=\"https://gist.github.com/jared2501/74902e2f0ccbcf4fb35547264875a23c\" rel=\"nofollow noopener\">https://gist.github.com/jared2501/74902e2f0ccbcf4fb35547264875a23c</a></p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-20T01:27:26.246Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 55,
        "readers_count": 54,
        "score": 21.0,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://gist.github.com/jared2501/74902e2f0ccbcf4fb35547264875a23c",
            "internal": false,
            "reflection": false,
            "title": "status_json3.txt \u00b7 GitHub",
            "clicks": 4
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5681,
        "name": "Daniel Lytkin",
        "username": "aikoven",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "created_at": "2019-11-28T07:25:53.616Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"aikoven\" data-post=\"7\" data-topic=\"1715\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/aikoven/48/535_2.png\" class=\"avatar\"> aikoven:</div>\n<blockquote>\n<p>I\u2019ve tracked it down to growing <code>durability_lag</code> .</p>\n</blockquote>\n</aside>\n<p>After digging some more, I\u2019ve found that 1009 errors don\u2019t always correlate to high <code>durability_lag</code>.</p>\n<p>In my latest test, I do some 500 writes per second. Starting on an empty database, everything is fine for some time, but after a while, I start getting retries:</p>\n<p><img src=\"https://global.discourse-cdn.com/foundationdb/original/1X/7b4dafc292756a69e94c02151f61527691f15785.png\" alt=\"image\" data-base62-sha1=\"hANaDt70YcXdkBdQYaV6ivvEPGZ\" width=\"332\" height=\"158\"></p>\n<p>I don\u2019t see any considerable change in <code>data_lag</code> nor <code>durability_lag</code>.</p>\n<p>When I restart the writer, I get retries from the start.</p>\n<p>Surprisingly, when I add another writer effectively doubling the load, all retries go away:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943.png\" data-download-href=\"/uploads/short-url/5XL9ExjZNSfewVDHwVHhMm16wld.png?dl=1\" title=\"image\" rel=\"noopener nofollow ugc\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943_2_517x123.png\" alt=\"image\" data-base62-sha1=\"5XL9ExjZNSfewVDHwVHhMm16wld\" width=\"517\" height=\"123\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943_2_517x123.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943_2_775x184.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943_2_1034x246.png 2x\" data-dominant-color=\"262728\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1338\u00d7321 26.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-28T07:25:53.616Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 3,
        "reads": 51,
        "readers_count": 50,
        "score": 30.2,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Daniel Lytkin",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943.png",
            "internal": false,
            "reflection": false,
            "title": "29cc3d1c1cb53ff44c7f09b69c8f2269f8c5c943.png",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 539,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5683,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2019-11-29T02:51:18.391Z",
        "cooked": "<p>Do you have sample code that can be tested by others on their setup?</p>\n<p>I started writing some hypothesis on lines of:</p>\n<blockquote>\n<p>\u2026if you are doing back-to-back writes and reads, it may result in clients requesting for a version from Storage Server that SS hasn\u2019t yet pulled in from tLogs. And when you increase the write load, it could be that client or proxy is introducing some additional latency (like batching) that gives SS enough time to pull the latest mutations from tLogs\u2026</p>\n</blockquote>\n<p>, but, then I got confused about how SS keeps in sync with tLogs. I am not sure why we do not see much more of these future_version errors in our code?</p>\n<p>Typically, workloads are always doing many concurrent transactions that involve both reads and writes. So, in practice, SS should always be behind TLOGS by at-least a few millis (in best case), and up to a few seconds (in average case)?</p>\n<p>If that is so, then one should expect to see these errors much more frequently; but we don\u2019t see those in practice. So, clearly I am missing something important here.</p>\n<p><a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a> <a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> could you please help with the doubt above (apologies, if this is already mentioned somewhere in some architecture doc or post)</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-11-29T02:51:18.391Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 48,
        "readers_count": 47,
        "score": 24.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 539,
          "username": "aikoven",
          "name": "Daniel Lytkin",
          "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5688,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2019-12-02T16:43:40.303Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"gaurav\" data-post=\"17\" data-topic=\"1715\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/g/b487fb/48.png\" class=\"avatar\"> gaurav:</div>\n<blockquote>\n<p>If that is so, then one should expect to see these errors much more frequently; but we don\u2019t see those in practice. So, clearly I am missing something important here.</p>\n<p><a class=\"mention\" href=\"/u/alexmiller\">@alexmiller</a> <a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> could you please help with the doubt above (apologies, if this is already mentioned somewhere in some architecture doc or post)</p>\n</blockquote>\n</aside>\n<p>There are a few factors at play here that could result in you not seeing frequent <code>future_version</code> errors. First, in order for a client to attempt to read at a version, they will need to request and receive a read version from the proxies and then issue the read. During this time, the data will be moving from the logs to the storage servers, and if they are keeping up well the data could be there before you want to read it.</p>\n<p>Second, a storage server won\u2019t fail with a future version immediately if it gets a request for a read that is in the future. Instead, it will wait for 1 second to see if the requested version shows up. This could introduce latency to your early reads if they are arriving before the data, but it will result in the read succeeding.</p>\n<p>Last, the future version error is a retryable one, so depending on how you run your transactions you might not even see it when it\u2019s happening. The default retry loops, for example, will not give you any indication that they retried due to a future version error. You can, however, see a count of future version errors in the client trace logs in the <code>TransactionMetrics</code> event. You could also write your own retry loop that logs errors in some way so that you could see them.</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-12-02T16:44:15.916Z",
        "reply_count": 1,
        "reply_to_post_number": 17,
        "quote_count": 1,
        "incoming_link_count": 5,
        "reads": 53,
        "readers_count": 52,
        "score": 40.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5715,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2019-12-04T14:38:57.134Z",
        "cooked": "<p>Thanks AJ.<br>\nWe do have a custom retry loop and track all sorts of exceptions - we do not encounter frequent 1009 errors</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-12-04T14:38:57.134Z",
        "reply_count": 0,
        "reply_to_post_number": 18,
        "quote_count": 0,
        "incoming_link_count": 17,
        "reads": 54,
        "readers_count": 53,
        "score": 95.8,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 5856,
        "name": "Jared2501",
        "username": "jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "created_at": "2019-12-17T18:45:25.610Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> I was looking through the code and noticed the 1 second sleep.  This explains this graph of our read/write and read/read transactions (where the p100 response time for a transaction is a few 10s of ms over 1 second:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://global.discourse-cdn.com/foundationdb/original/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01.png\" data-download-href=\"/uploads/short-url/m0FoxSGvybnmHc2nIjkQXpcvnC9.png?dl=1\" title=\"image\" rel=\"nofollow noopener\"><img src=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01_2_690x145.png\" alt=\"image\" data-base62-sha1=\"m0FoxSGvybnmHc2nIjkQXpcvnC9\" width=\"690\" height=\"145\" srcset=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01_2_690x145.png, https://global.discourse-cdn.com/foundationdb/optimized/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01_2_1035x217.png 1.5x, https://global.discourse-cdn.com/foundationdb/optimized/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01_2_1380x290.png 2x\" data-small-upload=\"https://global.discourse-cdn.com/foundationdb/optimized/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01_2_10x10.png\"><div class=\"meta\">\n<svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1984\u00d7418 58.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use xlink:href=\"#discourse-expand\"></use></svg>\n</div></a></div></p>\n<p>Is that 1 second wait time a maximum wait time, or does the read ALWAYS wait 1 second and then try again (these metrics suggest the latter)?</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 40,
        "updated_at": "2019-12-17T18:45:25.610Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 58,
        "readers_count": 57,
        "score": 21.6,
        "yours": false,
        "topic_id": 1715,
        "topic_slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
        "display_username": "Jared2501",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://global.discourse-cdn.com/foundationdb/original/1X/9a4326124b0d321b5f5d6e3f5d71907666585b01.png",
            "internal": false,
            "reflection": false,
            "title": "9a4326124b0d321b5f5d6e3f5d71907666585b01.png",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 260,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version/1715/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      5454,
      5459,
      5464,
      5466,
      5487,
      5489,
      5500,
      5606,
      5607,
      5613,
      5615,
      5617,
      5618,
      5620,
      5624,
      5681,
      5683,
      5688,
      5715,
      5856,
      5858,
      5884,
      5925,
      5926,
      5927,
      5928,
      5958,
      5959,
      6055,
      6059,
      6064,
      6073,
      6076,
      6077,
      6079,
      6084,
      6087,
      6090,
      6099,
      6866
    ]
  },
  "timeline_lookup": [
    [
      1,
      2177
    ],
    [
      4,
      2176
    ],
    [
      7,
      2174
    ],
    [
      8,
      2164
    ],
    [
      10,
      2163
    ],
    [
      16,
      2155
    ],
    [
      17,
      2154
    ],
    [
      18,
      2150
    ],
    [
      19,
      2148
    ],
    [
      20,
      2135
    ],
    [
      22,
      2132
    ],
    [
      23,
      2115
    ],
    [
      27,
      2108
    ],
    [
      29,
      2094
    ],
    [
      32,
      2093
    ],
    [
      36,
      2092
    ],
    [
      39,
      2091
    ],
    [
      40,
      2001
    ]
  ],
  "tags": [
    "performance"
  ],
  "tags_descriptions": {},
  "fancy_title": "High rate of transaction retries with error code 1009 (Request for future version)",
  "id": 1715,
  "title": "High rate of transaction retries with error code 1009 (Request for future version)",
  "posts_count": 40,
  "created_at": "2019-11-05T12:13:50.883Z",
  "views": 5148,
  "reply_count": 12,
  "like_count": 5,
  "last_posted_at": "2020-04-30T06:36:21.616Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "high-rate-of-transaction-retries-with-error-code-1009-request-for-future-version",
  "category_id": 7,
  "word_count": 10702,
  "deleted_at": null,
  "user_id": 539,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_1024x181.png",
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1715",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 41,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 6,
  "show_read_indicator": false,
  "thumbnails": [
    {
      "max_width": null,
      "max_height": null,
      "width": 1780,
      "height": 316,
      "url": "https://global.discourse-cdn.com/foundationdb/original/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f.png"
    },
    {
      "max_width": 1024,
      "max_height": 1024,
      "width": 1024,
      "height": 181,
      "url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/e6c4d4687de20f3c4dc13128e9c17631f370788f_2_1024x181.png"
    }
  ],
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 53,
        "username": "KrzysFR",
        "name": "Christophe Chevalier",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "post_count": 12,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 260,
        "username": "jared2501",
        "name": "Jared2501",
        "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png",
        "post_count": 8,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 539,
        "username": "aikoven",
        "name": "Daniel Lytkin",
        "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png",
        "post_count": 6,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 166,
        "username": "gaurav",
        "name": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 539,
      "username": "aikoven",
      "name": "Daniel Lytkin",
      "avatar_template": "/user_avatar/forums.foundationdb.org/aikoven/{size}/535_2.png"
    },
    "last_poster": {
      "id": 260,
      "username": "jared2501",
      "name": "Jared2501",
      "avatar_template": "/user_avatar/forums.foundationdb.org/jared2501/{size}/266_2.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/cluster-tuning-cookbook/520",
        "title": "Cluster tuning cookbook",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 8,
        "user_id": 260,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://github.com/apple/foundationdb/issues/2367",
        "title": "Status reports inaccurate limiting durability lag due to smoothing in ratekeeper \u00b7 Issue #2367 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 12,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://gist.github.com/jared2501/74902e2f0ccbcf4fb35547264875a23c",
        "title": "status_json3.txt \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 260,
        "domain": "gist.github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/pull/2617",
        "title": "Fix: storage server version could fail to advance in response to empty commits by ajbeamon \u00b7 Pull Request #2617 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 12,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://gist.github.com/jared2501/67ab5209911acd4aab5c0ef23067d5c0",
        "title": "status_json1.txt \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 260,
        "domain": "gist.github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/Doxense/foundationdb-dotnet-client/blob/1e8d626923e7469cd06494e5941433e6c21da8f4/FoundationDB.Layers.Common/Collections/FdbQueue%601.cs#L113",
        "title": "foundationdb-dotnet-client/FdbQueue`1.cs at 1e8d626923e7469cd06494e5941433e6c21da8f4 \u00b7 Doxense/foundationdb-dotnet-client \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 53,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/josephg/node-foundationdb",
        "title": "GitHub - josephg/node-foundationdb: Modern Node.js FoundationDB bindings",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 539,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/8a065b9da4114e921f31c9145afa7033315b2e1c/fdbclient/NativeAPI.actor.cpp#L2646",
        "title": "foundationdb/NativeAPI.actor.cpp at 8a065b9da4114e921f31c9145afa7033315b2e1c \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 53,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/master/fdbserver/storageserver.actor.cpp#L3537",
        "title": "foundationdb/storageserver.actor.cpp at master \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 53,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}