{
  "post_stream": {
    "posts": [
      {
        "id": 7117,
        "name": "",
        "username": "v-pap",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "created_at": "2020-05-29T11:53:05.706Z",
        "cooked": "<p>I am running a cluster with 10 storage processes and 4 logs (one log is remaining idle) each running on its own machine. Each machine in the cluster has 4 cores, 12GB of RAM and one local nvme SSD. This setup can\u2019t handle more than 90K writes per second. All the storage processes in the cluster seem to be CPU limited since the CPU load is close to 100% (in the core that fdbserver is assigned to) especially when increasing the write rate. Meanwhile the Disk IO is relatively low never going further than 30%. The log processes seems to be fine with around 10% CPU load and 70-80% Disk IO. After getting feedback from several discussions here (<a href=\"https://forums.foundationdb.org/t/scalable-time-series-database-improving-write-throughput/2032/8\" class=\"inline-onebox\">Scalable time series database / Improving write throughput</a>) I have tried to optimize my writes by eliminating the need for reads in the same transaction (by using atomic ops) and at the same time, I try to keep my write transactions in the 10KB range. Do you have any recommendations on where I should focus my optimization efforts?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-05-29T11:53:05.706Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 290,
        "reads": 78,
        "readers_count": 77,
        "score": 1455.6,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/scalable-time-series-database-improving-write-throughput/2032/8",
            "internal": true,
            "reflection": false,
            "title": "Scalable time series database / Improving write throughput",
            "clicks": 9
          },
          {
            "url": "https://forums.foundationdb.org/t/storage-server-cpu-bottleneck-growing-data-lag/2234",
            "internal": true,
            "reflection": true,
            "title": "Storage Server CPU bottleneck - Growing data lag",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 744,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 7128,
        "name": "Steve Atherton",
        "username": "SteavedHams",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "created_at": "2020-05-29T23:38:45.154Z",
        "cooked": "<p>Do your storage server processes have any other roles recruited on them?  (see <code>Roles</code> details in log files)</p>\n<p>How large are your keys and values?</p>\n<p>What is your replication factor?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-05-29T23:38:45.154Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 76,
        "readers_count": 75,
        "score": 25.2,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "Steve Atherton",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 7,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7149,
        "name": "",
        "username": "v-pap",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "created_at": "2020-05-31T12:13:26.951Z",
        "cooked": "<ul>\n<li>\n<p>Yes they have other roles recruited to them. In a previous deployment I had set the stateless process count with some value in the kubernetes operator, but these machines were mostly idle, so in the next deployment I set it to -1.</p>\n</li>\n<li>\n<p>The keys are 60-100 bytes in size, the values are 8 bytes</p>\n</li>\n<li>\n<p>The replication factor is 2</p>\n</li>\n</ul>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-05-31T12:13:26.951Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 74,
        "readers_count": 73,
        "score": 19.8,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 7,
          "username": "SteavedHams",
          "name": "Steve Atherton",
          "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 744,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7150,
        "name": "Meng Xu",
        "username": "mengxu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "created_at": "2020-05-31T18:52:12.453Z",
        "cooked": "<p>A typical deployment uses two SSes (CPUs) for one disk for better disk IOPS utilization.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-05-31T18:52:12.453Z",
        "reply_count": 1,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 70,
        "readers_count": 69,
        "score": 29.0,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "Meng Xu",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 744,
          "username": "v-pap",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 337,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7158,
        "name": "",
        "username": "v-pap",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "created_at": "2020-06-01T10:45:22.673Z",
        "cooked": "<pre><code class=\"lang-auto\">apiVersion: v1\nitems:\n- apiVersion: apps.foundationdb.org/v1beta1\n  kind: FoundationDBCluster\n  metadata:\n    creationTimestamp: \"2020-05-26T13:53:06Z\"\n    generation: 11\n    labels:\n      app: fdb\n      chart: mist-0.1.0\n      controller-tools.k8s.io: \"1.0\"\n      heritage: Tiller\n      release: dogfood2\n    name: dogfood2-mist-fdb\n    namespace: mist2\n    resourceVersion: \"361948695\"\n    selfLink: /apis/apps.foundationdb.org/v1beta1/namespaces/mist2/foundationdbclusters/dogfood2-mist-fdb\n    uid: 5a69cdfd-3c91-44aa-9164-ec39134efcec\n  spec:\n    automationOptions: {}\n    configured: true\n    connectionString: dogfood2_mist_fdb:08zDDL09MjHx6c5FT8jZn6yV0Z4kdoBg@10.112.51.8:4501,10.112.60.4:4501,10.112.55.5:4501\n    customParameters:\n    - knob_disable_posix_kernel_aio=1\n    databaseConfiguration:\n      redundancy_mode: double\n      storage: 14\n      storage_engine: ssd\n      usable_regions: 1\n    faultDomain:\n      key: foundationdb.org/none\n    mainContainer: {}\n    podTemplate:\n      metadata:\n        creationTimestamp: null\n      spec:\n        containers:\n        - name: foundationdb\n          resources:\n            limits:\n              cpu: 3500m\n              memory: 8Gi\n            requests:\n              cpu: 2000m\n              memory: 4Gi\n          securityContext:\n            runAsUser: 0\n        - name: foundationdb-kubernetes-sidecar\n          securityContext:\n            runAsUser: 0\n        initContainers:\n        - name: foundationdb-kubernetes-init\n          resources: {}\n          securityContext:\n            runAsUser: 0\n        securityContext:\n          fsGroup: 0\n        tolerations:\n        - effect: NoSchedule\n          key: dedicated\n          operator: Equal\n          value: fdb\n    processCounts:\n      stateless: -1\n    runningVersion: 6.2.19\n    sidecarContainer: {}\n    storageClass: local-scsi\n    version: 6.2.19\n  status:\n    databaseConfiguration:\n      log_routers: -1\n      log_spill: 2\n      logs: 3\n      proxies: 3\n      redundancy_mode: double\n      remote_logs: -1\n      resolvers: 1\n      storage_engine: ssd-2\n      usable_regions: 1\n    generations:\n      reconciled: 11\n    health:\n      available: true\n      fullReplication: true\n    processCounts:\n      log: 4\n      storage: 14\n    requiredAddresses:\n      nonTLS: true\nkind: List\nmetadata:\n  resourceVersion: \"\"\n  selfLink: \"\"\n\n</code></pre>\n<p>As you can see the recruited processes have plenty of CPU cores to work with (2-4 cores), but from my measurements I can see that only one of these cores is being utilized. This is true even when the CPU\u2019s core load is close or at 100%.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-06-01T10:47:17.463Z",
        "reply_count": 0,
        "reply_to_post_number": 4,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 68,
        "readers_count": 67,
        "score": 28.6,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 337,
          "username": "mengxu",
          "name": "Meng Xu",
          "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 744,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7301,
        "name": "",
        "username": "v-pap",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "created_at": "2020-06-10T17:17:37.212Z",
        "cooked": "<p>I did an experiment in which I allowed the foundationdb cluster to recruit as many stateless process as it wants. But as you can see the storage processes are still CPU limited. I don\u2019t really know why that\u2019s the case, so any input would be valuable.</p>\n<pre><code class=\"lang-auto\">  Redundancy mode        - double\n  Storage engine         - ssd-2\n  Coordinators           - 3\n  Desired Proxies        - 3\n  Desired Resolvers      - 1\n  Desired Logs           - 3\n\nCluster:\n  FoundationDB processes - 26\n  Zones                  - 26\n  Machines               - 26\n  Memory availability    - 8.3 GB per process on machine with least available\n  Retransmissions rate   - 30 Hz\n  Fault Tolerance        - 1 machine\n  Server time            - 06/10/20 17:12:06\n\nData:\n  Replication health     - Healthy (Repartitioning)\n  Moving data            - 168.178 GB\n  Sum of key-value sizes - 625.783 GB\n  Disk space used        - 1.575 TB\n\nOperating space:\n  Storage server         - 242.2 GB free on most full server\n  Log server             - 354.4 GB free on most full server\n\nWorkload:\n  Read rate              - 4430 Hz\n  Write rate             - 73889 Hz\n  Transactions started   - 692 Hz\n  Transactions committed - 646 Hz\n  Conflict rate          - 1 Hz\n\nBackup and DR:\n  Running backups        - 0\n  Running DRs            - 0\n\nProcess performance details:\n  10.112.12.222:4501     (  5% cpu; 47% machine; 0.001 Gbps;  0% disk IO; 0.3 GB / 8.3 GB RAM  )\n  10.112.25.85:4501      ( 29% cpu; 28% machine; 0.078 Gbps;  0% disk IO; 0.4 GB / 8.8 GB RAM  )\n  10.112.28.202:4501     ( 22% cpu; 40% machine; 0.079 Gbps;  0% disk IO; 0.4 GB / 10.4 GB RAM  )\n  10.112.42.223:4501     ( 18% cpu; 11% machine; 0.080 Gbps;  0% disk IO; 0.3 GB / 9.9 GB RAM  )\n  10.112.49.139:4501     (  5% cpu; 50% machine; 0.001 Gbps;  1% disk IO; 0.3 GB / 10.1 GB RAM  )\n  10.112.51.8:4501       ( 65% cpu; 17% machine; 0.013 Gbps; 27% disk IO; 3.3 GB / 14.1 GB RAM  )\n  10.112.52.28:4501      ( 83% cpu; 23% machine; 0.023 Gbps; 28% disk IO; 2.7 GB / 14.1 GB RAM  )\n  10.112.53.5:4501       ( 18% cpu;  6% machine; 0.064 Gbps; 85% disk IO; 1.1 GB / 14.1 GB RAM  )\n  10.112.54.5:4501       ( 18% cpu;  6% machine; 0.057 Gbps; 90% disk IO; 1.0 GB / 14.1 GB RAM  )\n  10.112.55.10:4501      (111% cpu; 30% machine; 0.026 Gbps; 27% disk IO; 3.5 GB / 14.1 GB RAM  )\n  10.112.56.10:4501      (  0% cpu;  2% machine; 0.000 Gbps;  0% disk IO; 0.3 GB / 13.9 GB RAM  )\n  10.112.57.20:4501      (114% cpu; 31% machine; 0.037 Gbps; 27% disk IO; 3.6 GB / 14.1 GB RAM  )\n  10.112.58.21:4501      ( 91% cpu; 24% machine; 0.009 Gbps; 31% disk IO; 3.5 GB / 14.1 GB RAM  )\n  10.112.59.6:4501       ( 15% cpu;  5% machine; 0.040 Gbps; 94% disk IO; 0.6 GB / 14.1 GB RAM  )\n  10.112.60.13:4501      (110% cpu; 30% machine; 0.030 Gbps; 27% disk IO; 4.6 GB / 14.1 GB RAM  )\n  10.112.61.4:4501       (100% cpu; 28% machine; 0.142 Gbps; 32% disk IO; 3.5 GB / 14.1 GB RAM  )\n  10.112.62.3:4501       ( 96% cpu; 26% machine; 0.082 Gbps; 32% disk IO; 3.5 GB / 14.1 GB RAM  )\n  10.112.63.4:4501       ( 57% cpu; 16% machine; 0.005 Gbps; 24% disk IO; 3.6 GB / 14.1 GB RAM  )\n  10.112.64.3:4501       (109% cpu; 30% machine; 0.010 Gbps; 32% disk IO; 3.7 GB / 14.2 GB RAM  )\n  10.112.65.3:4501       (103% cpu; 28% machine; 0.011 Gbps; 32% disk IO; 3.6 GB / 14.1 GB RAM  )\n  10.112.70.37:4501      ( 90% cpu; 49% machine; 0.012 Gbps; 24% disk IO; 3.6 GB / 13.8 GB RAM  )\n  10.112.71.3:4501       ( 73% cpu; 42% machine; 0.017 Gbps; 29% disk IO; 3.4 GB / 13.8 GB RAM  )\n  10.112.72.3:4501       (106% cpu; 70% machine; 0.092 Gbps; 24% disk IO; 3.7 GB / 13.7 GB RAM  )\n  10.112.76.65:4501      ( 18% cpu; 45% machine; 0.010 Gbps;  0% disk IO; 0.3 GB / 10.5 GB RAM  )\n  10.112.82.20:4501      ( 22% cpu; 57% machine; 0.070 Gbps;  0% disk IO; 0.4 GB / 9.3 GB RAM  )\n  10.112.83.7:4501       (  3% cpu; 11% machine; 0.001 Gbps;  0% disk IO; 0.4 GB / 10.6 GB RAM  )\n\nCoordination servers:\n  10.112.52.28:4501  (reachable)\n  10.112.60.13:4501  (reachable)\n  10.112.64.3:4501  (reachable)\n\nClient time: 06/10/20 17:12:05\n\nfdb&gt; setclass\nThere are currently 26 processes in the database:\n  10.112.12.222:4501: stateless (command_line)\n  10.112.25.85:4501: stateless (command_line)\n  10.112.28.202:4501: stateless (command_line)\n  10.112.42.223:4501: stateless (command_line)\n  10.112.49.139:4501: stateless (command_line)\n  10.112.51.8:4501: storage (command_line)\n  10.112.52.28:4501: storage (command_line)\n  10.112.53.5:4501: log (command_line)\n  10.112.54.5:4501: log (command_line)\n  10.112.55.10:4501: storage (command_line)\n  10.112.56.10:4501: stateless (command_line)\n  10.112.57.20:4501: storage (command_line)\n  10.112.58.21:4501: storage (command_line)\n  10.112.59.6:4501: log (command_line)\n  10.112.60.13:4501: storage (command_line)\n  10.112.61.4:4501: storage (command_line)\n  10.112.62.3:4501: storage (command_line)\n  10.112.63.4:4501: storage (command_line)\n  10.112.64.3:4501: storage (command_line)\n  10.112.65.3:4501: storage (command_line)\n  10.112.70.37:4501: storage (command_line)\n  10.112.71.3:4501: storage (command_line)\n  10.112.72.3:4501: storage (command_line)\n  10.112.76.65:4501: stateless (command_line)\n  10.112.82.20:4501: stateless (command_line)\n  10.112.83.7:4501: stateless (command_line)\n</code></pre>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-06-10T17:17:37.212Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 67,
        "readers_count": 66,
        "score": 53.4,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 744,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7357,
        "name": "Russell Sears",
        "username": "sears",
        "avatar_template": "/user_avatar/forums.foundationdb.org/sears/{size}/887_2.png",
        "created_at": "2020-06-15T17:14:19.066Z",
        "cooked": "<p>In your most recent numbers, you have 14 storage servers.  Most are saturated, and all are busy.  That\u2019s good news, since it means your workload is distributed across many parts of the key space, and the client is offering sufficient concurrency to keep the cluster busy.</p>\n<p>I suspect that your NVME drives and network are basically idle in this setup.  iostat and nload should be able to confirm this.</p>\n<p>Can you try running with 2 and 4 storage servers per drive?  If I\u2019m right, that will increase your throughput.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-06-15T17:14:19.066Z",
        "reply_count": 1,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 60,
        "readers_count": 59,
        "score": 17.0,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "Russell Sears",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 744,
          "username": "v-pap",
          "name": "",
          "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 741,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 7395,
        "name": "",
        "username": "v-pap",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "created_at": "2020-06-18T15:24:16.719Z",
        "cooked": "<p>Well, thank you for your input but as far as I remember the kubernetes foundationdb operator doesn\u2019t support multiple storage processes on the same drive. One thing that actually helped with this situation was to actually remove the <code>knob_disable_posix_kernel_aio=1</code> parameter. Now the CPU load on the storage processes is around to 30-50% with the same workload.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2020-06-18T15:24:16.719Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 54,
        "readers_count": 53,
        "score": 20.8,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 741,
          "username": "sears",
          "name": "Russell Sears",
          "avatar_template": "/user_avatar/forums.foundationdb.org/sears/{size}/887_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 744,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9429,
        "name": "Steve Korshakov",
        "username": "ex3ndr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ex3ndr/{size}/389_2.png",
        "created_at": "2021-05-18T11:16:07.160Z",
        "cooked": "<p>I have the same behavior - high CPU usage on all my storage servers, and it doesn\u2019t look like it has saturated disk (adding more cores increases performance lineraly).</p>\n<p>I tried <code>knob_disable_posix_kernel_aio=1</code> and this made everything much worse.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-18T11:16:07.160Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 41,
        "readers_count": 40,
        "score": 13.2,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "Steve Korshakov",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 393,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 9431,
        "name": "Steve Korshakov",
        "username": "ex3ndr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ex3ndr/{size}/389_2.png",
        "created_at": "2021-05-18T11:29:51.842Z",
        "cooked": "<p>I have 9 storage servers with two processes (15 storage, 3 logs) in three different zones and machines have 2 cores (vCPU) and 8GB ram. I constantly get high usage.</p>\n<p>I had only 9 storage processes and increased it to 18, didn\u2019t change much.</p>\n<p>Disk is only 4k/iops (50/50 read/write) and 16mb/s. It is Google\u2019s local ssd\u2019s with and their\u2019s performance is orders magnitude higher, but CPU is full and barely able to utilize such disk.</p>\n<p>I am using FDB 6.2.20.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 10,
        "updated_at": "2021-05-18T11:29:51.842Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 41,
        "readers_count": 40,
        "score": 8.2,
        "yours": false,
        "topic_id": 2140,
        "topic_slug": "cpu-limited-storage-processes",
        "display_username": "Steve Korshakov",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 393,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/cpu-limited-storage-processes/2140/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      7117,
      7128,
      7149,
      7150,
      7158,
      7301,
      7357,
      7395,
      9429,
      9431
    ]
  },
  "timeline_lookup": [
    [
      1,
      1971
    ],
    [
      3,
      1969
    ],
    [
      5,
      1968
    ],
    [
      6,
      1959
    ],
    [
      7,
      1954
    ],
    [
      8,
      1951
    ],
    [
      9,
      1617
    ]
  ],
  "suggested_topics": [],
  "tags": [
    "performance"
  ],
  "tags_descriptions": {},
  "fancy_title": "CPU limited storage processes",
  "id": 2140,
  "title": "CPU limited storage processes",
  "posts_count": 10,
  "created_at": "2020-05-29T11:53:05.632Z",
  "views": 1567,
  "reply_count": 5,
  "like_count": 0,
  "last_posted_at": "2021-05-18T11:29:51.842Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "cpu-limited-storage-processes",
  "category_id": 7,
  "word_count": 1802,
  "deleted_at": null,
  "user_id": 744,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_2140",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 10,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 5,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "FoundationdDB Cluster Performance Issues",
      "id": 2105,
      "title": "FoundationdDB Cluster Performance Issues",
      "slug": "foundationddb-cluster-performance-issues",
      "posts_count": 12,
      "reply_count": 6,
      "highest_post_number": 12,
      "image_url": null,
      "created_at": "2020-05-06T16:01:40.124Z",
      "last_posted_at": "2020-10-21T15:20:11.071Z",
      "bumped": true,
      "bumped_at": "2020-10-21T15:20:11.071Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance",
        "operator"
      ],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1317,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 744,
            "username": "v-pap",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 765,
            "username": "rbtcollins",
            "name": "Robert Collins",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rbtcollins/{size}/941_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 3,
            "username": "john_brownlee",
            "name": "John Brownlee",
            "avatar_template": "/user_avatar/forums.foundationdb.org/john_brownlee/{size}/22_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Production optimizations",
      "id": 601,
      "title": "Production optimizations",
      "slug": "production-optimizations",
      "posts_count": 21,
      "reply_count": 14,
      "highest_post_number": 21,
      "image_url": null,
      "created_at": "2018-07-30T21:18:56.894Z",
      "last_posted_at": "2018-08-15T04:47:23.743Z",
      "bumped": true,
      "bumped_at": "2018-08-15T04:47:23.743Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 6,
      "views": 6473,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 311,
            "username": "ThomasJ",
            "name": "Thomas Johson",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/t/6f9a4e/{size}.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 255,
            "username": "aqua",
            "name": "Matt Lohier",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/b9bd4f/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "Storage Server CPU bottleneck - Growing data lag",
      "id": 2234,
      "title": "Storage Server CPU bottleneck - Growing data lag",
      "slug": "storage-server-cpu-bottleneck-growing-data-lag",
      "posts_count": 23,
      "reply_count": 18,
      "highest_post_number": 23,
      "image_url": "https://global.discourse-cdn.com/foundationdb/optimized/1X/e472648513de0e881bd62213804d5e43f9510ace_2_1023x568.png",
      "created_at": "2020-07-08T13:46:58.378Z",
      "last_posted_at": "2021-12-13T09:55:15.976Z",
      "bumped": true,
      "bumped_at": "2021-12-13T10:47:15.543Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 3083,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 744,
            "username": "v-pap",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 7,
            "username": "SteavedHams",
            "name": "Steve Atherton",
            "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 166,
            "username": "gaurav",
            "name": "gaurav",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 711,
            "username": "osamarin",
            "name": "Oleg Samarin",
            "avatar_template": "/user_avatar/forums.foundationdb.org/osamarin/{size}/905_2.png",
            "trust_level": 2
          }
        }
      ]
    },
    {
      "fancy_title": "Cluster tuning cookbook",
      "id": 520,
      "title": "Cluster tuning cookbook",
      "slug": "cluster-tuning-cookbook",
      "posts_count": 27,
      "reply_count": 19,
      "highest_post_number": 27,
      "image_url": null,
      "created_at": "2018-06-19T14:35:25.802Z",
      "last_posted_at": "2019-02-01T12:38:24.733Z",
      "bumped": true,
      "bumped_at": "2019-02-01T12:38:24.733Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 12,
      "views": 8885,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 310,
            "username": "shamatar",
            "name": "Alexander",
            "avatar_template": "/user_avatar/forums.foundationdb.org/shamatar/{size}/315_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 53,
            "username": "KrzysFR",
            "name": "Christophe Chevalier",
            "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 41,
            "username": "amirouche",
            "name": "Amirouche",
            "avatar_template": "/user_avatar/forums.foundationdb.org/amirouche/{size}/1911_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 502,
            "username": "nikolas.ioannou",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/5daacb/{size}.png",
            "trust_level": 1
          }
        }
      ]
    },
    {
      "fancy_title": "How to troubleshoot throughput performance degrade?",
      "id": 1436,
      "title": "How to troubleshoot throughput performance degrade?",
      "slug": "how-to-troubleshoot-throughput-performance-degrade",
      "posts_count": 36,
      "reply_count": 24,
      "highest_post_number": 36,
      "image_url": "https://global.discourse-cdn.com/foundationdb/original/1X/9c9854ce87e53265f75154876f180812ee93f8ec.png",
      "created_at": "2019-06-10T10:09:55.810Z",
      "last_posted_at": "2019-06-20T21:36:30.209Z",
      "bumped": true,
      "bumped_at": "2019-06-20T21:36:30.209Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [
        "performance"
      ],
      "tags_descriptions": {},
      "like_count": 8,
      "views": 4377,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 597,
            "username": "rayjcwu",
            "name": "",
            "avatar_template": "/user_avatar/forums.foundationdb.org/rayjcwu/{size}/602_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 337,
            "username": "mengxu",
            "name": "Meng Xu",
            "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 81,
            "username": "ryanworl",
            "name": "Ryan Worl",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ryanworl/{size}/440_2.png",
            "trust_level": 3
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 592,
            "username": "nfeinberg",
            "name": "Nicholas Feinberg",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/n/ba8739/{size}.png",
            "trust_level": 1
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 744,
        "username": "v-pap",
        "name": "",
        "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png",
        "post_count": 5,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 393,
        "username": "ex3ndr",
        "name": "Steve Korshakov",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ex3ndr/{size}/389_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 7,
        "username": "SteavedHams",
        "name": "Steve Atherton",
        "avatar_template": "/user_avatar/forums.foundationdb.org/steavedhams/{size}/18_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      },
      {
        "id": 337,
        "username": "mengxu",
        "name": "Meng Xu",
        "avatar_template": "/user_avatar/forums.foundationdb.org/mengxu/{size}/893_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 741,
        "username": "sears",
        "name": "Russell Sears",
        "avatar_template": "/user_avatar/forums.foundationdb.org/sears/{size}/887_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 744,
      "username": "v-pap",
      "name": "",
      "avatar_template": "/user_avatar/forums.foundationdb.org/v-pap/{size}/936_2.png"
    },
    "last_poster": {
      "id": 393,
      "username": "ex3ndr",
      "name": "Steve Korshakov",
      "avatar_template": "/user_avatar/forums.foundationdb.org/ex3ndr/{size}/389_2.png"
    },
    "links": [
      {
        "url": "https://forums.foundationdb.org/t/scalable-time-series-database-improving-write-throughput/2032/8",
        "title": "Scalable time series database / Improving write throughput",
        "internal": true,
        "attachment": false,
        "reflection": false,
        "clicks": 9,
        "user_id": 744,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      },
      {
        "url": "https://forums.foundationdb.org/t/storage-server-cpu-bottleneck-growing-data-lag/2234",
        "title": "Storage Server CPU bottleneck - Growing data lag",
        "internal": true,
        "attachment": false,
        "reflection": true,
        "clicks": 1,
        "user_id": 744,
        "domain": "forums.foundationdb.org",
        "root_domain": "foundationdb.org"
      }
    ]
  },
  "bookmarks": []
}