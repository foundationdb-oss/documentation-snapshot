{
  "post_stream": {
    "posts": [
      {
        "id": 10342,
        "name": "Lou",
        "username": "laita",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/77aa72/{size}.png",
        "created_at": "2021-11-30T10:51:36.702Z",
        "cooked": "<p>I use fdb with python binding and I use it in python project where we monkey_patch gevent.Theres is an issue when monkey_patching threads with fdb as reported in this thread :</p><aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/apple/foundationdb/issues/228\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/apple/foundationdb/issues/228\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/apple/foundationdb</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewbox=\"0 0 14 16\" aria-hidden=\"true\"><path d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/apple/foundationdb/issues/228\" target=\"_blank\" rel=\"noopener nofollow ugc\">Python: fdb network thread blocks main thread when gevent is monkey patched</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2018-04-22\" data-time=\"20:47:57\" data-timezone=\"UTC\">08:47PM - 22 Apr 18 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/zorkian\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"zorkian\" src=\"https://global.discourse-cdn.com/foundationdb/original/2X/6/6801814dc46f959889dd84a6c03c26e2efb7d2ea.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\">\n          zorkian\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">Hiya,\n\nWe make use of gevent's `monkey.patch_all` functionality in order to ma<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">\u2026</a></span><span class=\"excerpt hidden\">ke all of the pure-Python libraries play nicely with gevent. This is pretty successful, but it currently causes the fdb network thread to block the main application thread.\n\nDemo: https://gist.github.com/zorkian/824e86d0d7f001965f62dc8ae7ad28db\n\nThis is tested in gevent 1.1.1 as well as the latest 1.3b1.\n\nYou can alleviate the blocking by using `gevent.monkey.patch_all(thread=False)`, but this currently doesn't work in our environment due to certain modules we use that aren't implemented to use gevent and require threading.\n\nI've been playing around with the fdb library to see if I can make it work, but haven't succeeded as yet. Figured I'd file the issue just to put it on the radar.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>To sum up : fdb hangs if we use this conf:<br>\ngevent.monkey.patch_all(os=False) but works if we set thread to False<br>\ngevent.monkey.patch_all(os=False, thread=False)</p>\n<p>My question is it possible to make fdb library monkey_patch aware or make some changes on impl.py to make it working with monkey_patching threads?</p>\n<p>Thank you</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 1,
        "updated_at": "2021-12-01T09:27:52.019Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 11,
        "readers_count": 10,
        "score": 12.2,
        "yours": false,
        "topic_id": 3048,
        "topic_slug": "fdb-and-monkey-patch-aware",
        "display_username": "Lou",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 4,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/issues/228",
            "internal": false,
            "reflection": false,
            "title": "Python: fdb network thread blocks main thread when gevent is monkey patched \u00b7 Issue #228 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 989,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/fdb-and-monkey-patch-aware/3048/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      }
    ],
    "stream": [
      10342
    ]
  },
  "timeline_lookup": [
    [
      1,
      1421
    ]
  ],
  "suggested_topics": [],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Fdb and monkey_patch aware",
  "id": 3048,
  "title": "Fdb and monkey_patch aware",
  "posts_count": 1,
  "created_at": "2021-11-30T10:51:36.642Z",
  "views": 330,
  "reply_count": 0,
  "like_count": 0,
  "last_posted_at": "2021-11-30T10:51:36.702Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "fdb-and-monkey-patch-aware",
  "category_id": 7,
  "word_count": 95,
  "deleted_at": null,
  "user_id": 989,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_3048",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 1,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 1,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": [
    {
      "fancy_title": "Using libfdb in unikernel without preemptive threading",
      "id": 1123,
      "title": "Using libfdb in unikernel without preemptive threading",
      "slug": "using-libfdb-in-unikernel-without-preemptive-threading",
      "posts_count": 7,
      "reply_count": 4,
      "highest_post_number": 7,
      "image_url": null,
      "created_at": "2019-02-09T09:41:26.728Z",
      "last_posted_at": "2019-02-19T12:05:07.350Z",
      "bumped": true,
      "bumped_at": "2019-02-19T12:05:07.350Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 585,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 507,
            "username": "andreas",
            "name": "",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/a/ee7513/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 15,
            "username": "markus.pilman",
            "name": "Markus Pilman",
            "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
            "admin": true,
            "trust_level": 4
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Access db from forked process",
      "id": 2857,
      "title": "Access db from forked process",
      "slug": "access-db-from-forked-process",
      "posts_count": 3,
      "reply_count": 1,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2021-08-20T19:11:36.405Z",
      "last_posted_at": "2021-08-23T07:25:58.501Z",
      "bumped": true,
      "bumped_at": "2021-08-23T07:25:58.501Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 0,
      "views": 619,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 989,
            "username": "laita",
            "name": "Lou",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/77aa72/{size}.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "[Java] FoundationDB client thread related question",
      "id": 599,
      "title": "[Java] FoundationDB client thread related question",
      "slug": "java-foundationdb-client-thread-related-question",
      "posts_count": 3,
      "reply_count": 0,
      "highest_post_number": 3,
      "image_url": null,
      "created_at": "2018-07-29T10:57:29.288Z",
      "last_posted_at": "2018-08-08T16:45:45.782Z",
      "bumped": true,
      "bumped_at": "2018-08-08T16:45:45.782Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 2,
      "views": 9111,
      "category_id": 7,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 166,
            "username": "gaurav",
            "name": "gaurav",
            "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
            "trust_level": 3
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 38,
            "username": "panghy",
            "name": "Clement Pang",
            "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 12,
            "username": "ajbeamon",
            "name": "A.J. Beamon",
            "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
            "admin": true,
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "How to complie and debug FDB (on mac os)?",
      "id": 176,
      "title": "How to complie and debug FDB (on mac os)?",
      "slug": "how-to-complie-and-debug-fdb-on-mac-os",
      "posts_count": 12,
      "reply_count": 7,
      "highest_post_number": 12,
      "image_url": null,
      "created_at": "2018-04-21T14:09:00.980Z",
      "last_posted_at": "2018-05-17T21:06:56.719Z",
      "bumped": true,
      "bumped_at": "2018-05-17T21:06:56.719Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 2930,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": null,
          "description": "Original Poster",
          "user": {
            "id": 127,
            "username": "Johnny-Three",
            "name": "inolddays",
            "avatar_template": "/user_avatar/forums.foundationdb.org/johnny-three/{size}/111_2.png",
            "trust_level": 0
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 30,
            "username": "wwilson",
            "name": "Will Wilson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 65,
            "username": "dougnukem",
            "name": "Doug Daniels",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dougnukem/{size}/48_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        },
        {
          "extras": "latest",
          "description": "Most Recent Poster",
          "user": {
            "id": 13,
            "username": "alexmiller",
            "name": "Alex Miller",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
            "trust_level": 4
          }
        }
      ]
    },
    {
      "fancy_title": "Asynchronous Client",
      "id": 74,
      "title": "Asynchronous Client",
      "slug": "asynchronous-client",
      "posts_count": 6,
      "reply_count": 4,
      "highest_post_number": 6,
      "image_url": null,
      "created_at": "2018-04-19T20:46:27.327Z",
      "last_posted_at": "2018-04-20T09:27:51.257Z",
      "bumped": true,
      "bumped_at": "2018-04-20T09:27:51.257Z",
      "archetype": "regular",
      "unseen": false,
      "pinned": false,
      "unpinned": null,
      "visible": true,
      "closed": false,
      "archived": false,
      "bookmarked": null,
      "liked": null,
      "tags": [],
      "tags_descriptions": {},
      "like_count": 1,
      "views": 1303,
      "category_id": 5,
      "featured_link": null,
      "has_accepted_answer": false,
      "posters": [
        {
          "extras": "latest",
          "description": "Original Poster, Most Recent Poster",
          "user": {
            "id": 41,
            "username": "amirouche",
            "name": "Amirouche",
            "avatar_template": "/user_avatar/forums.foundationdb.org/amirouche/{size}/1911_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 30,
            "username": "wwilson",
            "name": "Will Wilson",
            "avatar_template": "/user_avatar/forums.foundationdb.org/wwilson/{size}/88_2.png",
            "trust_level": 2
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 22,
            "username": "dave",
            "name": "David Scherer",
            "avatar_template": "/user_avatar/forums.foundationdb.org/dave/{size}/89_2.png",
            "trust_level": 1
          }
        },
        {
          "extras": null,
          "description": "Frequent Poster",
          "user": {
            "id": 8,
            "username": "alloc",
            "name": "Alec Grieser",
            "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
            "trust_level": 4
          }
        }
      ]
    }
  ],
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 989,
        "username": "laita",
        "name": "Lou",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/77aa72/{size}.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      }
    ],
    "created_by": {
      "id": 989,
      "username": "laita",
      "name": "Lou",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/77aa72/{size}.png"
    },
    "last_poster": {
      "id": 989,
      "username": "laita",
      "name": "Lou",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/l/77aa72/{size}.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/issues/228",
        "title": "Python: fdb network thread blocks main thread when gevent is monkey patched \u00b7 Issue #228 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 989,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}