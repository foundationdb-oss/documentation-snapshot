{
  "post_stream": {
    "posts": [
      {
        "id": 6316,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-26T10:20:23.657Z",
        "cooked": "<p>Hi Team,</p>\n<p>I am noticing that querying the special key \u201c\\xff\\xff/status/json\u201d sometimes doesn\u2019t provide the complete json object.<br>\nI tried querying this key in fdbcli shell (get \u201c\\xff\\xff/status/json\u201d).  Sometimes I get back the complete status json and sometimes a truncated one. The truncated json abruptly ends like {\u201cclient_version\u201d:\"\\x95\u2019</p>\n<p>Could you please advise?</p>\n<p>Thanks,<br>\nPragya</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-26T10:20:23.657Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 160,
        "reads": 36,
        "readers_count": 35,
        "score": 802.2,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 6320,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-02-26T17:26:33.218Z",
        "cooked": "<p>It sounds like a bug to be getting a truncated document. Is the example you gave a real output that you got? That\u2019s an unusual value for <code>client_version</code>, so if it is that might be some sort of clue.</p>\n<p>Some other questions \u2013</p>\n<ol>\n<li>Does the output always terminate in roughly the same place when it\u2019s truncated?</li>\n<li>How often does this happen?</li>\n<li>Have you noticed any patterns for when it occurs?</li>\n</ol>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-26T17:26:33.218Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 33,
        "readers_count": 32,
        "score": 16.6,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6333,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-27T09:07:00.552Z",
        "cooked": "<p>Thank you for responding.</p>\n<p>Yes, the example I gave is a real output. Pasting the whole output below. (Removing ip addresses):</p>\n<p>Regarding the other questions:</p>\n<ol>\n<li>Does the output always terminate in roughly the same place when it\u2019s truncated? - Yes</li>\n<li>How often does this happen? - Happens kind of randomly. I start seeing correct json after a few tries.</li>\n<li>Have you noticed any patterns for when it occurs? - Not much but status json command on fdbcli works fine.</li>\n</ol>\n<p><strong>Output</strong><br>\nfdb&gt; get \u201c\\xff\\xff/status/json\u201d<br>\n<code>\\xff\\xff/status/json' is </code> {\u201cclient\u201d:{\u201ccluster_file\u201d:{\u201cpath\u201d:\"/xxx/ssst.cluster\",\u201cup_to_date\u201d:true},\u201ccoordinators\u201d:{\u201ccoordinators\u201d:[{\u201caddress\u201d:\"\",\u201creachable\u201d:true},{\u201caddress\u201d:\"\",\u201creachable\u201d:true},{\u201caddress\u201d:\"\",\u201creachable\u201d:true}],\u201cquorum_reachable\u201d:true},\u201cdatabase_status\u201d:{\u201cavailable\u201d:true,\u201chealthy\u201d:true},\u201cmessages\u201d:,\u201ctimestamp\u201d:1582707378},\u201ccluster\u201d:{\u201cclients\u201d:{\u201ccount\u201d:12,\u201csupported_versions\u201d:[{\u201cclient_version\u201d:\u201cUnknown\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:1,\u201cprotocol_version\u201d:\u201cUnknown\u201d,\u201csource_version\u201d:\u201cUnknown\u201d},{\u201cclient_version\u201d:\u201c6.2.10\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c10.xx.xxx.:50124\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:7,\u201cmax_protocol_clients\u201d:[{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d}],\u201cmax_protocol_count\u201d:12,\u201cprotocol_version\u201d:\u201cfdb00b062010001\u201d,\u201csource_version\u201d:\u201cCurrent version id not currently supported within Windows.\u201d},{\u201cclient_version\u201d:\"\\x95</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T09:07:00.552Z",
        "reply_count": 2,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 31,
        "readers_count": 30,
        "score": 16.2,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6336,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2020-02-27T09:39:11.981Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"4\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Current version id not currently supported within Windows</p>\n</blockquote>\n</aside>\n<p><a class=\"mention\" href=\"/u/krzysfr\">@KrzysFR</a>, just to double check, do you pull status at all via <code>\\xFF\\xFF/status/json</code>, or is the door open that this could possibly be a Windows-only problem that no one has run into before?</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T09:39:37.023Z",
        "reply_count": 4,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 24,
        "readers_count": 23,
        "score": 24.8,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6339,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-27T10:11:08.493Z",
        "cooked": "<p>For what it\u2019s worth, now, the json looks like below. As you can see, it doesn\u2019t have the message regarding windows.</p>\n<p>fdb&gt; get \u201c\\xff\\xff/status/json\u201d<br>\n<code>\\xff\\xff/status/json' is </code>{\u201cclient\u201d:{\u201ccluster_file\u201d:{\u201cpath\u201d:\"/xx/xx.cluster\",\u201cup_to_date\u201d:true},\u201ccoordinators\u201d:{\u201ccoordinators\u201d:[{\u201caddress\u201d:\"\",\u201creachable\u201d:true},{\u201caddress\u201d:\",\u201creachable\u201d:true},{\u201caddress\u201d:\"\",\u201creachable\u201d:true}],\u201cquorum_reachable\u201d:true},\u201cdatabase_status\u201d:{\u201cavailable\u201d:true,\u201chealthy\u201d:true},\u201cmessages\u201d:<span class=\"chcklst-box fa fa-square-o fa-fw\"></span>,\u201ctimestamp\u201d:1582797952},\u201ccluster\u201d:{\u201cclients\u201d:{\u201ccount\u201d:1,\u201csupported_versions\u201d:[{\u201cclient_version\u201d:\u201cUnknown\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\"\",\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:1,\u201cprotocol_version\u201d:\u201cUnknown\u201d,\u201csource_version\u201d:\u201cUnknown\u201d},{\u201cclient_version\u201d:\"\\xd4\u2019</p>\n<p>also, even in the complete json (when I get it, I have sometimes seen \u201cCurrent version id not currently supported within Windows.\u201d in the json.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-07-16T01:20:58.050Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 23,
        "readers_count": 22,
        "score": 9.6,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": "checklist change",
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6340,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-27T10:55:36.389Z",
        "cooked": "<p>I have exposed a GetStatusAsync(\u2026) API on the .NET binding, but the implementation reads the <code>\\xff\\xff/status/json</code> key.</p>\n<aside class=\"onebox githubblob\" data-onebox-src=\"https://github.com/Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99\" target=\"_blank\" rel=\"noopener nofollow ugc\">Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99</a></h4>\n\n\n\n    <pre class=\"onebox\"><code class=\"lang-cs\">\n      <ol class=\"start lines\" start=\"89\" style=\"counter-reset: li-counter 88 ;\">\n          <li>\t\t\t/// &lt;summary&gt;\"\\xFF/serverList/(node_id)\" =&gt; (..., node_id, machine_id, datacenter_id, ...)&lt;/summary&gt;</li>\n          <li>\t\t\tpublic static readonly Slice ServerList = Slice.FromByteString(\"\\xFF/serverList/\");</li>\n          <li></li>\n          <li>\t\t\t/// &lt;summary&gt;\"\\xFF/workers/(ip:port)/...\" =&gt; datacenter + machine + mclass&lt;/summary&gt;</li>\n          <li>\t\t\tpublic static readonly Slice WorkersPrefix = Slice.FromByteString(\"\\xFF/workers/\");</li>\n          <li></li>\n          <li>\t\t\t#region JSON Status</li>\n          <li></li>\n          <li>\t\t\tprivate static readonly Slice StatusJsonKey = Slice.FromByteString(\"\\xFF\\xFF/status/json\");</li>\n          <li></li>\n          <li class=\"selected\">\t\t\tpublic static async Task&lt;FdbSystemStatus?&gt; GetStatusAsync(IFdbReadOnlyTransaction trans)</li>\n          <li>\t\t\t{</li>\n          <li>\t\t\t\tContract.NotNull(trans, nameof(trans));</li>\n          <li></li>\n          <li>\t\t\t\tvar data = await trans.GetAsync(StatusJsonKey).ConfigureAwait(false);</li>\n          <li></li>\n          <li>\t\t\t\tif (data.IsNullOrEmpty) return null;</li>\n          <li></li>\n          <li>\t\t\t\tvar doc = TinyJsonParser.ParseObject(data);</li>\n          <li>\t\t\t\tif (doc == null) return null;</li>\n          <li></li>\n      </ol>\n    </code></pre>\n\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>I have not encountered issues with truncation, but again our clusters are rather small (compared to others) so if the issue is due to some maximum size, I may not have seen it yet.</p>\n<p>I just tested doing a lot of <code>get \u201c\\xff\\xff/status/json\u201d</code>, from a Windows client to a Windows server with 1 node, and the result is always complete (always ends with <code>...}}}}}</code>)</p>\n<p>Same result when testing from Windows to a bigger Linux cluster with 8 servers and 64 processes: the returned value is complete everytime (and payload is much larger).</p>\n<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"6\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>also, even in the complete json (when I get it, I have sometimes seen \u201cCurrent version id not currently supported within Windows.\u201d in the json.</p>\n</blockquote>\n</aside>\n<p>If you\u2019re talking about the warning that appears when you run <code>fdbcli --version</code> \u2026 it\u2019s been like this since forever (or at least 5.0+?) and only appears when querying the version. Don\u2019t think that it\u2019s used for anything else.</p>\n<p>From windows:</p>\n<pre><code class=\"lang-auto\">C:\\WINDOWS\\system32&gt;fdbcli --version\nFoundationDB CLI 6.2 (v6.2.10)\nsource version Current version id not currently supported within Windows.\nprotocol fdb00b062010001\n</code></pre>\n<p>From linux:</p>\n<pre><code class=\"lang-auto\">doxense@fdb01:~$ fdbcli --version\nFoundationDB CLI 6.2 (v6.2.7)\nsource version d3c4bd9c5ac29ef98c024317353e3c1a24a9d6b3\nprotocol fdb00b062010001\n</code></pre>\n<p>I think that the windows build script does not pass the current git commit hash to msvc or it\u2019s not patched into a source file before building?</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T10:55:36.389Z",
        "reply_count": 2,
        "reply_to_post_number": 5,
        "quote_count": 1,
        "incoming_link_count": 6,
        "reads": 24,
        "readers_count": 23,
        "score": 44.8,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99",
            "internal": false,
            "reflection": false,
            "title": "foundationdb-dotnet-client/Fdb.System.cs at f163b7e369aeb7171849090701b155657897e02d \u00b7 Doxense/foundationdb-dotnet-client \u00b7 GitHub",
            "clicks": 2
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6341,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-27T11:24:27.133Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"7\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I have not encountered issues with truncation, but again our clusters are rather small (compared to others) so if the issue is due to some maximum size, I may not have seen it yet.</p>\n</blockquote>\n</aside>\n<p>Interesting, our cluster is pretty small too - It is a test cluster - one machine, 5 processes, 800MB disk space used.</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"7\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>If you\u2019re talking about the warning that appears when you run <code>fdbcli --version</code> \u2026 it\u2019s been like this since forever (or at least 5.0+?) and only appears when querying the version. Don\u2019t think that it\u2019s used for anything else.</p>\n</blockquote>\n</aside>\n<p>No, I see this written in the json sometimes when I do a get \u201c\\xff\\xff/status/json\u201d) - Just like it\u2019s witten in my incomplete json below. I was saying that I sometimes see this in complete json as well.</p>\n<aside class=\"quote no-group quote-modified\" data-username=\"pragya\" data-post=\"4\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>fdb&gt; get \u201c\\xff\\xff/status/json\u201d<br>\n<code>\\xff\\xff/status/json' is </code> {\u201cclient\u201d:{\u201ccluster_file\u201d:{\u201cpath\u201d:\u201c/xxx/ssst.cluster\u201d,\u201cup_to_date\u201d:true},\u201ccoordinators\u201d:{\u201ccoordinators\u201d:[{\u201caddress\u201d:\u201c\u201d,\u201creachable\u201d:true},{\u201caddress\u201d:\u201c\u201d,\u201creachable\u201d:true},{\u201caddress\u201d:\u201c\u201d,\u201creachable\u201d:true}],\u201cquorum_reachable\u201d:true},\u201cdatabase_status\u201d:{\u201cavailable\u201d:true,\u201chealthy\u201d:true},\u201cmessages\u201d:,\u201ctimestamp\u201d:1582707378},\u201ccluster\u201d:{\u201cclients\u201d:{\u201ccount\u201d:12,\u201csupported_versions\u201d:[{\u201cclient_version\u201d:\u201cUnknown\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:1,\u201cprotocol_version\u201d:\u201cUnknown\u201d,\u201csource_version\u201d:\u201cUnknown\u201d},{\u201cclient_version\u201d:\u201c6.2.10\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c10.xx.xxx.:50124\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:7,\u201cmax_protocol_clients\u201d:[{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d},{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d}],\u201cmax_protocol_count\u201d:12,\u201cprotocol_version\u201d:\u201cfdb00b062010001\u201d,\u201csource_version\u201d:\u201cCurrent version id not currently supported within Windows.\u201d},{\u201cclient_version\u201d:\"\\x95</p>\n</blockquote>\n</aside>\n<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"5\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>or is the door open that this could possibly be a Windows-only problem that no one has run into before?</p>\n</blockquote>\n</aside>\n<p>I am actually running fdbcli on a linux host.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T11:36:06.364Z",
        "reply_count": 1,
        "reply_to_post_number": 7,
        "quote_count": 3,
        "incoming_link_count": 1,
        "reads": 19,
        "readers_count": 18,
        "score": 13.8,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 3,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6343,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-27T12:40:00.733Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"8\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>No, I see this written in the json sometimes when I do a get \u201c\\xff\\xff/status/json\u201d)</p>\n</blockquote>\n</aside>\n<p>I think that it is same field that is used by <code>fdbcli --version</code>, and is right beside the protocol version which is also present on the next line.</p>\n<p>Though, I\u2019m not sure why in your samples above, they are always ending by <code>\\x95</code> or <code>\\xd4</code> which don\u2019t look like valid UTF-8 encoding? Maybe this is an issue with a buffer overflow of some kind, and it is exposing what was before in memory? JSON is supposed to be utf-8 and maybe if there is some corrupted binary data somewhere, the generator would stop or choke on the first random byte that would not match any valid utf-8 code point?</p>\n<p>In one of your sample you also have a weird square in the middle of <code>...\u201cmessages\u201d:[],\u201ctimestamp\u201d...</code> though it may be an artefact of the forum comment syntax? Maybe if you add triple backquotes ``` on lines before and after the json output, we could see the exact text?</p>\n<p>Anyway, I think this is the code that generates the status json is here:  <a href=\"https://github.com/apple/foundationdb/blob/release-6.2/fdbserver/Status.actor.cpp#L923\" rel=\"noopener nofollow ugc\">https://github.com/apple/foundationdb/blob/release-6.2/fdbserver/Status.actor.cpp#L923</a></p>\n<p>What I can see is that it does write \u201ccount\u201d, \u201cclient_version\u201d, \u201cprotocol_version\u201d and \u201csource_version\u201d (in this order) while in your output it is a bit different, we see \u201cmax_protocol_count\u201d (instead of \u201ccount\u201d), \u201cprotocol_version\u201d, \u201csource_version\u201d and then \u201cclient_version\u201d that is corrupted. Looking at the file history, this section of the code has not been touched in 3 years, except for the \u201ccount\u201d property 7 months ago\u2026</p>\n<p>For reference, here is what I get at the same spot: <code>...,\"count\":2,\"protocol_version\":\"Unknown\",\"source_version\":\"Unknown\"}]},\"cluster_controller_timestamp\":1...</code></p>\n<p>It matches a bit more the code, except that I don\u2019t have the \u2018client_version\u2019 field (maybe it is skipped because it is null?). I do have \u201cUnknown\u201d instead of \u201cCurrent version id not currently supported within Windows.\u201d</p>\n<p>I\u2019m also running 6.2.10 on this machine and my json output is slightly different, which is a bit worrying <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T12:41:11.744Z",
        "reply_count": 2,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 22,
        "readers_count": 21,
        "score": 24.4,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/release-6.2/fdbserver/Status.actor.cpp#L923",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/Status.actor.cpp at release-6.2 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6344,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-27T12:44:23.657Z",
        "cooked": "<p>FYI, just updated the windows machine from 6.2.10 to 6.2.15 and I get the same result.</p>\n<pre><code class=\"lang-json\">{\n   \"client\":{\n      \"cluster_file\":{\n         \"path\":\"C:\\\\ProgramData\\\\foundationdb\\\\fdb.cluster\",\n         \"up_to_date\":true\n      },\n      \"coordinators\":{\n         \"coordinators\":[\n            {\n               \"address\":\"127.0.0.1:4500\",\n               \"reachable\":true\n            }\n         ],\n         \"quorum_reachable\":true\n      },\n      \"database_status\":{\n         \"available\":true,\n         \"healthy\":true\n      },\n      \"messages\":[\n\n      ],\n      \"timestamp\":1582807398\n   },\n   \"cluster\":{\n      \"clients\":{\n         \"count\":0,\n         \"supported_versions\":[\n            {\n               \"client_version\":\"Unknown\",\n               \"connected_clients\":[\n                  {\n                     \"address\":\"127.0.0.1:58871\",\n                     \"log_group\":\"default\"\n                  },\n                  {\n                     \"address\":\"127.0.0.1:58918\",\n                     \"log_group\":\"default\"\n                  }\n               ],\n               \"count\":2,\n               \"protocol_version\":\"Unknown\",\n               \"source_version\":\"Unknown\"\n            }\n         ]\n      },\n      \"cluster_controller_timestamp\":1582807398,\n      ...\n      // rest of the data\n      ...\n   }\n}\n</code></pre>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T12:47:34.029Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 9.4,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6346,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-27T13:04:13.696Z",
        "cooked": "<p>I tried following the implementation of the Json Builder (json_spirit), looking for issues with handling utf-8 data, but it seems to be doing its job:</p>\n<aside class=\"onebox githubblob\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/blob/4399480b301b449c48adb6dc12fd930b6188bc4c/fdbclient/ReadYourWrites.actor.cpp#L1157\" target=\"_blank\" rel=\"nofollow noopener\">github.com</a>\n  </header>\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/4399480b301b449c48adb6dc12fd930b6188bc4c/fdbclient/ReadYourWrites.actor.cpp#L1157\" target=\"_blank\" rel=\"nofollow noopener\">apple/foundationdb/blob/4399480b301b449c48adb6dc12fd930b6188bc4c/fdbclient/ReadYourWrites.actor.cpp#L1157</a></h4>\n<pre class=\"onebox\"><code class=\"lang-cpp\"><ol class=\"start lines\" start=\"1147\" style=\"counter-reset: li-counter 1146 ;\">\n<li>\n</li>\n<li>Future&lt;Version&gt; ReadYourWritesTransaction::getReadVersion() {</li>\n<li>\tif (tr.apiVersionAtLeast(101)) {</li>\n<li>\t\tif (resetPromise.isSet())</li>\n<li>\t\t\treturn resetPromise.getFuture().getError();</li>\n<li>\t\treturn RYWImpl::getReadVersion(this);</li>\n<li>\t}</li>\n<li>\treturn tr.getReadVersion();</li>\n<li>}</li>\n<li>\n</li>\n<li class=\"selected\">Optional&lt;Value&gt; getValueFromJSON(StatusObject statusObj) {</li>\n<li>\ttry {</li>\n<li>\t\tValue output = StringRef(json_spirit::write_string(json_spirit::mValue(statusObj), json_spirit::Output_options::raw_utf8).c_str());</li>\n<li>\t\treturn output;</li>\n<li>\t}</li>\n<li>\tcatch (std::exception&amp; e){</li>\n<li>\t\tTraceEvent(SevError, \"UnableToUnparseStatusJSON\").detail(\"What\", e.what());</li>\n<li>\t\tthrow internal_error();</li>\n<li>\t}</li>\n<li>}</li>\n<li>\n</li>\n</ol></code></pre>\n\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>My idea was that for some reason, you have one connected client that is sending a corrupted client_version field, and this value would not be properly escaped into JSON, and when parsed back into the client, would be truncated (instead of throwing a syntax error), but I\u2019m don\u2019t see any clues in the code.</p>\n<p>The only \u201cweird\u201d thing I can see is that the parser is only escaping a few characters into strings, and not escaping the rest: It is best practice to always escape characters with a code points &gt;= 128:</p>\n<aside class=\"onebox githubblob\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/blob/59a204b2872485605dbf70350a957d0e26e8414e/fdbclient/JsonBuilder.h#L155\" target=\"_blank\" rel=\"nofollow noopener\">github.com</a>\n  </header>\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/59a204b2872485605dbf70350a957d0e26e8414e/fdbclient/JsonBuilder.h#L155\" target=\"_blank\" rel=\"nofollow noopener\">apple/foundationdb/blob/59a204b2872485605dbf70350a957d0e26e8414e/fdbclient/JsonBuilder.h#L155</a></h4>\n<pre class=\"onebox\"><code class=\"lang-h\"><ol class=\"start lines\" start=\"145\" style=\"counter-reset: li-counter 144 ;\">\n<li>\t\t\tcase '\\f':</li>\n<li>\t\t\tcase '\\n':</li>\n<li>\t\t\tcase '\\r':</li>\n<li>\t\t\tcase '\\t':</li>\n<li>\t\t\t\treturn true;</li>\n<li>\t\t\tdefault:</li>\n<li>\t\t\t\treturn false;</li>\n<li>\t\t}</li>\n<li>\t}</li>\n<li>\n</li>\n<li class=\"selected\">\tvoid writeValue(const char *val, int len) {</li>\n<li>\t\twrite('\"');</li>\n<li>\t\tint beginCopy = 0;</li>\n<li>\t\tVString &amp;dst = jsonText.back();</li>\n<li>\t\tfor (int i = 0; i &lt; len; i++) {</li>\n<li>\t\t\tif (shouldEscape(val[i])) {</li>\n<li>\t\t\t\tdst.append(arena, val + beginCopy, i - beginCopy);</li>\n<li>\t\t\t\tbeginCopy = i + 1;</li>\n<li>\t\t\t\twrite('\\\\');</li>\n<li>\t\t\t\twrite(val[i]);</li>\n<li>\t\t\t}</li>\n</ol></code></pre>\n\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>The <code>shouldEscape(...)</code> helper should probably also return true for characters &lt; 32 and &gt;= 128, this would maybe prevent the json from being truncated, and would expose the garbage client_version?</p>\n<p><strong>Edit</strong></p>\n<p>I followed the code the produces the various client/protocol/source fields, and found this:<br>\n<aside class=\"onebox githubblob\">\n  <header class=\"source\">\n      <a href=\"https://github.com/apple/foundationdb/blob/8d975bfd853f2a5ec35ec8b3b324d4c47872e843/fdbclient/ClusterInterface.h#L96\" target=\"_blank\" rel=\"nofollow noopener\">github.com</a>\n  </header>\n  <article class=\"onebox-body\">\n    <h4><a href=\"https://github.com/apple/foundationdb/blob/8d975bfd853f2a5ec35ec8b3b324d4c47872e843/fdbclient/ClusterInterface.h#L96\" target=\"_blank\" rel=\"nofollow noopener\">apple/foundationdb/blob/8d975bfd853f2a5ec35ec8b3b324d4c47872e843/fdbclient/ClusterInterface.h#L96</a></h4>\n<pre class=\"onebox\"><code class=\"lang-h\"><ol class=\"start lines\" start=\"86\" style=\"counter-reset: li-counter 85 ;\">\n<li>struct ClientVersionRef {</li>\n<li>\tStringRef clientVersion;</li>\n<li>\tStringRef sourceVersion;</li>\n<li>\tStringRef protocolVersion;</li>\n<li>\n</li>\n<li>\tClientVersionRef() {</li>\n<li>\t\tinitUnknown();</li>\n<li>\t}</li>\n<li>\n</li>\n<li>\tClientVersionRef(Arena &amp;arena, ClientVersionRef const&amp; cv) : clientVersion(arena, cv.clientVersion), sourceVersion(arena, cv.sourceVersion), protocolVersion(arena, cv.protocolVersion) {}</li>\n<li class=\"selected\">\tClientVersionRef(std::string versionString) {</li>\n<li>\t\tsize_t index = versionString.find(\",\");</li>\n<li>\t\tif(index == versionString.npos) {</li>\n<li>\t\t\tinitUnknown();</li>\n<li>\t\t\treturn;</li>\n<li>\t\t}</li>\n<li>\n</li>\n<li>\t\tclientVersion = StringRef((uint8_t*)&amp;versionString[0], index);</li>\n<li>\n</li>\n<li>\t\tsize_t nextIndex = versionString.find(\",\", index+1);</li>\n<li>\t\tif(index == versionString.npos) {</li>\n</ol></code></pre>\n\n\n  </article>\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n  <div style=\"clear: both\"></div>\n</aside>\n</p>\n<p>In my case, it seems that <code>initUnknown()</code> is called, but in your case, either the <code>ClientVersionRef(std::string versionString)</code> ctor is used to parse the string into 3 parts, using \u201c<code>,</code>\u201d as a separator, or the ClientVersionRef(Arena &amp;arena, ClientVersionRef const&amp; cv) is used.</p>\n<p>Since the second ctor is looking for \u2018,\u2019 and is grabbing client_version first, it seems a bit unlucky that you\u2019d get random binary data, followed by \u2018,\u2019 and then textual data. So probably the first ctor is used to copy already bad strings? My C+\u00b1foo is not strong enough to follow this ctor up the call tree, so someone with better knowledge of the code base is required!</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T13:43:36.764Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 19,
        "readers_count": 18,
        "score": 8.8,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/4399480b301b449c48adb6dc12fd930b6188bc4c/fdbclient/ReadYourWrites.actor.cpp#L1157",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/ReadYourWrites.actor.cpp at 4399480b301b449c48adb6dc12fd930b6188bc4c \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/59a204b2872485605dbf70350a957d0e26e8414e/fdbclient/JsonBuilder.h#L155",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/JsonBuilder.h at 59a204b2872485605dbf70350a957d0e26e8414e \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/8d975bfd853f2a5ec35ec8b3b324d4c47872e843/fdbclient/ClusterInterface.h#L96",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/ClusterInterface.h at 8d975bfd853f2a5ec35ec8b3b324d4c47872e843 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6350,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-02-27T16:36:25.123Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"alexmiller\" data-post=\"5\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alexmiller/48/326_2.png\" class=\"avatar\"> alexmiller:</div>\n<blockquote>\n<p>is the door open that this could possibly be a Windows-only problem that no one has run into before?</p>\n</blockquote>\n</aside>\n<p>I\u2019ve heard of a similar issue happening in a Linux environment, though in that case I just know that the result was not a valid JSON document. The actual contents of the result were not preserved.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T16:36:25.123Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 13,
        "readers_count": 12,
        "score": 7.6,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6352,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-02-27T17:30:25.225Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"9\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I do have \u201cUnknown\u201d instead of \u201cCurrent version id not currently supported within Windows.\u201d</p>\n</blockquote>\n</aside>\n<p>It looks like various of our binaries will produce an entry in the clients list with \u201cUnknown\u201d version, which could explain what you are seeing if you are using them. These would include backup and DR binaries as well as fdbcli.</p>\n<p>This particular problem should be pretty easy to fix in a patch.</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T21:28:09.941Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 16,
        "readers_count": 15,
        "score": 3.2,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6354,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-02-27T19:32:37.885Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/pragya\">@pragya</a> are you loading any external clients using the multi-version API?</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-27T19:32:37.885Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 18,
        "readers_count": 17,
        "score": 13.6,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6366,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-28T13:45:42.161Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"ajbeamon\" data-post=\"14\" data-topic=\"1978\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/ajbeamon/48/13_2.png\" class=\"avatar\"> ajbeamon:</div>\n<blockquote>\n<p><a class=\"mention\" href=\"/u/pragya\">@pragya</a> are you loading any external clients using the multi-version API?</p>\n</blockquote>\n</aside>\n<p>No</p>\n<aside class=\"quote no-group\" data-username=\"ajbeamon\" data-post=\"12\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/ajbeamon/48/13_2.png\" class=\"avatar\"> ajbeamon:</div>\n<blockquote>\n<p>I\u2019ve heard of a similar issue happening in a Linux environment, though in that case I just know that the result was not a valid JSON document. The actual contents of the result were not preserved.</p>\n</blockquote>\n</aside>\n<p>Yes, even in my case, the environment is linux. I am running fdbcli on a linux host.<br>\nAlso, did you never observe the issue again? Anything you did to fix it?</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"7\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I just tested doing a lot of <code>get \u201c\\xff\\xff/status/json\u201d</code> , from a Windows client to a Windows server with 1 node, and the result is always complete (always ends with <code>...}}}}}</code> )</p>\n</blockquote>\n</aside>\n<p>Yeah, it happens randomly for me. I works fine for long and then suddenly it stops working. I just now set up a cron which calls this key every 5 minutes and prints the output to a file. Let me see if I see something and how frequently do I see it</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"9\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>In one of your sample you also have a weird square in the middle of <code>...\u201cmessages\u201d:[],\u201ctimestamp\u201d...</code> though it may be an artefact of the forum comment syntax? Maybe if you add triple backquotes ``` on lines before and after the json output, we could see the exact text?</p>\n</blockquote>\n</aside>\n<p>Yeah, that came only when I pasted on the forum. Have lost that particular output now. Will take care from next time.</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"9\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>What I can see is that it does write \u201ccount\u201d, \u201cclient_version\u201d, \u201cprotocol_version\u201d and \u201csource_version\u201d (in this order) while in your output it is a bit different, we see \u201cmax_protocol_count\u201d (instead of \u201ccount\u201d), \u201cprotocol_version\u201d, \u201csource_version\u201d and then \u201cclient_version\u201d that is corrupted. Looking at the file history, this section of the code has not been touched in 3 years, except for the \u201ccount\u201d property 7 months ago\u2026</p>\n</blockquote>\n</aside>\n<p>Um, don\u2019t know about this: see the below substring from a complete json output:</p>\n<p>\u2018\u2019\u2018\u201ccluster\u201d:{\u201cclients\u201d:{\u201ccount\u201d:1,\u201csupported_versions\u201d:[{\u201cclient_version\u201d:\u201cUnknown\u201d,\u201cconnected_clients\u201d:[{\u201caddress\u201d:\u201c\u201d,\u201clog_group\u201d:\u201cdefault\u201d}],\u201ccount\u201d:1,\u201cprotocol_version\u201d:\u201cUnknown\u201d,\u201csource_version\u201d:\u201cUnknown\u201d}\u2019\u2018\u2019</p>\n<p>The order is not followed here.</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"9\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>It matches a bit more the code, except that I don\u2019t have the \u2018client_version\u2019 field (maybe it is skipped because it is null?). I do have \u201cUnknown\u201d instead of \u201cCurrent version id not currently supported within Windows.\u201d</p>\n</blockquote>\n</aside>\n<p>Could you please check this in a couple more cases and if everywhere you see it</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"9\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I\u2019m also running 6.2.10 on this machine and my json output is slightly different, which is a bit worrying <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n</blockquote>\n</aside>\n<p>I see, I am running 6.2.7</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"10\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>FYI, just updated the windows machine from 6.2.10 to 6.2.15 and I get the same result.</p>\n<pre><code class=\"lang-auto\">{\n</code></pre>\n</blockquote>\n</aside>\n<p>I am sorry, this is output when you run \u201cstatus json\u201d right - not get . Even in my case, when get  gives truncated json, \u201cstatus json\u201d works completely fine.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T13:45:42.161Z",
        "reply_count": 2,
        "reply_to_post_number": 12,
        "quote_count": 5,
        "incoming_link_count": 0,
        "reads": 21,
        "readers_count": 20,
        "score": 14.2,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6367,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-28T13:53:05.817Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"15\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>I am sorry, this is output when you run \u201cstatus json\u201d right - not get . Even in my case, when get gives truncated json, \u201cstatus json\u201d works completely fine.</p>\n</blockquote>\n</aside>\n<p>I always used \u201cget\u201d for the samples above, I just formatted/indented the json to make it more legible (the result of the get is giant blob of json that fills the whole screen).</p>\n<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"15\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Could you please check this in a couple more cases and if everywhere you see it</p>\n</blockquote>\n</aside>\n<p>It seems that the client that uses \u201cUnknown\u201d is probably the backup_agent (cf <a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a>\u2019s answer above).</p>\n<p>I tried with an application connected to that cluster, and I now indeed see the log:</p>\n<pre><code class=\"lang-auto\">    \"cluster\" : {\n        \"clients\" : {\n            \"count\" : 1,\n            \"supported_versions\" : [\n                {\n                    \"client_version\" : \"Unknown\",\n                    \"connected_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:58871\",\n                            \"log_group\" : \"default\"\n                        },\n                        {\n                            \"address\" : \"127.0.0.1:63236\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"count\" : 2,\n                    \"protocol_version\" : \"Unknown\", \n                    \"source_version\" : \"Unknown\"\n                },\n                {\n                    \"client_version\" : \"6.2.15\",\n                    \"connected_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:63027\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"count\" : 1,\n                    \"max_protocol_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:63027\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"max_protocol_count\" : 1,\n                    \"protocol_version\" : \"fdb00b062010001\",\n                    \"source_version\" : \"Current version id not currently supported within Windows.\"\n                }\n            ]\n        },\n</code></pre>\n<p>First entry is probably the backup agent (\u201cUnknown\u201d), while the second one is a Windows application running locally, and it has the \u201cCurrent version id not currently supported within Windows.\u201d message as well.</p>\n<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"15\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Yeah, it happens randomly for me. I works fine for long and then suddenly it stops working. I just now set up a cron which calls this key every 5 minutes and prints the output to a file. Let me see if I see something and how frequently do I see it</p>\n</blockquote>\n</aside>\n<p>Do you know if it is possible that there is another client, application or script that could connect from time to time, and that would inject an invalid value? Maybe when it works is when this client is not connected.</p>\n<p>Maybe one way to find it is if, when the problem occurs, you can <code>netstat</code> the server to look for clients connected to the ports 4500, 4501, \u2026 and look for one that does not appear normally?</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T13:53:56.447Z",
        "reply_count": 2,
        "reply_to_post_number": 15,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 19,
        "readers_count": 18,
        "score": 13.8,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6368,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-28T13:59:40.208Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"16\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I always used \u201cget\u201d for the samples above, I just formatted/indented the json to make it more legible (the result of the get is giant blob of json that fills the whole screen).</p>\n</blockquote>\n</aside>\n<p>Ah, okay, got it!</p>\n<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"16\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>Do you know if it is possible that there is another client, application or script that could connect from time to time, and that would inject an invalid value? Maybe when it works is when this client is not connected.</p>\n</blockquote>\n</aside>\n<p>Sure, let me check this whenever it happens again. But just so I understand, what\u2019s the theory here - how would this client be able to change the output of this special key which calls an internal api to retrieve the status json.?</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T13:59:40.208Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 17,
        "readers_count": 16,
        "score": 8.4,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6369,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-02-28T14:03:00.308Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"KrzysFR\" data-post=\"16\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/krzysfr/48/43_2.png\" class=\"avatar\"> KrzysFR:</div>\n<blockquote>\n<p>I tried with an application connected to that cluster, and I now indeed see the log:</p>\n<pre><code class=\"lang-auto\">    \"cluster\" : {\n        \"clients\" : {\n            \"count\" : 1,\n            \"supported_versions\" : [\n                {\n                    \"client_version\" : \"Unknown\",\n                    \"connected_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:58871\",\n                            \"log_group\" : \"default\"\n                        },\n                        {\n                            \"address\" : \"127.0.0.1:63236\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"count\" : 2,\n                    \"protocol_version\" : \"Unknown\", \n                    \"source_version\" : \"Unknown\"\n                },\n                {\n                    \"client_version\" : \"6.2.15\",\n                    \"connected_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:63027\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"count\" : 1,\n                    \"max_protocol_clients\" : [\n                        {\n                            \"address\" : \"127.0.0.1:63027\",\n                            \"log_group\" : \"default\"\n                        }\n                    ],\n                    \"max_protocol_count\" : 1,\n                    \"protocol_version\" : \"fdb00b062010001\",\n                    \"source_version\" : \"Current version id not currently supported within Windows.\"\n                }\n            ]\n        },\n</code></pre>\n<p>First entry is probably the backup agent (\u201cUnknown\u201d), while the second one is a Windows application running locally, and it has the \u201cCurrent version id not currently supported within Windows.\u201d message as well.</p>\n</blockquote>\n</aside>\n<p>Right, so here in the second entry, order is not followed as expected, right?</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T14:03:00.308Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 16,
        "readers_count": 15,
        "score": 8.2,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6370,
        "name": "Christophe Chevalier",
        "username": "KrzysFR",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "created_at": "2020-02-28T14:34:58.428Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"17\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Sure, let me check this whenever it happens again. But just so I understand, what\u2019s the theory here - how would this client be able to change the output of this special key which calls an internal api to retrieve the status json.?</p>\n</blockquote>\n</aside>\n<p>My idea, and again I don\u2019t have any proof of it, is that this client is sending a string containing its version, protocol version and so on, which is somehow corrupted (as in random bytes and not only text). Looking at the code, it\u2019s supposed to be a string like \u201cversion,version,version\u201d where version is probably <code>\"6.2.17\"</code>, etc\u2026 The code that parses this string puts the corrupted data into string fields in memory. The code that produces the status JSON uses the content of these fields to fill a JSON object, which is sent back to the client as a string. But these random binary bytes would be seen as utf-8 text, except that they are probably not a legal utf-8 sequence, and borks the JSON parser (either server-side or client-side).</p>\n<p>In your samples above, you can see <code>\\x95</code> and <code>\\xd4</code> which are above 128 and don\u2019t look like a valid utf-8 multi-byte sequence. If the utf-8 reader in the json parser stops when it sees these bytes, but somehow the error is not caught, it would explain why you see a truncated output.</p>\n<p>Maybe the <code>status json</code> command uses a different way to parse the json (since it needs to pretty print / indent the result) and does not stop on that byte?</p>\n<p>One experience to invalidate this theory: if every time you see a truncated output, you always see the tail as a double quote followed by <code>\\xHH</code> where HH is a number &gt;= 0x80 and nothing after that, then I would bet on utf-8 decoding issues caused by improperly escaped \u201cbad data\u201d. If sometimes you don\u2019t see \u2018\\xXX\u2019 but regular text without anything after that, then it\u2019s something else.</p>\n<p>Now, why is there bad data in the client_version field, it\u2019s another issue altogether.</p>\n<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"18\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Right, so here in the second entry, order is not followed as expected, right?</p>\n</blockquote>\n</aside>\n<p>I\u2019m not sure. Maybe the JSON object builder class is using an hashtable to store the fields, that does not preserve the order when being serialized, which would explain the fact that the json fields are not in the same order as in the code.</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T14:34:58.428Z",
        "reply_count": 2,
        "reply_to_post_number": 17,
        "quote_count": 2,
        "incoming_link_count": 2,
        "reads": 18,
        "readers_count": 17,
        "score": 23.6,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Christophe Chevalier",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 53,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6373,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2020-02-28T17:43:48.865Z",
        "cooked": "<p>I\u2019ve started <a href=\"https://github.com/apple/foundationdb/pull/2760\">a PR</a> to address this which has some fixes for things I\u2019ve found so far:</p>\n<ol>\n<li>Our binaries like fdbcli will now report a version</li>\n<li>The version list could have been wrong when certain events occur while using the multi-version client</li>\n</ol>\n<p>I don\u2019t think these fixes solve the problem with there being a corrupted version, though I haven\u2019t yet been able to identify why that is happening.</p>\n<p>I also haven\u2019t yet done any work towards fixing the problem with status truncating in response to characters it doesn\u2019t like (assuming that is indeed the problem).</p>\n<aside class=\"quote no-group\" data-username=\"pragya\" data-post=\"15\" data-topic=\"1978\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/p/f0a364/48.png\" class=\"avatar\"> pragya:</div>\n<blockquote>\n<p>Also, did you never observe the issue again? Anything you did to fix it?</p>\n</blockquote>\n</aside>\n<p>I didn\u2019t observe this event myself, but it sounded like it happened multiple times and was resolved by trying to read status again later.</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-02-28T17:43:48.865Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 17,
        "readers_count": 16,
        "score": 13.4,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/pull/2760",
            "internal": false,
            "reflection": false,
            "title": "Improvements to client version reporting by ajbeamon \u00b7 Pull Request #2760 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 4
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 6386,
        "name": "Pragya",
        "username": "pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "created_at": "2020-03-02T11:42:29.739Z",
        "cooked": "<p>Thank you for this. I will definitely keep this in mind when I observe the issue next.</p>",
        "post_number": 21,
        "post_type": 1,
        "posts_count": 29,
        "updated_at": "2020-03-02T11:42:29.739Z",
        "reply_count": 0,
        "reply_to_post_number": 19,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 17,
        "readers_count": 16,
        "score": 3.4,
        "yours": false,
        "topic_id": 1978,
        "topic_slug": "issue-while-querying-special-key-for-status-json",
        "display_username": "Pragya",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 53,
          "username": "KrzysFR",
          "name": "Christophe Chevalier",
          "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 705,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/issue-while-querying-special-key-for-status-json/1978/21",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      6316,
      6320,
      6333,
      6336,
      6339,
      6340,
      6341,
      6343,
      6344,
      6346,
      6350,
      6352,
      6354,
      6366,
      6367,
      6368,
      6369,
      6370,
      6373,
      6386,
      6387,
      6390,
      6394,
      6396,
      6450,
      6451,
      6452,
      6453,
      6885
    ]
  },
  "timeline_lookup": [
    [
      1,
      2065
    ],
    [
      2,
      2064
    ],
    [
      6,
      2063
    ],
    [
      14,
      2062
    ],
    [
      20,
      2059
    ],
    [
      25,
      2051
    ],
    [
      26,
      2050
    ],
    [
      29,
      1997
    ]
  ],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Issue while querying special key for status json",
  "id": 1978,
  "title": "Issue while querying special key for status json",
  "posts_count": 29,
  "created_at": "2020-02-26T10:20:23.595Z",
  "views": 2615,
  "reply_count": 19,
  "like_count": 0,
  "last_posted_at": "2020-05-03T22:51:40.084Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "issue-while-querying-special-key-for-status-json",
  "category_id": 7,
  "word_count": 4934,
  "deleted_at": null,
  "user_id": 705,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_1978",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 30,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 4,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 705,
        "username": "pragya",
        "name": "Pragya",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png",
        "post_count": 11,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 53,
        "username": "KrzysFR",
        "name": "Christophe Chevalier",
        "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png",
        "post_count": 8,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 705,
      "username": "pragya",
      "name": "Pragya",
      "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/p/f0a364/{size}.png"
    },
    "last_poster": {
      "id": 53,
      "username": "KrzysFR",
      "name": "Christophe Chevalier",
      "avatar_template": "/user_avatar/forums.foundationdb.org/krzysfr/{size}/43_2.png"
    },
    "links": [
      {
        "url": "https://github.com/apple/foundationdb/pull/2760",
        "title": "Improvements to client version reporting by ajbeamon \u00b7 Pull Request #2760 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 12,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/Doxense/foundationdb-dotnet-client/blob/f163b7e369aeb7171849090701b155657897e02d/FoundationDB.Client/Fdb.System.cs#L99",
        "title": "foundationdb-dotnet-client/Fdb.System.cs at f163b7e369aeb7171849090701b155657897e02d \u00b7 Doxense/foundationdb-dotnet-client \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 53,
        "domain": "github.com",
        "root_domain": "github.com"
      }
    ]
  },
  "bookmarks": []
}