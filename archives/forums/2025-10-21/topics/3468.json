{
  "post_stream": {
    "posts": [
      {
        "id": 11523,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-07-27T05:43:33.478Z",
        "cooked": "<p>I am currently exploring the design of the Record Layer from the ground up.</p>\n<p>Rather than create multiple threads with my questions, I am hoping to create one thread.</p>\n<p>My hope is that discussions in this thread will be helpful to me for my Rust layer and also for future layer developers as they try to build layers leveraging ideas from the Record Layer.</p>\n<p>In the <a href=\"https://javadoc.io/doc/org.foundationdb/fdb-record-layer-core-pb3/latest/com/apple/foundationdb/record/EndpointType.html\" rel=\"noopener nofollow ugc\"><code>EndpointType</code></a> type, there are two variants that are named <code>TREE_START</code> and <code>TREE_END</code>. I was wondering if there was any specific reason for naming the variants with the prefix of <code>TREE_</code>?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-07-27T05:43:33.478Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 329,
        "reads": 53,
        "readers_count": 52,
        "score": 1650.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://javadoc.io/doc/org.foundationdb/fdb-record-layer-core-pb3/latest/com/apple/foundationdb/record/EndpointType.html",
            "internal": false,
            "reflection": false,
            "title": "EndpointType - fdb-record-layer-core-pb3 2.10.164.0 javadoc",
            "clicks": 6
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 11579,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-08-15T07:46:27.843Z",
        "cooked": "<p>Did FoundationDB in the past have a limit on the number of key-values that could be read in a transaction?</p>\n<p>The reason I ask is because RecordLayer includes a <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordScanLimiter.html\" rel=\"noopener nofollow ugc\"><code>RecordScanLimiter</code></a> as a \u201cout-of-band\u201d limiter.</p>\n<p>While I understand the need for <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/ByteScanLimiter.html\" rel=\"noopener nofollow ugc\"><code>ByteScanLimiter</code></a> and <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/TimeScanLimiter.html\" rel=\"noopener nofollow ugc\"><code>TimeScanLimiter</code></a> given FoundationDB <a href=\"https://apple.github.io/foundationdb/known-limitations.html#design-limitations\" rel=\"noopener nofollow ugc\">design imitations</a>, was wondering if there was a reason for <code>RecordScanLimiter</code> to exist as an out-of-band limiter?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-08-15T07:51:26.323Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 5,
        "reads": 53,
        "readers_count": 52,
        "score": 40.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://apple.github.io/foundationdb/known-limitations.html#design-limitations",
            "internal": false,
            "reflection": false,
            "title": "Known Limitations \u2014 FoundationDB 7.1",
            "clicks": 6
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordScanLimiter.html",
            "internal": false,
            "reflection": false,
            "title": "RecordScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 3
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/TimeScanLimiter.html",
            "internal": false,
            "reflection": false,
            "title": "TimeScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 1
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/ByteScanLimiter.html",
            "internal": false,
            "reflection": false,
            "title": "ByteScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 1
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11583,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-08-16T18:00:07.346Z",
        "cooked": "<p>What <code>TREE_</code> needs to indicate is that it\u2019s something independent of the range keys passed to the API, and, moreover, the lowest / highest such thing, in context. And since that context might be an index or a the primary extent, or really any other subtree in the record store, something neutral is required.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-08-16T18:00:07.346Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 49,
        "readers_count": 48,
        "score": 39.8,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11584,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-08-16T18:10:03.533Z",
        "cooked": "<p>Records (or \u201crows\u201d) scanned is a pretty good proxy for the amount of work done, particularly by a query. The current design, based partly on the underlying limitations of the key-value store, but also on a requirement to support many tenants with pretty high throughput, is that you must either limit the work done in that way, or else license the system to stop and pick up again later with even lower per-transaction thresholds.</p>\n<p>Specifically, the number of keys scanned is a pretty good indicator of poor index definition / selection, that might still slip in under a byte limit (all the index entries / records are small) or time limit (you can get a lot read in a few seconds).</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-08-16T18:10:03.533Z",
        "reply_count": 0,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 48,
        "readers_count": 47,
        "score": 34.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11628,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-08-26T06:21:13.952Z",
        "cooked": "<p>For the <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html#setLow%28byte%5B%5D,com.apple.foundationdb.record.EndpointType%29\" rel=\"noopener nofollow ugc\"><code>setLow</code></a> and <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html#setHigh%28byte%5B%5D,com.apple.foundationdb.record.EndpointType%29\" rel=\"noopener nofollow ugc\"><code>setHigh</code></a> methods on an instance of <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html\" rel=\"noopener nofollow ugc\"><code>KeyValueCursor.Builder</code></a> class, is there a scenario wherein we might set the argument <code>lowEndpoint</code> or <code>highEndpoint</code> to <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/EndpointType.html#CONTINUATION\" rel=\"noopener nofollow ugc\"><code>EndpointType.CONTINUATION</code></a>?</p>\n<p>Even though the API allows for this possibility, I was unable to think of a scenario where this could be useful. Therefore wanted check if I was missing some use-case.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-08-26T06:21:55.841Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 41,
        "readers_count": 40,
        "score": 13.2,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html#setLow%28byte%5B%5D,com.apple.foundationdb.record.EndpointType%29",
            "internal": false,
            "reflection": false,
            "title": "KeyValueCursor.Builder (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 2
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html",
            "internal": false,
            "reflection": false,
            "title": "KeyValueCursor.Builder (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 1
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/EndpointType.html#CONTINUATION",
            "internal": false,
            "reflection": false,
            "title": "EndpointType (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 1
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html#setHigh%28byte%5B%5D,com.apple.foundationdb.record.EndpointType%29",
            "internal": false,
            "reflection": false,
            "title": "KeyValueCursor.Builder (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11632,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-08-26T20:01:23.817Z",
        "cooked": "<p>I think you\u2019re right. That endpoint type emerges in the building of the key-value cursor by <code>KeyValueCursor.Builder.setContinuation</code>. It\u2019s really kind of internal, but that\u2019s hard to do without having two <code>enum</code>s, which seemed like more work than it was worth.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-08-26T20:01:23.817Z",
        "reply_count": 1,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 37,
        "readers_count": 36,
        "score": 37.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11710,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-09-12T05:52:25.202Z",
        "cooked": "<p>In the design of <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/cursors/CursorLimitManager.html\" rel=\"noopener nofollow ugc\"><code>CursorLimitManger</code></a>, there is a notion of a \u201cfree initial pass\u201d.</p>\n<p>I was wondering if the reason why Record Layer needs to provide a free initial pass is because, the serialized form of <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordCursorStartContinuation.html\" rel=\"noopener nofollow ugc\"><code>RecordCursorStartContinuation</code></a> and <a href=\"https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordCursorEndContinuation.html\" rel=\"noopener nofollow ugc\"><code>RecordCursorEndContinuation</code></a> are the same?</p>\n<p>As a consequence of the \u201cfree initial pass\u201d, if a continuation is returned, it can be assumed that only <code>RecordCursorEndContinuation</code> would be returned.</p>\n<p>In my design, I am explicitly modeling the notion of a start continuation and end continuation that can be returned by the equivalent of <code>RecordCursorResult&lt;T&gt;</code>. The way I am thinking about this problem is that suppose a cursor gets created, and an out-of-band limit gets triggered even before the first value can be read and processed. In such a case, a <code>RecordCusorStartContinuation</code> would be returned.</p>\n<p>The API user can then pass <code>RecordCusorStartContinuation</code> in a new transaction and then proceed to read values.</p>\n<p>Similarly, when the cursor has been exhausted, <code>RecordCusorEndContinuation</code> would get returned, and if the API user tries to do a <code>setContinuation</code> using a value of <code>RecordCusorEndContinuation</code>, the <code>onNext</code> method would keep returning value of <code>RecordCusorEndContinuation</code>.</p>\n<p>In such a scenario, is there a need to provide \u201cfree initial pass\u201d?</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-09-12T05:52:25.202Z",
        "reply_count": 1,
        "reply_to_post_number": 6,
        "quote_count": 0,
        "incoming_link_count": 6,
        "reads": 38,
        "readers_count": 37,
        "score": 42.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/cursors/CursorLimitManager.html",
            "internal": false,
            "reflection": false,
            "title": "CursorLimitManager (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 2
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordCursorStartContinuation.html",
            "internal": false,
            "reflection": false,
            "title": "RecordCursorStartContinuation (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 0
          },
          {
            "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordCursorEndContinuation.html",
            "internal": false,
            "reflection": false,
            "title": "RecordCursorEndContinuation (fdb-record-layer-core-pb3 2.10.164.0 API)",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 219,
          "username": "MMcM",
          "name": "Mike McMahon",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11743,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-09-19T18:10:27.054Z",
        "cooked": "<p>If a scan returns a <code>RecordCusorStartContinuation</code>, then it didn\u2019t make any progress at all, correct? What if it did that every time? The caller would be stuck. This is the situation the free pass tries to avoid. It might well be that nothing happens only sometimes, in which case there is (slow) progress overall. But we did not feel confident in that.</p>\n<p>The serialization is a little confusing, I agree. But, when necessary, they can be disambiguated with another bit of information. That is what the <code>first_exhausted</code> field in a <code>UnionContinuation</code> is about. It\u2019s perfectly legal, perhaps even a regular occurrence, for one branch of a union to be at the start because all the values returned so far came from the other branch(es). To reach this state, the free pass might have been used on that branch to see the values that it then decided not to return: this is fundamental to unions; they do more work when there are continuations than is representable and so that therefore needs to be repeated when called again. But the top-level continuation is never still at the start position.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-09-19T18:10:27.054Z",
        "reply_count": 1,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 32,
        "readers_count": 31,
        "score": 21.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 11745,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-09-20T05:18:51.818Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"MMcM\" data-post=\"8\" data-topic=\"3468\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/m/d07c76/48.png\" class=\"avatar\"> MMcM:</div>\n<blockquote>\n<p>If a scan returns a <code>RecordCusorStartContinuation</code>, then it didn\u2019t make any progress at all, correct?</p>\n</blockquote>\n</aside>\n<p>Thanks for the reply! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> That\u2019s correct. <a href=\"https://gist.github.com/rajivr/389ac3dfe3aff53e7eff3cbbd0a13517\" rel=\"noopener nofollow ugc\">Here</a> are my tests for this. In my implementation, I\u2019m referring to <code>RecordCusorStartContinuation</code> as <code>key_value_continuation_v0_begin_marker_bytes</code>. I am thinking of a continuation as a pointer/marker that exists between two key values. So, a range would consist of the number of keys covered by the range plus two (the begin marker and end marker). An empty range would consist of only a begin marker and end marker.</p>\n<p>As you can see from the tests, when the begin marker bytes is passed, the range that gets created is no different to a range that gets created if no continuation was passed.</p>\n<aside class=\"quote no-group\" data-username=\"MMcM\" data-post=\"8\" data-topic=\"3468\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/m/d07c76/48.png\" class=\"avatar\"> MMcM:</div>\n<blockquote>\n<p>What if it did that every time? The caller would be stuck.</p>\n</blockquote>\n</aside>\n<p>AFAICT, this will happen in case an out-of-band limit got triggered every time in a specific code path. At the compute layer since the goal is to have bounded transaction and query cost, I feel its the responsibility of the API user to have properly analyzed the cost of the query.</p>\n<p>In the worst case scenario, the user facing web services API would get rate-limited or return an error, in which case, the developer can figure out what really went wrong and why the query was getting stuck.</p>\n<aside class=\"quote no-group\" data-username=\"MMcM\" data-post=\"8\" data-topic=\"3468\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://avatars.discourse-cdn.com/v4/letter/m/d07c76/48.png\" class=\"avatar\"> MMcM:</div>\n<blockquote>\n<p>The serialization is a little confusing, I agree. But, when necessary, they can be disambiguated with another bit of information.</p>\n</blockquote>\n</aside>\n<p>It took me a while to figure it out <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"> The continuation/cursor abstraction and effectively managing out-of-band limits seem to be a very important idea that layer developers need to be aware of. I am glad I invested the time to understand this design pattern. Once my implementation is complete, I am hoping to give a talk about this and my implementation in an upcoming meetup.</p>\n<p>I\u2019ve not yet gotten to the stage of understanding <code>UnionContinuation</code> abstraction. Thanks again for answering my questions. I really appreciate it! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-09-20T05:26:04.692Z",
        "reply_count": 1,
        "reply_to_post_number": 8,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 30,
        "readers_count": 29,
        "score": 16.0,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://gist.github.com/rajivr/389ac3dfe3aff53e7eff3cbbd0a13517",
            "internal": false,
            "reflection": false,
            "title": "test_range_and_continuation.rs \u00b7 GitHub",
            "clicks": 7
          }
        ],
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12113,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-12-10T00:49:34.998Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/mmcm\">@MMcM</a> I was wondering if you might be able to share the motivation for <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/3.3.316.0/fdb-record-layer-core/src/test/java/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursorTest.java#L229-L249\" rel=\"noopener nofollow ugc\"><code>inclusiveNull</code></a> and <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/3.3.316.0/fdb-record-layer-core/src/test/java/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursorTest.java#L251-L266\" rel=\"noopener nofollow ugc\"><code>exclusiveNull</code></a> tests in <code>KeyValueCursorTest.java</code>.</p>\n<p>In what context would a user of the cursor API attempt to build such a cursor?</p>\n<p>Since the design of my cursor is very similar to RecordLayer\u2019s cursor design, I was able to create a <a href=\"https://gist.github.com/rajivr/7d090072d190bf83d14c46057facf8b5\" rel=\"noopener nofollow ugc\">similar</a> test case in Rust, but was unable to understand the motivation for it when writing the test case.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-10T00:49:34.998Z",
        "reply_count": 1,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 18,
        "readers_count": 17,
        "score": 8.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://gist.github.com/rajivr/7d090072d190bf83d14c46057facf8b5",
            "internal": false,
            "reflection": false,
            "title": "{inclusive,exclusive}_null.rs \u00b7 GitHub",
            "clicks": 1
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/3.3.316.0/fdb-record-layer-core/src/test/java/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursorTest.java#L229-L249",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/KeyValueCursorTest.java at 3.3.316.0 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/3.3.316.0/fdb-record-layer-core/src/test/java/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursorTest.java#L251-L266",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/KeyValueCursorTest.java at 3.3.316.0 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12120,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-12-12T21:51:37.774Z",
        "cooked": "<p>If I am not mistaken, that block of tests was added to capture how the API behaved and guard against regressions. As opposed to all the cases it covers being genuinely useful.</p>\n<p>In particular, exclusive high null is kind of weird. It might be equally reasonable, in something new, to give an error for this case. Some of the time it generates a malformed <code>Range</code>, that is, one in which the begin is not <code>&lt;=</code> end. The Java binding doesn\u2019t complain; you just don\u2019t get any data.</p>\n<p>Null for low is easy. In fact, it doesn\u2019t much differ from the empty byte string. Null for high is trying to represent something that doesn\u2019t have such a concrete representation, since there is no (inherent) limit on the length of a key.</p>\n<p>Another possibility is that the code is trying too hard to have a meaningful distinction between inclusive and exclusive in this case. They differ by a single point; but that point does not exist in any real enumeration of key-value pairs.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-12T22:27:42.368Z",
        "reply_count": 1,
        "reply_to_post_number": 10,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 17,
        "readers_count": 16,
        "score": 23.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12122,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-12-13T14:01:51.796Z",
        "cooked": "<p>In terms of API design, you have a <code>Subspace</code>, meaning a key prefix understood as an interval, and the a byte string monad.</p>\n<ol>\n<li>Do away with endpoint types; begin is always inclusive and end is always exclusive. To get exclusive begin or inclusive end, use the byte string successor function. The None value represents the successor of the subspace prefix key itself (when converted to a Range by the key value cursor implementation).</li>\n<li>Accept both inclusive and exclusive endpoint type with None for that.</li>\n<li>Accept inclusive and exclusive is an error, on the grounds that every possible key is included.</li>\n<li>The other way around, on the grounds that the successor key is outside the subspace and so cannot be included.</li>\n</ol>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-13T14:17:53.072Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 18,
        "readers_count": 17,
        "score": 28.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 219,
          "username": "MMcM",
          "name": "Mike McMahon",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12136,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-12-19T02:16:28.990Z",
        "cooked": "<p>As I was studying the design of <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/3.3.319.0/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBRecordVersion.java#L36-L48\" rel=\"noopener nofollow ugc\"><code>FDBRecordVersion</code></a> type, in the documentation it says,</p>\n<blockquote>\n<p>Together, this two versions are combined into a 12 byte array that can be used to impose a total order across all records.</p>\n</blockquote>\n<p>From what I <a href=\"https://apple.github.io/foundationdb/data-modeling.html#versionstamps\" rel=\"noopener nofollow ugc\">understand</a> the C API level 10 byte \u201cversionstamp\u201d (transaction\u2019s commit version (8 bytes) +  transaction\u2019s batch order (2 bytes)) can give us total ordering of transactions within a <em>single</em> FDB cluster.</p>\n<p>We combine this information with transaction level ordering in the Tuple layer.</p>\n<p>However, from what I can make out, this ordering is not guaranteed to hold when we move records between FDB clusters.</p>\n<p>Therefore, wouldn\u2019t we also need to somehow capture \u201cgeneration\u201d information here in order to have a total ordering of values of <code>FDBRecordVersion</code> type?</p>\n<p>Is this information captured elsewhere in the RecordLayer?</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-19T02:16:28.990Z",
        "reply_count": 1,
        "reply_to_post_number": 12,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 17,
        "readers_count": 16,
        "score": 8.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/3.3.319.0/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBRecordVersion.java#L36-L48",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/FDBRecordVersion.java at 3.3.319.0 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://apple.github.io/foundationdb/data-modeling.html#versionstamps",
            "internal": false,
            "reflection": false,
            "title": "Data Modeling \u2014 FoundationDB 7.2",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 219,
          "username": "MMcM",
          "name": "Mike McMahon",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12141,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2022-12-19T18:20:53.301Z",
        "cooked": "<p>There is currently no support for doing this correctly in Record Layer itself. There could be, but it is not required that it be there in the same way as <code>FDBRecordVersion</code>.</p>\n<p>One scheme, in fact the one described in our SIGMOD paper, is to have a count of the number of cross-cluster moves. When saving, this is copied into a \u201csystem field\u201d of the record, next to the in-cluster version. Then the total ordering is from an index that concatenates that counter with the version. Any record written after a move comes after all records from the previous place. The record data itself does not need to be affected by the move, except for the single \u201csystem record\u201d that holds the counter (and similar information about the record store that informs catalogue-like lookups).</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-19T18:21:42.623Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 21,
        "readers_count": 20,
        "score": 39.2,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12152,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2022-12-22T03:23:56.210Z",
        "cooked": "<p>As mentioned in the following post</p>\n<aside class=\"quote quote-modified\" data-post=\"2\" data-topic=\"1481\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/alloc/48/9_2.png\" class=\"avatar\">\n    <a href=\"https://forums.foundationdb.org/t/key-val-sizes-in-the-record-layer/1481/2\">Key-val sizes in the Record Layer</a> <a class=\"badge-category__wrapper \" href=\"/c/using-layers/record-layer/12\"><span data-category-id=\"12\" data-parent-category-id=\"14\" data-drop-close=\"true\" class=\"badge-category --has-parent\" title=\"Topics related to the FoundationDB Record Layer.\"><span class=\"badge-category__name\">Record Layer</span></span></a>\n  </div>\n  <blockquote>\n    Hm, the feature alluded to in the paper there is just that singe records are split across multiple key-value pairs, so single records are not subject to the 100 kB \u201cmax value\u201d size limit. \nThe \u201ccatch\u201d is: \n\nThe Record Layer will choose to split your record so that each value (except the last) is 100 kB in size (right up to the limit). It\u2019s possible that the key value store would do better if the data were split across more, smaller keys; it\u2019s also possible that 100 kB is optimal, but we haven\u2019t \u2026\n  </blockquote>\n</aside>\n\n<p>It looks to me that RecordLayer does not track the 10MB limit for transactions and makes the higher level code responsible for handling \u201ctransaction_too_large (2101)\u201d error. Just want to confirm that it is still the case?</p>\n<p>While exceeding the 10MB limit would result in a transaction too large error, in our application, we could inadvertently exceed the 1MB limit, thereby causing a performance issue.</p>\n<p>I was wondering if some mechanism exists within Record Layer and FoundationDB that would let us log such transactions, so we can investigate them later on?</p>\n<p>The only mechanism that I was able to think of was to set the transaction option <a href=\"https://docs.rs/fdb/0.3.1/fdb/transaction/enum.TransactionOption.html#variant.SizeLimit\" rel=\"noopener nofollow ugc\"><code>SizeLimit</code></a> to 1MB, but that would fail any transaction larger than 1MB. Is there some option that would allow us to log transactions larger than 1MB, but not fail them?</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2022-12-22T04:01:19.066Z",
        "reply_count": 1,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 4,
        "reads": 22,
        "readers_count": 21,
        "score": 29.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://forums.foundationdb.org/t/key-val-sizes-in-the-record-layer/1481/2",
            "internal": true,
            "reflection": false,
            "title": "Key-val sizes in the Record Layer",
            "clicks": 0
          },
          {
            "url": "https://docs.rs/fdb/0.3.1/fdb/transaction/enum.TransactionOption.html#variant.SizeLimit",
            "internal": false,
            "reflection": false,
            "title": "TransactionOption in fdb::transaction - Rust",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 219,
          "username": "MMcM",
          "name": "Mike McMahon",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12180,
        "name": "Alec Grieser",
        "username": "alloc",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "created_at": "2023-01-03T10:08:50.058Z",
        "cooked": "<p>Yes, that\u2019s right: the Record Layer does not independently track the size of transactions, and instead, it will bubble up the transation_too_large error (as an <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/aed016cc4de4267d3a6ac28986a7f79c8b163201/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBExceptions.java#L180\"><code>FDBStoreTransationSizeException</code></a>). The main reason for this is that the calculation for transaction size is a little delicate, and as it includes FDB internal data (like conflict ranges) that can be somewhat difficult to reason about, and so replicating the exact logic from FDB in a layer above can be error-prone.</p>\n<p>That being said, the <code>FDBRecordContext</code> class does expose a method, <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/aed016cc4de4267d3a6ac28986a7f79c8b163201/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBTransactionContext.java#L77\"><code>getApproximateTransactionSize()</code></a>, which asks the underlying transaction approximately how big the transaction already is. (It\u2019s approximate because mutations and conflict ranges are coalesced by the FDB client (so, for example, if you set a key multiple times, only the final set is actually sent to the FDB server), and the approximate transaction size method can, for efficiency of calculation, overestimate the final transaction size by not taking future updates into account. It also returns a future, though it makes no network calls, though it does end up enqueuing a task on the FDB client\u2019s task queue, so it can be delayed if the FDB client is too busy.) That can be used as a sort of upper bound to transaction size, so if you are doing a bunch of mutations where atomicity is flexible, you can use the transaction size to guard the size of each individual transaction. The Record Layer itself actually uses this during index builds, for example: <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/IndexingBase.java#L740\" class=\"inline-onebox\">fdb-record-layer/IndexingBase.java at 238a4f27d672082c122be2f402d698ca2f292dba \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub</a></p>\n<p>In terms of logging large transactions, <code>fdbserver</code> already will log any large transactions with the <code>LargeTransaction</code> trace event: <a href=\"https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/fdbserver/CommitProxyServer.actor.cpp#L393\" class=\"inline-onebox\">foundationdb/CommitProxyServer.actor.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub</a> By default, it logs if the transaction exceeds 2 MiB, though you can adjust that knob via command line arguments to FDB server: <a href=\"https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/flow/Knobs.cpp#L214\" class=\"inline-onebox\">foundationdb/Knobs.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub</a> There are also client-side logs, which use the same knob, but they have a bit more useful information including the transaction\u2019s debug ID: <a href=\"https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/fdbclient/NativeAPI.actor.cpp#L6668\">https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/fdbclient/NativeAPI.actor.cpp#L6668</a> So, assuming you have client trace logs set up (configured by <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBDatabaseFactory.java#L611\"><code>FDBDatabaseFactory::setTrace</code></a>) and are setting the transaction ID to something that you can then use to correlate with own logs (via <a href=\"https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBRecordContextConfig.java#L409\"><code>FDBRecordContextConfig::setTransactionId</code></a>), you should be able to look for large transactions. Note that changing the limit on the client-side logs is difficult, because client knobs aren\u2019t really exposed, unlike server knobs.</p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2023-01-03T10:08:50.058Z",
        "reply_count": 1,
        "reply_to_post_number": 15,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 21,
        "readers_count": 20,
        "score": 29.2,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Alec Grieser",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/flow/Knobs.cpp#L214",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/Knobs.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 1
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/IndexingBase.java#L740",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/IndexingBase.java at 238a4f27d672082c122be2f402d698ca2f292dba \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 1
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBDatabaseFactory.java#L611",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/FDBDatabaseFactory.java at 238a4f27d672082c122be2f402d698ca2f292dba \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBRecordContextConfig.java#L409",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/FDBRecordContextConfig.java at 238a4f27d672082c122be2f402d698ca2f292dba \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/aed016cc4de4267d3a6ac28986a7f79c8b163201/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBExceptions.java#L180",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/FDBExceptions.java at aed016cc4de4267d3a6ac28986a7f79c8b163201 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/FoundationDB/fdb-record-layer/blob/aed016cc4de4267d3a6ac28986a7f79c8b163201/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/FDBTransactionContext.java#L77",
            "internal": false,
            "reflection": false,
            "title": "fdb-record-layer/FDBTransactionContext.java at aed016cc4de4267d3a6ac28986a7f79c8b163201 \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/fdbserver/CommitProxyServer.actor.cpp#L393",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/CommitProxyServer.actor.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          },
          {
            "url": "https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/fdbclient/NativeAPI.actor.cpp#L6668",
            "internal": false,
            "reflection": false,
            "title": "foundationdb/NativeAPI.actor.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 8,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12188,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2023-01-04T01:34:22.813Z",
        "cooked": "<p>Thanks <a class=\"mention\" href=\"/u/alloc\">@alloc</a> for the reply and Happy New Year 2023! <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2023-01-04T01:34:22.813Z",
        "reply_count": 1,
        "reply_to_post_number": 16,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 21,
        "readers_count": 20,
        "score": 9.2,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 8,
          "username": "alloc",
          "name": "Alec Grieser",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12384,
        "name": "Rajiv M Ranganath",
        "username": "rajivr",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "created_at": "2023-02-10T02:51:15.544Z",
        "cooked": "<p>As I was exploring the design of Rust equivalent of <code>FDBRawRecord</code> type, I noticed that it might be beneficial to have a simple schema/type system for specifying the semantics of a tuple.</p>\n<p>What got me thinking in this direction was that not all tuple forms would be \u201cvalid\u201d in all circumstances and it would be better to disallow creation of invalid tuple forms or when invalid tuple forms are read from the database, catch that error as early as possible.</p>\n<p>For example:</p>\n<ul>\n<li>\n<p>Having a value of <code>null</code> (unit) type or a value of <code>Versionstamp</code> type does not really make sense, for a primary key tuple. <code>null</code> is used to indicate a \u201cmissing value\u201d. Primary key for a missing value, is a bit weird.</p>\n</li>\n<li>\n<p>For indexes, we can have <code>null</code> value. But it might be beneficial to know the nature of <code>null</code>. Is it a missing value of an Integer, ByteArray, String, etc.,?</p>\n</li>\n</ul>\n<p>I\u2019ve therefore created two types <a href=\"https://rajivr.github.io/fdb-rl-wip/fdb/tuple/enum.TupleSchemaElement.html\" rel=\"noopener nofollow ugc\"><code>TupleSchemaElement</code></a> and <a href=\"https://rajivr.github.io/fdb-rl-wip/fdb/tuple/struct.TupleSchema.html\" rel=\"noopener nofollow ugc\"><code>TupleSchema</code></a> and a simple <a href=\"https://rajivr.github.io/fdb-rl-wip/fdb/tuple/struct.TupleSchema.html#method.validate\" rel=\"noopener nofollow ugc\">function</a> to check the validity of a tuple to its schema.</p>\n<p>I was wondering if this design was previously explored by the Record Layer team. If so can you please let me know what pros and cons were discussed?</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2023-02-10T04:36:09.913Z",
        "reply_count": 0,
        "reply_to_post_number": 17,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 22,
        "readers_count": 21,
        "score": 4.4,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Rajiv M Ranganath",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 2,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "link_counts": [
          {
            "url": "https://rajivr.github.io/fdb-rl-wip/fdb/tuple/struct.TupleSchema.html#method.validate",
            "internal": false,
            "reflection": false,
            "title": "TupleSchema in fdb::tuple - Rust",
            "clicks": 1
          },
          {
            "url": "https://rajivr.github.io/fdb-rl-wip/fdb/tuple/enum.TupleSchemaElement.html",
            "internal": false,
            "reflection": false,
            "title": "TupleSchemaElement in fdb::tuple - Rust",
            "clicks": 0
          },
          {
            "url": "https://rajivr.github.io/fdb-rl-wip/fdb/tuple/struct.TupleSchema.html",
            "internal": false,
            "reflection": false,
            "title": "TupleSchema in fdb::tuple - Rust",
            "clicks": 0
          }
        ],
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 946,
          "username": "rajivr",
          "name": "Rajiv M Ranganath",
          "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 946,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12391,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2023-02-10T19:25:21.258Z",
        "cooked": "<p>A couple of observations on your examples, which I realize are not central to your feature. First, there are subtleties, but it might be useful to have versionstamps in primary keys, even though Record Layer does not support it today. Second, Record Layer does support <code>null</code> as a primary key element, as well as as an indexed value. This is less about having \u201cunknown\u201d information there and more as a distinguished member of every type domain. This turns out to sometimes be easier to deal with than special casing the empty string or zero. It doesn\u2019t come for free, though. We had to introduce null-standins and the distinction between unique and non-unique nulls. Which, interestingly enough, Postgres 15 added to their SQL.</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2023-02-10T19:25:21.258Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 23,
        "readers_count": 22,
        "score": 4.6,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 12393,
        "name": "Mike McMahon",
        "username": "MMcM",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "created_at": "2023-02-10T19:46:04.910Z",
        "cooked": "<p>To your main point, yes, I think that is a good idea. The closest thing you will find today is <code>...cascades.typing.Type.Record</code>, which is used by the Cascades planner to reason about both records and their materialized view index projections.</p>\n<p>I think that there are a few reasons why we haven\u2019t had it in the mainline yet.</p>\n<ul>\n<li>We don\u2019t treat streams of index values as first-class results. This is a mistake; you\u2019ll find a bunch of PR comments referring to this. For covering index scans, we squeeze the values the index does have into the original record structure. Which is particularly odd when it comes to repeated nested fields because we only populate the one(s) that is in the index. Scans should be streams of records in the type sense above, not in the strict Protobuf sense, although that is an important special case.</li>\n<li>Java does not have first-class typed tuples, other, perhaps, than <code>Pair&lt;x,y&gt;</code>.</li>\n<li>Java does have just-good-enough reflection that you can postpone reasoning about things to pretty late at runtime.</li>\n</ul>\n<p>I don\u2019t know what you are thinking about for your runtime execution. But I wonder whether you might want to make sure that your tuple schema is compatible with native tuples. As far as I know, the Rust FDB bindings do not have <code>serde</code>-style serialization and deserialization of tuples into corresponding <code>struct</code>s. But it could, I think. Along with <code>prost</code>-generated protobuf.</p>\n<p>Record Layer has some modest type safety along these lines with typed record stores, but they are sometimes challenging to work with because Java generics sometimes are.</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 22,
        "updated_at": "2023-02-10T19:46:04.910Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 26,
        "readers_count": 25,
        "score": 15.2,
        "yours": false,
        "topic_id": 3468,
        "topic_slug": "record-layer-design-questions",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 219,
        "hidden": false,
        "trust_level": 1,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/record-layer-design-questions/3468/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      11523,
      11579,
      11583,
      11584,
      11628,
      11632,
      11710,
      11743,
      11745,
      12113,
      12120,
      12122,
      12136,
      12141,
      12152,
      12180,
      12188,
      12384,
      12391,
      12393,
      12400,
      13090
    ]
  },
  "timeline_lookup": [
    [
      1,
      1183
    ],
    [
      2,
      1164
    ],
    [
      3,
      1162
    ],
    [
      5,
      1153
    ],
    [
      6,
      1152
    ],
    [
      7,
      1136
    ],
    [
      8,
      1128
    ],
    [
      10,
      1047
    ],
    [
      11,
      1044
    ],
    [
      12,
      1043
    ],
    [
      13,
      1038
    ],
    [
      14,
      1037
    ],
    [
      15,
      1035
    ],
    [
      16,
      1023
    ],
    [
      17,
      1022
    ],
    [
      18,
      985
    ],
    [
      19,
      984
    ],
    [
      21,
      983
    ],
    [
      22,
      824
    ]
  ],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "Record Layer Design Questions",
  "id": 3468,
  "title": "Record Layer Design Questions",
  "posts_count": 22,
  "created_at": "2022-07-27T05:43:33.408Z",
  "views": 1688,
  "reply_count": 16,
  "like_count": 7,
  "last_posted_at": "2023-07-20T14:19:37.434Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "record-layer-design-questions",
  "category_id": 9,
  "word_count": 4833,
  "deleted_at": null,
  "user_id": 946,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_3468",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 22,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 3,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 946,
        "username": "rajivr",
        "name": "Rajiv M Ranganath",
        "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png",
        "post_count": 12,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 219,
        "username": "MMcM",
        "name": "Mike McMahon",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/m/d07c76/{size}.png",
        "post_count": 9,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 1
      },
      {
        "id": 8,
        "username": "alloc",
        "name": "Alec Grieser",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alloc/{size}/9_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 946,
      "username": "rajivr",
      "name": "Rajiv M Ranganath",
      "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
    },
    "last_poster": {
      "id": 946,
      "username": "rajivr",
      "name": "Rajiv M Ranganath",
      "avatar_template": "/user_avatar/forums.foundationdb.org/rajivr/{size}/1100_2.png"
    },
    "links": [
      {
        "url": "https://rajivr.github.io/fdb-rl-wip/fdb_rl/raw_record/struct.RawRecord.html#primary-key-schema-constraint",
        "title": "RawRecord in fdb_rl::raw_record - Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 9,
        "user_id": 946,
        "domain": "rajivr.github.io",
        "root_domain": "rajivr.github.io"
      },
      {
        "url": "https://kuzudb.com/",
        "title": "Home | K\u00f9zuDB",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 8,
        "user_id": 946,
        "domain": "kuzudb.com",
        "root_domain": "kuzudb.com"
      },
      {
        "url": "https://docs.google.com/document/d/17MwwGVObca3Y_KBDNM3Gkz-8znI7C_ZLdYT3gflfo0M/",
        "title": "fdb-rl Crate Idempotency Design - Google Docs",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 946,
        "domain": "docs.google.com",
        "root_domain": "google.com"
      },
      {
        "url": "https://gist.github.com/rajivr/389ac3dfe3aff53e7eff3cbbd0a13517",
        "title": "test_range_and_continuation.rs \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 946,
        "domain": "gist.github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/quickwit-oss/quickwit/tree/v0.4.0/quickwit/quickwit-metastore",
        "title": "quickwit/quickwit/quickwit-metastore at v0.4.0 \u00b7 quickwit-oss/quickwit \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 7,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://apple.github.io/foundationdb/known-limitations.html#design-limitations",
        "title": "Known Limitations \u2014 FoundationDB 7.1",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 6,
        "user_id": 946,
        "domain": "apple.github.io",
        "root_domain": "apple.github.io"
      },
      {
        "url": "https://javadoc.io/doc/org.foundationdb/fdb-record-layer-core-pb3/latest/com/apple/foundationdb/record/EndpointType.html",
        "title": "EndpointType - fdb-record-layer-core-pb3 2.10.164.0 javadoc",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 6,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://rajivr.github.io/fdb-rl-wip/fdb_rl/split_helper/index.html",
        "title": "fdb_rl::split_helper - Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 5,
        "user_id": 946,
        "domain": "rajivr.github.io",
        "root_domain": "rajivr.github.io"
      },
      {
        "url": "https://github.com/quickwit-oss/tantivy",
        "title": "GitHub - quickwit-oss/tantivy: Tantivy is a full-text search engine library inspired by Apache Lucene and written in Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 5,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://duckdb.org/docs/archive/0.6.1/extensions/overview",
        "title": "DuckDB - Extensions",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 4,
        "user_id": 946,
        "domain": "duckdb.org",
        "root_domain": "duckdb.org"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/RecordScanLimiter.html",
        "title": "RecordScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://docs.rs/prost-reflect/0.11.4/prost_reflect/",
        "title": "prost_reflect - Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 3,
        "user_id": 946,
        "domain": "docs.rs",
        "root_domain": "docs.rs"
      },
      {
        "url": "https://github.com/rajivr/fdb-rl-wip/tree/main/fdb-rl/sismic",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://github.com/rajivr/fdb-rl-wip/blob/main/fdb-rl-proto/proto/fdb_rl/cursor/v1/cursor.proto",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/cursors/CursorLimitManager.html",
        "title": "CursorLimitManager (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html#setLow%28byte%5B%5D,com.apple.foundationdb.record.EndpointType%29",
        "title": "KeyValueCursor.Builder (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 2,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://rajivr.github.io/fdb-rl-wip/fdb/tuple/struct.TupleSchema.html#method.validate",
        "title": "TupleSchema in fdb::tuple - Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "rajivr.github.io",
        "root_domain": "rajivr.github.io"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/EndpointType.html#CONTINUATION",
        "title": "EndpointType (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/provider/foundationdb/KeyValueCursor.Builder.html",
        "title": "KeyValueCursor.Builder (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://www.plantuml.com/plantuml/png/jLH1Yziy4BtxLmnx-hwG_84SohRBBXIw3IJGIobYOarOiROKHgDaWzd_NidQfWx621_gapHltkEz4UDxByWIsgOI8mt15izRgXthXy3UCVptvFYCh65Ne_s_Yjr2S7Vj-a0Jk4lGCzOlnj8Te8TI4tGLmC_5BrYjFi5NQyH4B3D-47lZx9PGL_1NwFC9JOFxXXAbfwxXIUyVcHrt1xrNb4vBg9qLOmDAr7YF0addHdWUVzhSB9r2a4sGpU4BMfrbN13b3ceV2rbEoUL8SxBDa9mVTxvqUGAFLcyEEs72jkHYp2Y9VpEjaKYlNqX3DylNTtgJ7BCu_3AhaApC7gxWq75Ukb4vhzbamd62DTpSDw-THa7bZuqHlmJkGNNAw1AER5haYtgbo-rp_sdr2Xicr1V5984jwPHYa6HaeGyogkOS4oCVfuivhkUEyQoocv77A-Ad_4q-L-zp4i",
        "title": null,
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "www.plantuml.com",
        "root_domain": "plantuml.com"
      },
      {
        "url": "https://github.com/FoundationDB/fdb-record-layer/blob/238a4f27d672082c122be2f402d698ca2f292dba/fdb-record-layer-core/src/main/java/com/apple/foundationdb/record/provider/foundationdb/IndexingBase.java#L740",
        "title": "fdb-record-layer/IndexingBase.java at 238a4f27d672082c122be2f402d698ca2f292dba \u00b7 FoundationDB/fdb-record-layer \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 8,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/TimeScanLimiter.html",
        "title": "TimeScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      },
      {
        "url": "https://github.com/apple/foundationdb/blob/dd0036f09cac804dbfc8a5b2ee87881c3cdfad55/flow/Knobs.cpp#L214",
        "title": "foundationdb/Knobs.cpp at dd0036f09cac804dbfc8a5b2ee87881c3cdfad55 \u00b7 apple/foundationdb \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 8,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://gist.github.com/rajivr/7d090072d190bf83d14c46057facf8b5",
        "title": "{inclusive,exclusive}_null.rs \u00b7 GitHub",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "gist.github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://docs.rs/prost-reflect/0.11.4/prost_reflect/struct.DynamicMessage.html",
        "title": "DynamicMessage in prost_reflect - Rust",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "docs.rs",
        "root_domain": "docs.rs"
      },
      {
        "url": "https://github.com/jorgecarleitao/arrow2#features",
        "title": "GitHub - jorgecarleitao/arrow2: Transmute-free Rust library to work with the Arrow format",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "github.com",
        "root_domain": "github.com"
      },
      {
        "url": "https://javadoc.io/static/org.foundationdb/fdb-record-layer-core-pb3/2.10.164.0/com/apple/foundationdb/record/ByteScanLimiter.html",
        "title": "ByteScanLimiter (fdb-record-layer-core-pb3 2.10.164.0 API)",
        "internal": false,
        "attachment": false,
        "reflection": false,
        "clicks": 1,
        "user_id": 946,
        "domain": "javadoc.io",
        "root_domain": "javadoc.io"
      }
    ]
  },
  "bookmarks": []
}