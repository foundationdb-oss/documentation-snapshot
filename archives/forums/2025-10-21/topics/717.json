{
  "post_stream": {
    "posts": [
      {
        "id": 2139,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-09-20T18:16:44.394Z",
        "cooked": "<p>We are currently in the process of resizing our biggest FDB cluster. We will scale out (adding more hosts) and scale up (running on bigger machines).</p>\n<p>Now the question we have is about main memory usage. Each storage process will have around 80GB of main memory at its disposal. However, I do not believe that the storage will use this memory efficiently by default.</p>\n<p>So we plan to set the following knobs:</p>\n<pre><code>knob_page_cache_4k=50GB\nknob_page_cache_64k=5GB\nmemory=80GB\n</code></pre>\n<p>Does this sound reasonable? Are there other knobs we should change to make fdbserver use the memory as efficiently as possible?</p>",
        "post_number": 1,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-20T18:16:44.394Z",
        "reply_count": 0,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 315,
        "reads": 95,
        "readers_count": 94,
        "score": 1606.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/1",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null,
        "can_vote": false
      },
      {
        "id": 2141,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-09-21T02:32:02.617Z",
        "cooked": "<p>just curious - how would OS page cache play out in this case, assuming that you did not increase fdb\u2019s page caches explicitly?</p>",
        "post_number": 2,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-21T02:32:02.617Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 90,
        "readers_count": 89,
        "score": 38.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/2",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2142,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-09-21T02:35:11.833Z",
        "cooked": "<p>By default it doesn\u2019t (at least on Linux). FDB uses AIO which, IIRC, bypasses the OS page cache. So you could give a 1TB of main memory to the process without seeing more caching. At least this is my understanding of the code and this is why I am asking this question.</p>",
        "post_number": 3,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-21T02:35:11.833Z",
        "reply_count": 1,
        "reply_to_post_number": 2,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 85,
        "readers_count": 84,
        "score": 37.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 166,
          "username": "gaurav",
          "name": "gaurav",
          "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/3",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2189,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-09-28T17:47:42.796Z",
        "cooked": "<p>so we did set up the two knobs I mentioned above (knob_page_cache_4k and knob_page_cache_64k) to a much higher value. This turned out to be a horrible idea:</p>\n<p>After setting the knob we saw a cache hit rate of 99.99% and disk utilization went down dramatically. However: After a while CPU utilization went up by almost a factor of two and response time for read requests went down by roughly a factor of two.</p>\n<p>We investigated the  cause with perf top and saw that roughly 50% of CPU time was spent in AsyncFileCached::truncate. This is one part of that code:</p>\n<pre><code>for (auto p = pages.begin(); p != pages.end();) {\n\tif (p-&gt;first &gt;= pageOffset) {\n\t\tauto f = p-&gt;second-&gt;truncate();\n\t\tif (!f.isReady() || f.isError()) actors.push_back(f);\n\t\tauto last = p;\n\t\t++p;\n\t\tpages.erase(last);\n\t} else\n\t\t++p;\n}\n</code></pre>\n<p>This means, that whenever truncate is called, the storage node has to iterate through all cached pages (millions of them). Furthermore the truncate call to each page potentially results in an allocation (as this might create another actor).</p>\n<p>So for now we run with a small cache again. The conclusion is, that FDB is does not scale up for now. We plan to fix this ASAP as we also can\u2019t scale out much more in the short term.</p>",
        "post_number": 4,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-28T17:47:42.796Z",
        "reply_count": 2,
        "reply_to_post_number": 3,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 80,
        "readers_count": 79,
        "score": 36.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/4",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2190,
        "name": "Alex Miller",
        "username": "alexmiller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "created_at": "2018-09-28T19:02:38.817Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"4\" data-topic=\"717\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>This means, that whenever truncate is called</p>\n</blockquote>\n</aside>\n<p>I think <a class=\"mention\" href=\"/u/steavedhams\">@SteavedHams</a> had noted before that the ssd2 storage engine calls truncate much more often than you\u2019d expect as well.</p>\n<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"4\" data-topic=\"717\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>We investigated the cause with perf top and saw that roughly 50% of CPU time was spent in AsyncFileCached::truncate</p>\n</blockquote>\n</aside>\n<p>Well, that\u2019ll do it.</p>\n<p>Is this a fix you can push back as a PR, or should we file an issue for it to be addressed separately?  Even on a smaller page cache, this still sounds like quite a waste of CPU.</p>",
        "post_number": 5,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-28T19:02:38.817Z",
        "reply_count": 1,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 1,
        "reads": 74,
        "readers_count": 73,
        "score": 24.8,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Alex Miller",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 13,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/5",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2191,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-09-28T21:08:55.023Z",
        "cooked": "<p>I agree, this has to be optimized no matter what. Even with a small (aka default-sized) cache AsyncFileCached::truncate uses between 8 and 12% of the CPU according to perf top.</p>\n<p>I looked through the code and thought about a fix but I don\u2019t think it will be trivial to fix (but also not super-hard). And I think we\u2019ll be able to share that.</p>",
        "post_number": 6,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-28T21:08:55.023Z",
        "reply_count": 0,
        "reply_to_post_number": 5,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 71,
        "readers_count": 70,
        "score": 14.2,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 13,
          "username": "alexmiller",
          "name": "Alex Miller",
          "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/6",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2193,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2018-09-29T02:30:20.638Z",
        "cooked": "<p>On the sqlite b-tree file (the file that\u2019s going to be the largest and cause the most problems here), I think truncates are often done with a small number of pages. A sort of quick workaround may be to search the <code>pages</code> map for each page between your offset and the end of the file if the number of such pages is less than some reasonable threshold. If a proper, more general fix is going to be slower to put together, it may allow you to get an idea whether there\u2019s anything else that\u2019s going to be a problem after you resolve this.</p>\n<p>The above approach will also avoid running through this loop when truncate is used to extend the file, which based on a quick reading of the code seems to be what it\u2019s doing. I don\u2019t know if truncate is used for this purpose in the ssd storage engine, but if it is then avoiding that could be an easy win.</p>\n<p>As a historical note, the commented out code above the block you referenced was an implementation that used <code>std::map</code> instead of <code>std::unordered_map</code>. That allowed us to only touch the pages being truncated, but it of course made reads more expensive.</p>",
        "post_number": 7,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-09-29T02:30:20.638Z",
        "reply_count": 1,
        "reply_to_post_number": null,
        "quote_count": 0,
        "incoming_link_count": 3,
        "reads": 68,
        "readers_count": 67,
        "score": 33.6,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/7",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2205,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-10-02T15:27:04.727Z",
        "cooked": "<p>Ah that makes sense. I\u2019ll probably go for this simpler optimization for now - this is actually a good idea. We currently have too much on our plate to fix this properly and that way we can do this next month or so.</p>",
        "post_number": 8,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-02T15:27:04.727Z",
        "reply_count": 0,
        "reply_to_post_number": 7,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 64,
        "readers_count": 63,
        "score": 12.8,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 12,
          "username": "ajbeamon",
          "name": "A.J. Beamon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/8",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2206,
        "name": "Mike McMahon",
        "username": "killertypo",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "created_at": "2018-10-02T22:51:34.476Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"markus.pilman\" data-post=\"4\" data-topic=\"717\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/markus.pilman/48/379_2.png\" class=\"avatar\"> markus.pilman:</div>\n<blockquote>\n<p>The conclusion is, that FDB is does not scale up for now</p>\n</blockquote>\n</aside>\n<p>does not scale up how?  FDB does an amazing job of scaling depending on your workload and how you tune the DB.</p>",
        "post_number": 9,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-02T22:51:34.476Z",
        "reply_count": 2,
        "reply_to_post_number": 4,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 63,
        "readers_count": 62,
        "score": 22.6,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 43,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/9",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2207,
        "name": "gaurav",
        "username": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "created_at": "2018-10-03T02:35:18.738Z",
        "cooked": "<p>Markus has shown that a single instance of FDBServer process cannot efficiently make use of more RAM, if given.</p>",
        "post_number": 10,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-03T02:35:18.738Z",
        "reply_count": 0,
        "reply_to_post_number": 9,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 61,
        "readers_count": 60,
        "score": 12.2,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "gaurav",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 43,
          "username": "killertypo",
          "name": "Mike McMahon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 166,
        "hidden": false,
        "trust_level": 3,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/10",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2208,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-10-03T17:48:21.047Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"killertypo\" data-post=\"9\" data-topic=\"717\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/killertypo/48/35_2.png\" class=\"avatar\"> killertypo:</div>\n<blockquote>\n<p>does not scale up how? FDB does an amazing job of scaling depending on your workload and how you tune the DB.</p>\n</blockquote>\n</aside>\n<p>Scale up means utilizing bigger machines. Scale out means utilizing more machines. FDB currently can\u2019t utilize of a lot of memory for disk caching, therefore it can\u2019t scale up at least with the SSD storage engine.</p>",
        "post_number": 11,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-03T17:48:21.047Z",
        "reply_count": 1,
        "reply_to_post_number": 9,
        "quote_count": 1,
        "incoming_link_count": 0,
        "reads": 62,
        "readers_count": 61,
        "score": 17.4,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/11",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2209,
        "name": "Mike McMahon",
        "username": "killertypo",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "created_at": "2018-10-03T19:50:28.622Z",
        "cooked": "<p>FDB scales quite well in all directions on SSD - though we\u2019ve found it\u2019s better to run a lot more SSD procs of a reasonable memory footprint (16G or so) vs trying to have one super sized proc.</p>",
        "post_number": 12,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-03T19:50:28.622Z",
        "reply_count": 1,
        "reply_to_post_number": 11,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 60,
        "readers_count": 59,
        "score": 17.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 43,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/12",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2211,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-10-03T23:47:36.914Z",
        "cooked": "<aside class=\"quote no-group\" data-username=\"killertypo\" data-post=\"12\" data-topic=\"717\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://sea1.discourse-cdn.com/foundationdb/user_avatar/forums.foundationdb.org/killertypo/48/35_2.png\" class=\"avatar\"> killertypo:</div>\n<blockquote>\n<p>FDB scales quite well in all directions on SSD - though we\u2019ve found it\u2019s better to run a lot more SSD procs of a reasonable memory footprint (16G or so) vs trying to have one super sized proc.</p>\n</blockquote>\n</aside>\n<p>yes, what you are saying is that it works better if you scale out instead of trying to scale up - so I think we are in wild agreement here <img src=\"https://emoji.discourse-cdn.com/twitter/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>Anyways, the simple solution proposed by <a class=\"mention\" href=\"/u/ajbeamon\">@ajbeamon</a> is implemented and currently on it\u2019s way to a large test-cluster. I will create a pull request as soon as we have some confidence that it actually works as intended (so far it looks good, but the cache is still cold, so we\u2019ll wait another 12 hours or so)</p>",
        "post_number": 13,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-03T23:47:36.914Z",
        "reply_count": 1,
        "reply_to_post_number": 12,
        "quote_count": 1,
        "incoming_link_count": 2,
        "reads": 60,
        "readers_count": 59,
        "score": 42.0,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "bookmarked": false,
        "actions_summary": [
          {
            "id": 2,
            "count": 1
          }
        ],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/13",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2218,
        "name": "Mike McMahon",
        "username": "killertypo",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "created_at": "2018-10-04T14:53:29.821Z",
        "cooked": "<p>Possibly, I think of it as scaling outwards as you scale up. We tend to drop incredibly large and powerful machines and then scale horizontally inside the machine to maximize the capacity and decrease the workloads per proc.</p>",
        "post_number": 14,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T14:53:29.821Z",
        "reply_count": 1,
        "reply_to_post_number": 13,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 59,
        "readers_count": 58,
        "score": 16.8,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 43,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/14",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2220,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-10-04T16:02:35.373Z",
        "cooked": "<p>I understand, and we would like to do that as well, but we can\u2019t. We use EBS and EBS is our main bottleneck. So we need to do two things:</p>\n<ol>\n<li>Increase number of IOPS per process as much as possible.</li>\n<li>Cache all hot data.</li>\n</ol>\n<p>Both of these need somewhat bigger machines. There\u2019s an upper limit of how many IOPS you get per machine and this limit depends on both, the type and the size of the EC2 instance. For caching, we need more memory (a cache of 10GB brings down the number of IOPS consumed by about half - on our workload).</p>\n<p>Now we could use more storage processes, but there are two limitations:</p>\n<ol>\n<li>We need to make sure that no two VMs end up on the same physical machine. Using anti-placement and availability zones brings us only so far. Assigning machine ids is problematic as well, as it reduces the number of TLogs we can run. We probably could run in a bit more complex and heterogeneous setting to achieve this, but this get complicated real quick.</li>\n<li>You can only add a certain number of processes to an FDB cluster until the cluster controller runs out of CPU. Adding clients also contributes to the CC CPU. We are starting to get close to that limit (our experiments show that you can get around ~1500 servers and clients without destabilizing the cluster). We have patches on our way to production that make this somewhat better, but we are still at a point where scaling out becomes problematic.</li>\n</ol>\n<p>So now, if we pay for big machines anyways, we would like to use them as much as possible. We can\u2019t use the CPU cores, but we want to use at least the memory. And FDB should be able to use the memory for caching. With the fix mentioned above (for which I will make a pull request hopefully today) we can scale up much better.</p>\n<p>I hope these explanations help to understand our motivations better.</p>",
        "post_number": 15,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T16:02:35.373Z",
        "reply_count": 2,
        "reply_to_post_number": 14,
        "quote_count": 0,
        "incoming_link_count": 7,
        "reads": 58,
        "readers_count": 57,
        "score": 56.6,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 43,
          "username": "killertypo",
          "name": "Mike McMahon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/15",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2222,
        "name": "Clement Pang",
        "username": "panghy",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "created_at": "2018-10-04T19:01:45.931Z",
        "cooked": "<p>Ah, then I am sure Mike can tell you all about NVMes. <img src=\"https://emoji.discourse-cdn.com/twitter/slight_smile.png?v=6\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\"></p>",
        "post_number": 16,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T19:01:45.931Z",
        "reply_count": 0,
        "reply_to_post_number": 15,
        "quote_count": 0,
        "incoming_link_count": 2,
        "reads": 58,
        "readers_count": 57,
        "score": 21.6,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Clement Pang",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": "",
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 38,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/16",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2223,
        "name": "Mike McMahon",
        "username": "killertypo",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "created_at": "2018-10-04T20:06:39.885Z",
        "cooked": "<p>IO is always the bandwidth cap, what class of machine are you using?  We use NVMe in front of our EBS volumes as a Write-Through/Read-Only cache.  AWS does not differentiate between reads/writes so we can effectively hit around 99% cache hit rates (1NVME to 1EBS across an LVM RAID) with around 16 procs at 16G of memory per.  This opens the floodgates for writes as all of your reads are hitting instance stores and no longer counting against your EBS volumes IO.</p>",
        "post_number": 17,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T20:06:39.885Z",
        "reply_count": 1,
        "reply_to_post_number": 15,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 59,
        "readers_count": 58,
        "score": 16.8,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 43,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/17",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2224,
        "name": "Markus Pilman",
        "username": "markus.pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "created_at": "2018-10-04T20:41:06.322Z",
        "cooked": "<p>We are aware of what you are doing <img src=\"https://emoji.discourse-cdn.com/twitter/wink.png?v=6\" title=\":wink:\" class=\"emoji\" alt=\":wink:\"></p>\n<p>We thought about using a NVME-cache through bcache as well. However, we can get a cache-hit rate of more than 99.99% by using main memory (we validated this in production but had to roll back because of the truncate problem). So we currently don\u2019t need to use ephemeral disks for that. We only need a simple code change to make this work.</p>",
        "post_number": 18,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T20:41:06.322Z",
        "reply_count": 2,
        "reply_to_post_number": 17,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 61,
        "readers_count": 60,
        "score": 22.2,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Markus Pilman",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 43,
          "username": "killertypo",
          "name": "Mike McMahon",
          "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 15,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/18",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2226,
        "name": "Mike McMahon",
        "username": "killertypo",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "created_at": "2018-10-04T23:24:58.820Z",
        "cooked": "<p>sounds reasonable, if the codefix works then it works - may work well to be able to utilize multiple paradigms to get the most bang for your buck as well haha.  There is always a cost component on CPU when pushing it into memory (or at least we\u2019ve found).  If you have the memory to spare (we do not) it may work quite well in your design.</p>",
        "post_number": 19,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-04T23:24:58.820Z",
        "reply_count": 0,
        "reply_to_post_number": 18,
        "quote_count": 0,
        "incoming_link_count": 0,
        "reads": 62,
        "readers_count": 61,
        "score": 12.4,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "Mike McMahon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": false,
        "staff": false,
        "user_id": 43,
        "hidden": false,
        "trust_level": 2,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/19",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      },
      {
        "id": 2237,
        "name": "A.J. Beamon",
        "username": "ajbeamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "created_at": "2018-10-05T21:02:25.621Z",
        "cooked": "<p><a class=\"mention\" href=\"/u/markus.pilman\">@markus.pilman</a> I saw the pull request, do you have any details about how much it helped?</p>",
        "post_number": 20,
        "post_type": 1,
        "posts_count": 24,
        "updated_at": "2018-10-05T21:02:25.621Z",
        "reply_count": 1,
        "reply_to_post_number": 18,
        "quote_count": 0,
        "incoming_link_count": 1,
        "reads": 59,
        "readers_count": 58,
        "score": 21.8,
        "yours": false,
        "topic_id": 717,
        "topic_slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
        "display_username": "A.J. Beamon",
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_bg_color": null,
        "flair_color": null,
        "flair_group_id": null,
        "badges_granted": [],
        "version": 1,
        "can_edit": false,
        "can_delete": false,
        "can_recover": false,
        "can_see_hidden_post": false,
        "can_wiki": false,
        "read": true,
        "user_title": null,
        "reply_to_user": {
          "id": 15,
          "username": "markus.pilman",
          "name": "Markus Pilman",
          "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
        },
        "bookmarked": false,
        "actions_summary": [],
        "moderator": false,
        "admin": true,
        "staff": true,
        "user_id": 12,
        "hidden": false,
        "trust_level": 4,
        "deleted_at": null,
        "user_deleted": false,
        "edit_reason": null,
        "can_view_edit_history": true,
        "wiki": false,
        "post_url": "/t/what-knobs-should-we-set-to-increase-cache-efficiency/717/20",
        "can_accept_answer": false,
        "can_unaccept_answer": false,
        "accepted_answer": false,
        "topic_accepted_answer": null
      }
    ],
    "stream": [
      2139,
      2141,
      2142,
      2189,
      2190,
      2191,
      2193,
      2205,
      2206,
      2207,
      2208,
      2209,
      2211,
      2218,
      2220,
      2222,
      2223,
      2224,
      2226,
      2237,
      2277,
      7655,
      7690,
      7699
    ]
  },
  "timeline_lookup": [
    [
      1,
      2588
    ],
    [
      4,
      2580
    ],
    [
      8,
      2576
    ],
    [
      11,
      2575
    ],
    [
      14,
      2574
    ],
    [
      20,
      2573
    ],
    [
      21,
      2570
    ],
    [
      22,
      1914
    ],
    [
      23,
      1905
    ]
  ],
  "tags": [],
  "tags_descriptions": {},
  "fancy_title": "What knobs should we set to increase cache efficiency",
  "id": 717,
  "title": "What knobs should we set to increase cache efficiency",
  "posts_count": 24,
  "created_at": "2018-09-20T18:16:44.323Z",
  "views": 2006,
  "reply_count": 20,
  "like_count": 7,
  "last_posted_at": "2020-08-04T04:57:33.115Z",
  "visible": true,
  "closed": false,
  "archived": false,
  "has_summary": false,
  "archetype": "regular",
  "slug": "what-knobs-should-we-set-to-increase-cache-efficiency",
  "category_id": 7,
  "word_count": 1953,
  "deleted_at": null,
  "user_id": 15,
  "featured_link": null,
  "pinned_globally": false,
  "pinned_at": null,
  "pinned_until": null,
  "image_url": null,
  "slow_mode_seconds": 0,
  "draft": null,
  "draft_key": "topic_717",
  "draft_sequence": null,
  "unpinned": null,
  "pinned": false,
  "current_post_number": 1,
  "highest_post_number": 24,
  "deleted_by": null,
  "actions_summary": [
    {
      "id": 4,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 8,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 10,
      "count": 0,
      "hidden": false,
      "can_act": false
    },
    {
      "id": 7,
      "count": 0,
      "hidden": false,
      "can_act": false
    }
  ],
  "chunk_size": 20,
  "bookmarked": false,
  "topic_timer": null,
  "message_bus_last_id": 0,
  "participant_count": 7,
  "show_read_indicator": false,
  "thumbnails": null,
  "slow_mode_enabled_until": null,
  "tags_disable_ads": false,
  "related_topics": null,
  "summarizable": false,
  "can_vote": false,
  "vote_count": 0,
  "user_voted": false,
  "discourse_zendesk_plugin_zendesk_id": null,
  "discourse_zendesk_plugin_zendesk_url": "https://your-url.zendesk.com/agent/tickets/",
  "details": {
    "can_edit": false,
    "notification_level": 1,
    "participants": [
      {
        "id": 15,
        "username": "markus.pilman",
        "name": "Markus Pilman",
        "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png",
        "post_count": 10,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 43,
        "username": "killertypo",
        "name": "Mike McMahon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/killertypo/{size}/35_2.png",
        "post_count": 5,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 12,
        "username": "ajbeamon",
        "name": "A.J. Beamon",
        "avatar_template": "/user_avatar/forums.foundationdb.org/ajbeamon/{size}/13_2.png",
        "post_count": 3,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "admin": true,
        "trust_level": 4
      },
      {
        "id": 166,
        "username": "gaurav",
        "name": "gaurav",
        "avatar_template": "https://avatars.discourse-cdn.com/v4/letter/g/b487fb/{size}.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 3
      },
      {
        "id": 645,
        "username": "subramaniamr",
        "name": "Subramaniam R",
        "avatar_template": "/user_avatar/forums.foundationdb.org/subramaniamr/{size}/658_2.png",
        "post_count": 2,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 38,
        "username": "panghy",
        "name": "Clement Pang",
        "avatar_template": "/user_avatar/forums.foundationdb.org/panghy/{size}/19_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 2
      },
      {
        "id": 13,
        "username": "alexmiller",
        "name": "Alex Miller",
        "avatar_template": "/user_avatar/forums.foundationdb.org/alexmiller/{size}/326_2.png",
        "post_count": 1,
        "primary_group_name": null,
        "flair_name": null,
        "flair_url": null,
        "flair_color": null,
        "flair_bg_color": null,
        "flair_group_id": null,
        "trust_level": 4
      }
    ],
    "created_by": {
      "id": 15,
      "username": "markus.pilman",
      "name": "Markus Pilman",
      "avatar_template": "/user_avatar/forums.foundationdb.org/markus.pilman/{size}/379_2.png"
    },
    "last_poster": {
      "id": 645,
      "username": "subramaniamr",
      "name": "Subramaniam R",
      "avatar_template": "/user_avatar/forums.foundationdb.org/subramaniamr/{size}/658_2.png"
    }
  },
  "bookmarks": []
}